import{g as vr}from"../vendor-e56015e7.js";var qt={},Xe={};Xe.byteLength=mr;Xe.toByteArray=wr;Xe.fromByteArray=br;var ae=[],J=[],gr=typeof Uint8Array<"u"?Uint8Array:Array,rt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Be=0,yr=rt.length;Be<yr;++Be)ae[Be]=rt[Be],J[rt.charCodeAt(Be)]=Be;J["-".charCodeAt(0)]=62;J["_".charCodeAt(0)]=63;function Vt(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var o=n===e?0:4-n%4;return[n,o]}function mr(t){var e=Vt(t),n=e[0],o=e[1];return(n+o)*3/4-o}function Er(t,e,n){return(e+n)*3/4-n}function wr(t){var e,n=Vt(t),o=n[0],s=n[1],a=new gr(Er(t,o,s)),l=0,f=s>0?o-4:o,g;for(g=0;g<f;g+=4)e=J[t.charCodeAt(g)]<<18|J[t.charCodeAt(g+1)]<<12|J[t.charCodeAt(g+2)]<<6|J[t.charCodeAt(g+3)],a[l++]=e>>16&255,a[l++]=e>>8&255,a[l++]=e&255;return s===2&&(e=J[t.charCodeAt(g)]<<2|J[t.charCodeAt(g+1)]>>4,a[l++]=e&255),s===1&&(e=J[t.charCodeAt(g)]<<10|J[t.charCodeAt(g+1)]<<4|J[t.charCodeAt(g+2)]>>2,a[l++]=e>>8&255,a[l++]=e&255),a}function Ir(t){return ae[t>>18&63]+ae[t>>12&63]+ae[t>>6&63]+ae[t&63]}function _r(t,e,n){for(var o,s=[],a=e;a<n;a+=3)o=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(t[a+2]&255),s.push(Ir(o));return s.join("")}function br(t){for(var e,n=t.length,o=n%3,s=[],a=16383,l=0,f=n-o;l<f;l+=a)s.push(_r(t,l,l+a>f?f:l+a));return o===1?(e=t[n-1],s.push(ae[e>>2]+ae[e<<4&63]+"==")):o===2&&(e=(t[n-2]<<8)+t[n-1],s.push(ae[e>>10]+ae[e>>4&63]+ae[e<<2&63]+"=")),s.join("")}var gt={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */gt.read=function(t,e,n,o,s){var a,l,f=s*8-o-1,g=(1<<f)-1,v=g>>1,h=-7,m=n?s-1:0,E=n?-1:1,w=t[e+m];for(m+=E,a=w&(1<<-h)-1,w>>=-h,h+=f;h>0;a=a*256+t[e+m],m+=E,h-=8);for(l=a&(1<<-h)-1,a>>=-h,h+=o;h>0;l=l*256+t[e+m],m+=E,h-=8);if(a===0)a=1-v;else{if(a===g)return l?NaN:(w?-1:1)*(1/0);l=l+Math.pow(2,o),a=a-v}return(w?-1:1)*l*Math.pow(2,a-o)};gt.write=function(t,e,n,o,s,a){var l,f,g,v=a*8-s-1,h=(1<<v)-1,m=h>>1,E=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=o?0:a-1,b=o?1:-1,S=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(f=isNaN(e)?1:0,l=h):(l=Math.floor(Math.log(e)/Math.LN2),e*(g=Math.pow(2,-l))<1&&(l--,g*=2),l+m>=1?e+=E/g:e+=E*Math.pow(2,1-m),e*g>=2&&(l++,g/=2),l+m>=h?(f=0,l=h):l+m>=1?(f=(e*g-1)*Math.pow(2,s),l=l+m):(f=e*Math.pow(2,m-1)*Math.pow(2,s),l=0));s>=8;t[n+w]=f&255,w+=b,f/=256,s-=8);for(l=l<<s|f,v+=s;v>0;t[n+w]=l&255,w+=b,l/=256,v-=8);t[n+w-b]|=S*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=Xe,n=gt,o=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=f,t.SlowBuffer=q,t.INSPECT_MAX_BYTES=50;const s=2147483647;t.kMaxLength=s,f.TYPED_ARRAY_SUPPORT=a(),!f.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const u=new Uint8Array(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,Uint8Array.prototype),Object.setPrototypeOf(u,r),u.foo()===42}catch{return!1}}Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}});function l(u){if(u>s)throw new RangeError('The value "'+u+'" is invalid for option "size"');const r=new Uint8Array(u);return Object.setPrototypeOf(r,f.prototype),r}function f(u,r,i){if(typeof u=="number"){if(typeof r=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(u)}return g(u,r,i)}f.poolSize=8192;function g(u,r,i){if(typeof u=="string")return E(u,r);if(ArrayBuffer.isView(u))return b(u);if(u==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof u);if(ie(u,ArrayBuffer)||u&&ie(u.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ie(u,SharedArrayBuffer)||u&&ie(u.buffer,SharedArrayBuffer)))return S(u,r,i);if(typeof u=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const c=u.valueOf&&u.valueOf();if(c!=null&&c!==u)return f.from(c,r,i);const d=x(u);if(d)return d;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof u[Symbol.toPrimitive]=="function")return f.from(u[Symbol.toPrimitive]("string"),r,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof u)}f.from=function(u,r,i){return g(u,r,i)},Object.setPrototypeOf(f.prototype,Uint8Array.prototype),Object.setPrototypeOf(f,Uint8Array);function v(u){if(typeof u!="number")throw new TypeError('"size" argument must be of type number');if(u<0)throw new RangeError('The value "'+u+'" is invalid for option "size"')}function h(u,r,i){return v(u),u<=0?l(u):r!==void 0?typeof i=="string"?l(u).fill(r,i):l(u).fill(r):l(u)}f.alloc=function(u,r,i){return h(u,r,i)};function m(u){return v(u),l(u<0?0:A(u)|0)}f.allocUnsafe=function(u){return m(u)},f.allocUnsafeSlow=function(u){return m(u)};function E(u,r){if((typeof r!="string"||r==="")&&(r="utf8"),!f.isEncoding(r))throw new TypeError("Unknown encoding: "+r);const i=R(u,r)|0;let c=l(i);const d=c.write(u,r);return d!==i&&(c=c.slice(0,d)),c}function w(u){const r=u.length<0?0:A(u.length)|0,i=l(r);for(let c=0;c<r;c+=1)i[c]=u[c]&255;return i}function b(u){if(ie(u,Uint8Array)){const r=new Uint8Array(u);return S(r.buffer,r.byteOffset,r.byteLength)}return w(u)}function S(u,r,i){if(r<0||u.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(u.byteLength<r+(i||0))throw new RangeError('"length" is outside of buffer bounds');let c;return r===void 0&&i===void 0?c=new Uint8Array(u):i===void 0?c=new Uint8Array(u,r):c=new Uint8Array(u,r,i),Object.setPrototypeOf(c,f.prototype),c}function x(u){if(f.isBuffer(u)){const r=A(u.length)|0,i=l(r);return i.length===0||u.copy(i,0,0,r),i}if(u.length!==void 0)return typeof u.length!="number"||tt(u.length)?l(0):w(u);if(u.type==="Buffer"&&Array.isArray(u.data))return w(u.data)}function A(u){if(u>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return u|0}function q(u){return+u!=u&&(u=0),f.alloc(+u)}f.isBuffer=function(r){return r!=null&&r._isBuffer===!0&&r!==f.prototype},f.compare=function(r,i){if(ie(r,Uint8Array)&&(r=f.from(r,r.offset,r.byteLength)),ie(i,Uint8Array)&&(i=f.from(i,i.offset,i.byteLength)),!f.isBuffer(r)||!f.isBuffer(i))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===i)return 0;let c=r.length,d=i.length;for(let p=0,y=Math.min(c,d);p<y;++p)if(r[p]!==i[p]){c=r[p],d=i[p];break}return c<d?-1:d<c?1:0},f.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(r,i){if(!Array.isArray(r))throw new TypeError('"list" argument must be an Array of Buffers');if(r.length===0)return f.alloc(0);let c;if(i===void 0)for(i=0,c=0;c<r.length;++c)i+=r[c].length;const d=f.allocUnsafe(i);let p=0;for(c=0;c<r.length;++c){let y=r[c];if(ie(y,Uint8Array))p+y.length>d.length?(f.isBuffer(y)||(y=f.from(y)),y.copy(d,p)):Uint8Array.prototype.set.call(d,y,p);else if(f.isBuffer(y))y.copy(d,p);else throw new TypeError('"list" argument must be an Array of Buffers');p+=y.length}return d};function R(u,r){if(f.isBuffer(u))return u.length;if(ArrayBuffer.isView(u)||ie(u,ArrayBuffer))return u.byteLength;if(typeof u!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof u);const i=u.length,c=arguments.length>2&&arguments[2]===!0;if(!c&&i===0)return 0;let d=!1;for(;;)switch(r){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return et(u).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i*2;case"hex":return i>>>1;case"base64":return It(u).length;default:if(d)return c?-1:et(u).length;r=(""+r).toLowerCase(),d=!0}}f.byteLength=R;function H(u,r,i){let c=!1;if((r===void 0||r<0)&&(r=0),r>this.length||((i===void 0||i>this.length)&&(i=this.length),i<=0)||(i>>>=0,r>>>=0,i<=r))return"";for(u||(u="utf8");;)switch(u){case"hex":return Ce(this,r,i);case"utf8":case"utf-8":return pe(this,r,i);case"ascii":return Pe(this,r,i);case"latin1":case"binary":return Fe(this,r,i);case"base64":return fe(this,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return De(this,r,i);default:if(c)throw new TypeError("Unknown encoding: "+u);u=(u+"").toLowerCase(),c=!0}}f.prototype._isBuffer=!0;function D(u,r,i){const c=u[r];u[r]=u[i],u[i]=c}f.prototype.swap16=function(){const r=this.length;if(r%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let i=0;i<r;i+=2)D(this,i,i+1);return this},f.prototype.swap32=function(){const r=this.length;if(r%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let i=0;i<r;i+=4)D(this,i,i+3),D(this,i+1,i+2);return this},f.prototype.swap64=function(){const r=this.length;if(r%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let i=0;i<r;i+=8)D(this,i,i+7),D(this,i+1,i+6),D(this,i+2,i+5),D(this,i+3,i+4);return this},f.prototype.toString=function(){const r=this.length;return r===0?"":arguments.length===0?pe(this,0,r):H.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(r){if(!f.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r?!0:f.compare(this,r)===0},f.prototype.inspect=function(){let r="";const i=t.INSPECT_MAX_BYTES;return r=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(r+=" ... "),"<Buffer "+r+">"},o&&(f.prototype[o]=f.prototype.inspect),f.prototype.compare=function(r,i,c,d,p){if(ie(r,Uint8Array)&&(r=f.from(r,r.offset,r.byteLength)),!f.isBuffer(r))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof r);if(i===void 0&&(i=0),c===void 0&&(c=r?r.length:0),d===void 0&&(d=0),p===void 0&&(p=this.length),i<0||c>r.length||d<0||p>this.length)throw new RangeError("out of range index");if(d>=p&&i>=c)return 0;if(d>=p)return-1;if(i>=c)return 1;if(i>>>=0,c>>>=0,d>>>=0,p>>>=0,this===r)return 0;let y=p-d,U=c-i;const O=Math.min(y,U),C=this.slice(d,p),N=r.slice(i,c);for(let P=0;P<O;++P)if(C[P]!==N[P]){y=C[P],U=N[P];break}return y<U?-1:U<y?1:0};function k(u,r,i,c,d){if(u.length===0)return-1;if(typeof i=="string"?(c=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,tt(i)&&(i=d?0:u.length-1),i<0&&(i=u.length+i),i>=u.length){if(d)return-1;i=u.length-1}else if(i<0)if(d)i=0;else return-1;if(typeof r=="string"&&(r=f.from(r,c)),f.isBuffer(r))return r.length===0?-1:F(u,r,i,c,d);if(typeof r=="number")return r=r&255,typeof Uint8Array.prototype.indexOf=="function"?d?Uint8Array.prototype.indexOf.call(u,r,i):Uint8Array.prototype.lastIndexOf.call(u,r,i):F(u,[r],i,c,d);throw new TypeError("val must be string, number or Buffer")}function F(u,r,i,c,d){let p=1,y=u.length,U=r.length;if(c!==void 0&&(c=String(c).toLowerCase(),c==="ucs2"||c==="ucs-2"||c==="utf16le"||c==="utf-16le")){if(u.length<2||r.length<2)return-1;p=2,y/=2,U/=2,i/=2}function O(N,P){return p===1?N[P]:N.readUInt16BE(P*p)}let C;if(d){let N=-1;for(C=i;C<y;C++)if(O(u,C)===O(r,N===-1?0:C-N)){if(N===-1&&(N=C),C-N+1===U)return N*p}else N!==-1&&(C-=C-N),N=-1}else for(i+U>y&&(i=y-U),C=i;C>=0;C--){let N=!0;for(let P=0;P<U;P++)if(O(u,C+P)!==O(r,P)){N=!1;break}if(N)return C}return-1}f.prototype.includes=function(r,i,c){return this.indexOf(r,i,c)!==-1},f.prototype.indexOf=function(r,i,c){return k(this,r,i,c,!0)},f.prototype.lastIndexOf=function(r,i,c){return k(this,r,i,c,!1)};function K(u,r,i,c){i=Number(i)||0;const d=u.length-i;c?(c=Number(c),c>d&&(c=d)):c=d;const p=r.length;c>p/2&&(c=p/2);let y;for(y=0;y<c;++y){const U=parseInt(r.substr(y*2,2),16);if(tt(U))return y;u[i+y]=U}return y}function V(u,r,i,c){return je(et(r,u.length-i),u,i,c)}function re(u,r,i,c){return je(lr(r),u,i,c)}function ce(u,r,i,c){return je(It(r),u,i,c)}function ne(u,r,i,c){return je(dr(r,u.length-i),u,i,c)}f.prototype.write=function(r,i,c,d){if(i===void 0)d="utf8",c=this.length,i=0;else if(c===void 0&&typeof i=="string")d=i,c=this.length,i=0;else if(isFinite(i))i=i>>>0,isFinite(c)?(c=c>>>0,d===void 0&&(d="utf8")):(d=c,c=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const p=this.length-i;if((c===void 0||c>p)&&(c=p),r.length>0&&(c<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");let y=!1;for(;;)switch(d){case"hex":return K(this,r,i,c);case"utf8":case"utf-8":return V(this,r,i,c);case"ascii":case"latin1":case"binary":return re(this,r,i,c);case"base64":return ce(this,r,i,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne(this,r,i,c);default:if(y)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),y=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function fe(u,r,i){return r===0&&i===u.length?e.fromByteArray(u):e.fromByteArray(u.slice(r,i))}function pe(u,r,i){i=Math.min(u.length,i);const c=[];let d=r;for(;d<i;){const p=u[d];let y=null,U=p>239?4:p>223?3:p>191?2:1;if(d+U<=i){let O,C,N,P;switch(U){case 1:p<128&&(y=p);break;case 2:O=u[d+1],(O&192)===128&&(P=(p&31)<<6|O&63,P>127&&(y=P));break;case 3:O=u[d+1],C=u[d+2],(O&192)===128&&(C&192)===128&&(P=(p&15)<<12|(O&63)<<6|C&63,P>2047&&(P<55296||P>57343)&&(y=P));break;case 4:O=u[d+1],C=u[d+2],N=u[d+3],(O&192)===128&&(C&192)===128&&(N&192)===128&&(P=(p&15)<<18|(O&63)<<12|(C&63)<<6|N&63,P>65535&&P<1114112&&(y=P))}}y===null?(y=65533,U=1):y>65535&&(y-=65536,c.push(y>>>10&1023|55296),y=56320|y&1023),c.push(y),d+=U}return ke(c)}const B=4096;function ke(u){const r=u.length;if(r<=B)return String.fromCharCode.apply(String,u);let i="",c=0;for(;c<r;)i+=String.fromCharCode.apply(String,u.slice(c,c+=B));return i}function Pe(u,r,i){let c="";i=Math.min(u.length,i);for(let d=r;d<i;++d)c+=String.fromCharCode(u[d]&127);return c}function Fe(u,r,i){let c="";i=Math.min(u.length,i);for(let d=r;d<i;++d)c+=String.fromCharCode(u[d]);return c}function Ce(u,r,i){const c=u.length;(!r||r<0)&&(r=0),(!i||i<0||i>c)&&(i=c);let d="";for(let p=r;p<i;++p)d+=hr[u[p]];return d}function De(u,r,i){const c=u.slice(r,i);let d="";for(let p=0;p<c.length-1;p+=2)d+=String.fromCharCode(c[p]+c[p+1]*256);return d}f.prototype.slice=function(r,i){const c=this.length;r=~~r,i=i===void 0?c:~~i,r<0?(r+=c,r<0&&(r=0)):r>c&&(r=c),i<0?(i+=c,i<0&&(i=0)):i>c&&(i=c),i<r&&(i=r);const d=this.subarray(r,i);return Object.setPrototypeOf(d,f.prototype),d};function L(u,r,i){if(u%1!==0||u<0)throw new RangeError("offset is not uint");if(u+r>i)throw new RangeError("Trying to access beyond buffer length")}f.prototype.readUintLE=f.prototype.readUIntLE=function(r,i,c){r=r>>>0,i=i>>>0,c||L(r,i,this.length);let d=this[r],p=1,y=0;for(;++y<i&&(p*=256);)d+=this[r+y]*p;return d},f.prototype.readUintBE=f.prototype.readUIntBE=function(r,i,c){r=r>>>0,i=i>>>0,c||L(r,i,this.length);let d=this[r+--i],p=1;for(;i>0&&(p*=256);)d+=this[r+--i]*p;return d},f.prototype.readUint8=f.prototype.readUInt8=function(r,i){return r=r>>>0,i||L(r,1,this.length),this[r]},f.prototype.readUint16LE=f.prototype.readUInt16LE=function(r,i){return r=r>>>0,i||L(r,2,this.length),this[r]|this[r+1]<<8},f.prototype.readUint16BE=f.prototype.readUInt16BE=function(r,i){return r=r>>>0,i||L(r,2,this.length),this[r]<<8|this[r+1]},f.prototype.readUint32LE=f.prototype.readUInt32LE=function(r,i){return r=r>>>0,i||L(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+this[r+3]*16777216},f.prototype.readUint32BE=f.prototype.readUInt32BE=function(r,i){return r=r>>>0,i||L(r,4,this.length),this[r]*16777216+(this[r+1]<<16|this[r+2]<<8|this[r+3])},f.prototype.readBigUInt64LE=ve(function(r){r=r>>>0,Se(r,"offset");const i=this[r],c=this[r+7];(i===void 0||c===void 0)&&Le(r,this.length-8);const d=i+this[++r]*2**8+this[++r]*2**16+this[++r]*2**24,p=this[++r]+this[++r]*2**8+this[++r]*2**16+c*2**24;return BigInt(d)+(BigInt(p)<<BigInt(32))}),f.prototype.readBigUInt64BE=ve(function(r){r=r>>>0,Se(r,"offset");const i=this[r],c=this[r+7];(i===void 0||c===void 0)&&Le(r,this.length-8);const d=i*2**24+this[++r]*2**16+this[++r]*2**8+this[++r],p=this[++r]*2**24+this[++r]*2**16+this[++r]*2**8+c;return(BigInt(d)<<BigInt(32))+BigInt(p)}),f.prototype.readIntLE=function(r,i,c){r=r>>>0,i=i>>>0,c||L(r,i,this.length);let d=this[r],p=1,y=0;for(;++y<i&&(p*=256);)d+=this[r+y]*p;return p*=128,d>=p&&(d-=Math.pow(2,8*i)),d},f.prototype.readIntBE=function(r,i,c){r=r>>>0,i=i>>>0,c||L(r,i,this.length);let d=i,p=1,y=this[r+--d];for(;d>0&&(p*=256);)y+=this[r+--d]*p;return p*=128,y>=p&&(y-=Math.pow(2,8*i)),y},f.prototype.readInt8=function(r,i){return r=r>>>0,i||L(r,1,this.length),this[r]&128?(255-this[r]+1)*-1:this[r]},f.prototype.readInt16LE=function(r,i){r=r>>>0,i||L(r,2,this.length);const c=this[r]|this[r+1]<<8;return c&32768?c|4294901760:c},f.prototype.readInt16BE=function(r,i){r=r>>>0,i||L(r,2,this.length);const c=this[r+1]|this[r]<<8;return c&32768?c|4294901760:c},f.prototype.readInt32LE=function(r,i){return r=r>>>0,i||L(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},f.prototype.readInt32BE=function(r,i){return r=r>>>0,i||L(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},f.prototype.readBigInt64LE=ve(function(r){r=r>>>0,Se(r,"offset");const i=this[r],c=this[r+7];(i===void 0||c===void 0)&&Le(r,this.length-8);const d=this[r+4]+this[r+5]*2**8+this[r+6]*2**16+(c<<24);return(BigInt(d)<<BigInt(32))+BigInt(i+this[++r]*2**8+this[++r]*2**16+this[++r]*2**24)}),f.prototype.readBigInt64BE=ve(function(r){r=r>>>0,Se(r,"offset");const i=this[r],c=this[r+7];(i===void 0||c===void 0)&&Le(r,this.length-8);const d=(i<<24)+this[++r]*2**16+this[++r]*2**8+this[++r];return(BigInt(d)<<BigInt(32))+BigInt(this[++r]*2**24+this[++r]*2**16+this[++r]*2**8+c)}),f.prototype.readFloatLE=function(r,i){return r=r>>>0,i||L(r,4,this.length),n.read(this,r,!0,23,4)},f.prototype.readFloatBE=function(r,i){return r=r>>>0,i||L(r,4,this.length),n.read(this,r,!1,23,4)},f.prototype.readDoubleLE=function(r,i){return r=r>>>0,i||L(r,8,this.length),n.read(this,r,!0,52,8)},f.prototype.readDoubleBE=function(r,i){return r=r>>>0,i||L(r,8,this.length),n.read(this,r,!1,52,8)};function Y(u,r,i,c,d,p){if(!f.isBuffer(u))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>d||r<p)throw new RangeError('"value" argument is out of bounds');if(i+c>u.length)throw new RangeError("Index out of range")}f.prototype.writeUintLE=f.prototype.writeUIntLE=function(r,i,c,d){if(r=+r,i=i>>>0,c=c>>>0,!d){const U=Math.pow(2,8*c)-1;Y(this,r,i,c,U,0)}let p=1,y=0;for(this[i]=r&255;++y<c&&(p*=256);)this[i+y]=r/p&255;return i+c},f.prototype.writeUintBE=f.prototype.writeUIntBE=function(r,i,c,d){if(r=+r,i=i>>>0,c=c>>>0,!d){const U=Math.pow(2,8*c)-1;Y(this,r,i,c,U,0)}let p=c-1,y=1;for(this[i+p]=r&255;--p>=0&&(y*=256);)this[i+p]=r/y&255;return i+c},f.prototype.writeUint8=f.prototype.writeUInt8=function(r,i,c){return r=+r,i=i>>>0,c||Y(this,r,i,1,255,0),this[i]=r&255,i+1},f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(r,i,c){return r=+r,i=i>>>0,c||Y(this,r,i,2,65535,0),this[i]=r&255,this[i+1]=r>>>8,i+2},f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(r,i,c){return r=+r,i=i>>>0,c||Y(this,r,i,2,65535,0),this[i]=r>>>8,this[i+1]=r&255,i+2},f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(r,i,c){return r=+r,i=i>>>0,c||Y(this,r,i,4,4294967295,0),this[i+3]=r>>>24,this[i+2]=r>>>16,this[i+1]=r>>>8,this[i]=r&255,i+4},f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(r,i,c){return r=+r,i=i>>>0,c||Y(this,r,i,4,4294967295,0),this[i]=r>>>24,this[i+1]=r>>>16,this[i+2]=r>>>8,this[i+3]=r&255,i+4};function Ie(u,r,i,c,d){wt(r,c,d,u,i,7);let p=Number(r&BigInt(4294967295));u[i++]=p,p=p>>8,u[i++]=p,p=p>>8,u[i++]=p,p=p>>8,u[i++]=p;let y=Number(r>>BigInt(32)&BigInt(4294967295));return u[i++]=y,y=y>>8,u[i++]=y,y=y>>8,u[i++]=y,y=y>>8,u[i++]=y,i}function _e(u,r,i,c,d){wt(r,c,d,u,i,7);let p=Number(r&BigInt(4294967295));u[i+7]=p,p=p>>8,u[i+6]=p,p=p>>8,u[i+5]=p,p=p>>8,u[i+4]=p;let y=Number(r>>BigInt(32)&BigInt(4294967295));return u[i+3]=y,y=y>>8,u[i+2]=y,y=y>>8,u[i+1]=y,y=y>>8,u[i]=y,i+8}f.prototype.writeBigUInt64LE=ve(function(r,i=0){return Ie(this,r,i,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeBigUInt64BE=ve(function(r,i=0){return _e(this,r,i,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeIntLE=function(r,i,c,d){if(r=+r,i=i>>>0,!d){const O=Math.pow(2,8*c-1);Y(this,r,i,c,O-1,-O)}let p=0,y=1,U=0;for(this[i]=r&255;++p<c&&(y*=256);)r<0&&U===0&&this[i+p-1]!==0&&(U=1),this[i+p]=(r/y>>0)-U&255;return i+c},f.prototype.writeIntBE=function(r,i,c,d){if(r=+r,i=i>>>0,!d){const O=Math.pow(2,8*c-1);Y(this,r,i,c,O-1,-O)}let p=c-1,y=1,U=0;for(this[i+p]=r&255;--p>=0&&(y*=256);)r<0&&U===0&&this[i+p+1]!==0&&(U=1),this[i+p]=(r/y>>0)-U&255;return i+c},f.prototype.writeInt8=function(r,i,c){return r=+r,i=i>>>0,c||Y(this,r,i,1,127,-128),r<0&&(r=255+r+1),this[i]=r&255,i+1},f.prototype.writeInt16LE=function(r,i,c){return r=+r,i=i>>>0,c||Y(this,r,i,2,32767,-32768),this[i]=r&255,this[i+1]=r>>>8,i+2},f.prototype.writeInt16BE=function(r,i,c){return r=+r,i=i>>>0,c||Y(this,r,i,2,32767,-32768),this[i]=r>>>8,this[i+1]=r&255,i+2},f.prototype.writeInt32LE=function(r,i,c){return r=+r,i=i>>>0,c||Y(this,r,i,4,2147483647,-2147483648),this[i]=r&255,this[i+1]=r>>>8,this[i+2]=r>>>16,this[i+3]=r>>>24,i+4},f.prototype.writeInt32BE=function(r,i,c){return r=+r,i=i>>>0,c||Y(this,r,i,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),this[i]=r>>>24,this[i+1]=r>>>16,this[i+2]=r>>>8,this[i+3]=r&255,i+4},f.prototype.writeBigInt64LE=ve(function(r,i=0){return Ie(this,r,i,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),f.prototype.writeBigInt64BE=ve(function(r,i=0){return _e(this,r,i,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function be(u,r,i,c,d,p){if(i+c>u.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function Te(u,r,i,c,d){return r=+r,i=i>>>0,d||be(u,r,i,4),n.write(u,r,i,c,23,4),i+4}f.prototype.writeFloatLE=function(r,i,c){return Te(this,r,i,!0,c)},f.prototype.writeFloatBE=function(r,i,c){return Te(this,r,i,!1,c)};function le(u,r,i,c,d){return r=+r,i=i>>>0,d||be(u,r,i,8),n.write(u,r,i,c,52,8),i+8}f.prototype.writeDoubleLE=function(r,i,c){return le(this,r,i,!0,c)},f.prototype.writeDoubleBE=function(r,i,c){return le(this,r,i,!1,c)},f.prototype.copy=function(r,i,c,d){if(!f.isBuffer(r))throw new TypeError("argument should be a Buffer");if(c||(c=0),!d&&d!==0&&(d=this.length),i>=r.length&&(i=r.length),i||(i=0),d>0&&d<c&&(d=c),d===c||r.length===0||this.length===0)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),r.length-i<d-c&&(d=r.length-i+c);const p=d-c;return this===r&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(i,c,d):Uint8Array.prototype.set.call(r,this.subarray(c,d),i),p},f.prototype.fill=function(r,i,c,d){if(typeof r=="string"){if(typeof i=="string"?(d=i,i=0,c=this.length):typeof c=="string"&&(d=c,c=this.length),d!==void 0&&typeof d!="string")throw new TypeError("encoding must be a string");if(typeof d=="string"&&!f.isEncoding(d))throw new TypeError("Unknown encoding: "+d);if(r.length===1){const y=r.charCodeAt(0);(d==="utf8"&&y<128||d==="latin1")&&(r=y)}}else typeof r=="number"?r=r&255:typeof r=="boolean"&&(r=Number(r));if(i<0||this.length<i||this.length<c)throw new RangeError("Out of range index");if(c<=i)return this;i=i>>>0,c=c===void 0?this.length:c>>>0,r||(r=0);let p;if(typeof r=="number")for(p=i;p<c;++p)this[p]=r;else{const y=f.isBuffer(r)?r:f.from(r,d),U=y.length;if(U===0)throw new TypeError('The value "'+r+'" is invalid for argument "value"');for(p=0;p<c-i;++p)this[p+i]=y[p%U]}return this};const xe={};function Je(u,r,i){xe[u]=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:r.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${u}]`,this.stack,delete this.name}get code(){return u}set code(d){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:d,writable:!0})}toString(){return`${this.name} [${u}]: ${this.message}`}}}Je("ERR_BUFFER_OUT_OF_BOUNDS",function(u){return u?`${u} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Je("ERR_INVALID_ARG_TYPE",function(u,r){return`The "${u}" argument must be of type number. Received type ${typeof r}`},TypeError),Je("ERR_OUT_OF_RANGE",function(u,r,i){let c=`The value of "${u}" is out of range.`,d=i;return Number.isInteger(i)&&Math.abs(i)>2**32?d=Et(String(i)):typeof i=="bigint"&&(d=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(d=Et(d)),d+="n"),c+=` It must be ${r}. Received ${d}`,c},RangeError);function Et(u){let r="",i=u.length;const c=u[0]==="-"?1:0;for(;i>=c+4;i-=3)r=`_${u.slice(i-3,i)}${r}`;return`${u.slice(0,i)}${r}`}function ar(u,r,i){Se(r,"offset"),(u[r]===void 0||u[r+i]===void 0)&&Le(r,u.length-(i+1))}function wt(u,r,i,c,d,p){if(u>i||u<r){const y=typeof r=="bigint"?"n":"";let U;throw p>3?r===0||r===BigInt(0)?U=`>= 0${y} and < 2${y} ** ${(p+1)*8}${y}`:U=`>= -(2${y} ** ${(p+1)*8-1}${y}) and < 2 ** ${(p+1)*8-1}${y}`:U=`>= ${r}${y} and <= ${i}${y}`,new xe.ERR_OUT_OF_RANGE("value",U,u)}ar(c,d,p)}function Se(u,r){if(typeof u!="number")throw new xe.ERR_INVALID_ARG_TYPE(r,"number",u)}function Le(u,r,i){throw Math.floor(u)!==u?(Se(u,i),new xe.ERR_OUT_OF_RANGE(i||"offset","an integer",u)):r<0?new xe.ERR_BUFFER_OUT_OF_BOUNDS:new xe.ERR_OUT_OF_RANGE(i||"offset",`>= ${i?1:0} and <= ${r}`,u)}const cr=/[^+/0-9A-Za-z-_]/g;function fr(u){if(u=u.split("=")[0],u=u.trim().replace(cr,""),u.length<2)return"";for(;u.length%4!==0;)u=u+"=";return u}function et(u,r){r=r||1/0;let i;const c=u.length;let d=null;const p=[];for(let y=0;y<c;++y){if(i=u.charCodeAt(y),i>55295&&i<57344){if(!d){if(i>56319){(r-=3)>-1&&p.push(239,191,189);continue}else if(y+1===c){(r-=3)>-1&&p.push(239,191,189);continue}d=i;continue}if(i<56320){(r-=3)>-1&&p.push(239,191,189),d=i;continue}i=(d-55296<<10|i-56320)+65536}else d&&(r-=3)>-1&&p.push(239,191,189);if(d=null,i<128){if((r-=1)<0)break;p.push(i)}else if(i<2048){if((r-=2)<0)break;p.push(i>>6|192,i&63|128)}else if(i<65536){if((r-=3)<0)break;p.push(i>>12|224,i>>6&63|128,i&63|128)}else if(i<1114112){if((r-=4)<0)break;p.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else throw new Error("Invalid code point")}return p}function lr(u){const r=[];for(let i=0;i<u.length;++i)r.push(u.charCodeAt(i)&255);return r}function dr(u,r){let i,c,d;const p=[];for(let y=0;y<u.length&&!((r-=2)<0);++y)i=u.charCodeAt(y),c=i>>8,d=i%256,p.push(d),p.push(c);return p}function It(u){return e.toByteArray(fr(u))}function je(u,r,i,c){let d;for(d=0;d<c&&!(d+i>=r.length||d>=u.length);++d)r[d+i]=u[d];return d}function ie(u,r){return u instanceof r||u!=null&&u.constructor!=null&&u.constructor.name!=null&&u.constructor.name===r.name}function tt(u){return u!==u}const hr=function(){const u="0123456789abcdef",r=new Array(256);for(let i=0;i<16;++i){const c=i*16;for(let d=0;d<16;++d)r[c+d]=u[i]+u[d]}return r}();function ve(u){return typeof BigInt>"u"?pr:u}function pr(){throw new Error("BigInt not supported")}})(qt);var $t={exports:{}},M=$t.exports={},ue,se;function ct(){throw new Error("setTimeout has not been defined")}function ft(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?ue=setTimeout:ue=ct}catch{ue=ct}try{typeof clearTimeout=="function"?se=clearTimeout:se=ft}catch{se=ft}})();function jt(t){if(ue===setTimeout)return setTimeout(t,0);if((ue===ct||!ue)&&setTimeout)return ue=setTimeout,setTimeout(t,0);try{return ue(t,0)}catch{try{return ue.call(null,t,0)}catch{return ue.call(this,t,0)}}}function Tr(t){if(se===clearTimeout)return clearTimeout(t);if((se===ft||!se)&&clearTimeout)return se=clearTimeout,clearTimeout(t);try{return se(t)}catch{try{return se.call(null,t)}catch{return se.call(this,t)}}}var de=[],Ae=!1,Ee,Ke=-1;function xr(){!Ae||!Ee||(Ae=!1,Ee.length?de=Ee.concat(de):Ke=-1,de.length&&Wt())}function Wt(){if(!Ae){var t=jt(xr);Ae=!0;for(var e=de.length;e;){for(Ee=de,de=[];++Ke<e;)Ee&&Ee[Ke].run();Ke=-1,e=de.length}Ee=null,Ae=!1,Tr(t)}}M.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];de.push(new Gt(t,e)),de.length===1&&!Ae&&jt(Wt)};function Gt(t,e){this.fun=t,this.array=e}Gt.prototype.run=function(){this.fun.apply(null,this.array)};M.title="browser";M.browser=!0;M.env={};M.argv=[];M.version="";M.versions={};function he(){}M.on=he;M.addListener=he;M.once=he;M.off=he;M.removeListener=he;M.removeAllListeners=he;M.emit=he;M.prependListener=he;M.prependOnceListener=he;M.listeners=function(t){return[]};M.binding=function(t){throw new Error("process.binding is not supported")};M.cwd=function(){return"/"};M.chdir=function(t){throw new Error("process.chdir is not supported")};M.umask=function(){return 0};var Sr=$t.exports;const Br=vr(Sr),Me=globalThis||void 0||self,ai=Object.freeze(Object.defineProperty({__proto__:null,Buffer:qt.Buffer,global:Me,process:Br},Symbol.toStringTag,{value:"Module"}));var lt=function(t,e){return lt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},lt(t,e)};function we(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");lt(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var T=function(){return T=Object.assign||function(e){for(var n,o=1,s=arguments.length;o<s;o++){n=arguments[o];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},T.apply(this,arguments)};function dt(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,o=Object.getOwnPropertySymbols(t);s<o.length;s++)e.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(t,o[s])&&(n[o[s]]=t[o[s]]);return n}function I(t,e,n,o){function s(a){return a instanceof n?a:new n(function(l){l(a)})}return new(n||(n=Promise))(function(a,l){function f(h){try{v(o.next(h))}catch(m){l(m)}}function g(h){try{v(o.throw(h))}catch(m){l(m)}}function v(h){h.done?a(h.value):s(h.value).then(f,g)}v((o=o.apply(t,e||[])).next())})}function _(t,e){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},o,s,a,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(v){return function(h){return g([v,h])}}function g(v){if(o)throw new TypeError("Generator is already executing.");for(;l&&(l=0,v[0]&&(n=0)),n;)try{if(o=1,s&&(a=v[0]&2?s.return:v[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,v[1])).done)return a;switch(s=0,a&&(v=[v[0]&2,a.value]),v[0]){case 0:case 1:a=v;break;case 4:return n.label++,{value:v[1],done:!1};case 5:n.label++,s=v[1],v=[0];continue;case 7:v=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(v[0]===6||v[0]===2)){n=0;continue}if(v[0]===3&&(!a||v[1]>a[0]&&v[1]<a[3])){n.label=v[1];break}if(v[0]===6&&n.label<a[1]){n.label=a[1],a=v;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(v);break}a[2]&&n.ops.pop(),n.trys.pop();continue}v=e.call(t,n)}catch(h){v=[6,h],s=0}finally{o=a=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}}function Ue(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function X(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var o=n.call(t),s,a=[],l;try{for(;(e===void 0||e-- >0)&&!(s=o.next()).done;)a.push(s.value)}catch(f){l={error:f}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(l)throw l.error}}return a}function oe(t,e,n){if(n||arguments.length===2)for(var o=0,s=e.length,a;o<s;o++)(a||!(o in e))&&(a||(a=Array.prototype.slice.call(e,0,o)),a[o]=e[o]);return t.concat(a||Array.prototype.slice.call(e))}var z;(function(t){t.SET="$set",t.SET_ONCE="$setOnce",t.ADD="$add",t.APPEND="$append",t.PREPEND="$prepend",t.REMOVE="$remove",t.PREINSERT="$preInsert",t.POSTINSERT="$postInsert",t.UNSET="$unset",t.CLEAR_ALL="$clearAll"})(z||(z={}));var me;(function(t){t.REVENUE_PRODUCT_ID="$productId",t.REVENUE_QUANTITY="$quantity",t.REVENUE_PRICE="$price",t.REVENUE_TYPE="$revenueType",t.REVENUE="$revenue"})(me||(me={}));var Re;(function(t){t.IDENTIFY="$identify",t.GROUP_IDENTIFY="$groupidentify",t.REVENUE="revenue_amount"})(Re||(Re={}));var Z;(function(t){t[t.None=0]="None",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Verbose=3]="Verbose",t[t.Debug=4]="Debug"})(Z||(Z={}));var Q;(function(t){t.Unknown="unknown",t.Skipped="skipped",t.Success="success",t.RateLimit="rate_limit",t.PayloadTooLarge="payload_too_large",t.Invalid="invalid",t.Failed="failed",t.Timeout="Timeout",t.SystemError="SystemError"})(Q||(Q={}));var _t="-",Ze="AMP",Ar="".concat(Ze,"_unsent"),Kt="https://api2.amplitude.com/2/httpapi",Ur="https://api.eu.amplitude.com/2/httpapi",Rr="https://api2.amplitude.com/batch",kr="https://api.eu.amplitude.com/batch",Pr=1e3,ht=function(t){if(Object.keys(t).length>Pr)return!1;for(var e in t){var n=t[e];if(!Qt(e,n))return!1}return!0},Qt=function(t,e){var n,o;if(typeof t!="string")return!1;if(Array.isArray(e)){var s=!0;try{for(var a=Ue(e),l=a.next();!l.done;l=a.next()){var f=l.value;if(Array.isArray(f))return!1;if(typeof f=="object")s=s&&ht(f);else if(!["number","string"].includes(typeof f))return!1;if(!s)return!1}}catch(g){n={error:g}}finally{try{l&&!l.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}}else{if(e==null)return!1;if(typeof e=="object")return ht(e);if(!["number","string","boolean"].includes(typeof e))return!1}return!0},ze=function(){function t(){this._propertySet=new Set,this._properties={}}return t.prototype.getUserProperties=function(){return T({},this._properties)},t.prototype.set=function(e,n){return this._safeSet(z.SET,e,n),this},t.prototype.setOnce=function(e,n){return this._safeSet(z.SET_ONCE,e,n),this},t.prototype.append=function(e,n){return this._safeSet(z.APPEND,e,n),this},t.prototype.prepend=function(e,n){return this._safeSet(z.PREPEND,e,n),this},t.prototype.postInsert=function(e,n){return this._safeSet(z.POSTINSERT,e,n),this},t.prototype.preInsert=function(e,n){return this._safeSet(z.PREINSERT,e,n),this},t.prototype.remove=function(e,n){return this._safeSet(z.REMOVE,e,n),this},t.prototype.add=function(e,n){return this._safeSet(z.ADD,e,n),this},t.prototype.unset=function(e){return this._safeSet(z.UNSET,e,_t),this},t.prototype.clearAll=function(){return this._properties={},this._properties[z.CLEAR_ALL]=_t,this},t.prototype._safeSet=function(e,n,o){if(this._validate(e,n,o)){var s=this._properties[e];return s===void 0&&(s={},this._properties[e]=s),s[n]=o,this._propertySet.add(n),!0}return!1},t.prototype._validate=function(e,n,o){return this._properties[z.CLEAR_ALL]!==void 0||this._propertySet.has(n)?!1:e===z.ADD?typeof o=="number":e!==z.UNSET&&e!==z.REMOVE?Qt(n,o):!0},t}(),Fr=function(t,e,n){var o=typeof t=="string"?{event_type:t}:t;return T(T(T({},o),n),e&&{event_properties:e})},Yt=function(t,e){var n=T(T({},e),{event_type:Re.IDENTIFY,user_properties:t.getUserProperties()});return n},Cr=function(t,e,n,o){var s,a=T(T({},o),{event_type:Re.GROUP_IDENTIFY,group_properties:n.getUserProperties(),groups:(s={},s[t]=e,s)});return a},Dr=function(t,e,n){var o,s=new ze;s.set(t,e);var a=T(T({},n),{event_type:Re.IDENTIFY,user_properties:s.getUserProperties(),groups:(o={},o[t]=e,o)});return a},Lr=function(t,e){return T(T({},e),{event_type:Re.REVENUE,event_properties:t.getEventProperties()})},Ne=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=Q.Unknown),{event:t,code:e,message:n}},Ve=function(t){return t?(t^Math.random()*16>>t/4).toString(16):(String(1e7)+String(-1e3)+String(-4e3)+String(-8e3)+String(-1e11)).replace(/[018]/g,Ve)},Or=function(){function t(e){this.client=e,this.queue=[],this.applying=!1,this.plugins=[]}return t.prototype.register=function(e,n){var o,s,a;return I(this,void 0,void 0,function(){return _(this,function(l){switch(l.label){case 0:return e.name=(o=e.name)!==null&&o!==void 0?o:Ve(),e.type=(s=e.type)!==null&&s!==void 0?s:"enrichment",[4,(a=e.setup)===null||a===void 0?void 0:a.call(e,n,this.client)];case 1:return l.sent(),this.plugins.push(e),[2]}})})},t.prototype.deregister=function(e){var n;return I(this,void 0,void 0,function(){var o,s;return _(this,function(a){switch(a.label){case 0:return o=this.plugins.findIndex(function(l){return l.name===e}),s=this.plugins[o],this.plugins.splice(o,1),[4,(n=s.teardown)===null||n===void 0?void 0:n.call(s)];case 1:return a.sent(),[2]}})})},t.prototype.reset=function(e){this.applying=!1;var n=this.plugins;n.map(function(o){var s;return(s=o.teardown)===null||s===void 0?void 0:s.call(o)}),this.plugins=[],this.client=e},t.prototype.push=function(e){var n=this;return new Promise(function(o){n.queue.push([e,o]),n.scheduleApply(0)})},t.prototype.scheduleApply=function(e){var n=this;this.applying||(this.applying=!0,setTimeout(function(){n.apply(n.queue.shift()).then(function(){n.applying=!1,n.queue.length>0&&n.scheduleApply(0)})},e))},t.prototype.apply=function(e){return I(this,void 0,void 0,function(){var n,o,s,a,l,f,g,w,b,v,h,m,E,w,b,S,x,A,q,R,H,D;return _(this,function(k){switch(k.label){case 0:if(!e)return[2];n=X(e,1),o=n[0],s=X(e,2),a=s[1],l=this.plugins.filter(function(F){return F.type==="before"}),k.label=1;case 1:k.trys.push([1,6,7,8]),f=Ue(l),g=f.next(),k.label=2;case 2:return g.done?[3,5]:(w=g.value,w.execute?[4,w.execute(T({},o))]:[3,4]);case 3:if(b=k.sent(),b===null)return a({event:o,code:0,message:""}),[2];o=b,k.label=4;case 4:return g=f.next(),[3,2];case 5:return[3,8];case 6:return v=k.sent(),q={error:v},[3,8];case 7:try{g&&!g.done&&(R=f.return)&&R.call(f)}finally{if(q)throw q.error}return[7];case 8:h=this.plugins.filter(function(F){return F.type==="enrichment"||F.type===void 0}),k.label=9;case 9:k.trys.push([9,14,15,16]),m=Ue(h),E=m.next(),k.label=10;case 10:return E.done?[3,13]:(w=E.value,w.execute?[4,w.execute(T({},o))]:[3,12]);case 11:if(b=k.sent(),b===null)return a({event:o,code:0,message:""}),[2];o=b,k.label=12;case 12:return E=m.next(),[3,10];case 13:return[3,16];case 14:return S=k.sent(),H={error:S},[3,16];case 15:try{E&&!E.done&&(D=m.return)&&D.call(m)}finally{if(H)throw H.error}return[7];case 16:return x=this.plugins.filter(function(F){return F.type==="destination"}),A=x.map(function(F){var K=T({},o);return F.execute(K).catch(function(V){return Ne(K,0,String(V))})}),Promise.all(A).then(function(F){var K=X(F,1),V=K[0];a(V)}),[2]}})})},t.prototype.flush=function(){return I(this,void 0,void 0,function(){var e,n,o,s=this;return _(this,function(a){switch(a.label){case 0:return e=this.queue,this.queue=[],[4,Promise.all(e.map(function(l){return s.apply(l)}))];case 1:return a.sent(),n=this.plugins.filter(function(l){return l.type==="destination"}),o=n.map(function(l){return l.flush&&l.flush()}),[4,Promise.all(o)];case 2:return a.sent(),[2]}})})},t}(),Nr="Event tracked successfully",Mr="Unexpected error occurred",qr="Event rejected due to exceeded retry count",Vr="Event skipped due to optOut config",$r="Event rejected due to missing API key",jr="Invalid API key",Wr="Client not initialized",ee=function(t){return{promise:t||Promise.resolve()}},Gr=function(){function t(e){e===void 0&&(e="$default"),this.initializing=!1,this.q=[],this.dispatchQ=[],this.logEvent=this.track.bind(this),this.timeline=new Or(this),this.name=e}return t.prototype._init=function(e){return I(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return this.config=e,this.timeline.reset(this),[4,this.runQueuedFunctions("q")];case 1:return n.sent(),[2]}})})},t.prototype.runQueuedFunctions=function(e){return I(this,void 0,void 0,function(){var n,o,s,a,l,f,g;return _(this,function(v){switch(v.label){case 0:n=this[e],this[e]=[],v.label=1;case 1:v.trys.push([1,6,7,8]),o=Ue(n),s=o.next(),v.label=2;case 2:return s.done?[3,5]:(a=s.value,[4,a()]);case 3:v.sent(),v.label=4;case 4:return s=o.next(),[3,2];case 5:return[3,8];case 6:return l=v.sent(),f={error:l},[3,8];case 7:try{s&&!s.done&&(g=o.return)&&g.call(o)}finally{if(f)throw f.error}return[7];case 8:return[2]}})})},t.prototype.track=function(e,n,o){var s=Fr(e,n,o);return ee(this.dispatch(s))},t.prototype.identify=function(e,n){var o=Yt(e,n);return ee(this.dispatch(o))},t.prototype.groupIdentify=function(e,n,o,s){var a=Cr(e,n,o,s);return ee(this.dispatch(a))},t.prototype.setGroup=function(e,n,o){var s=Dr(e,n,o);return ee(this.dispatch(s))},t.prototype.revenue=function(e,n){var o=Lr(e,n);return ee(this.dispatch(o))},t.prototype.add=function(e){return this.config?ee(this.timeline.register(e,this.config)):(this.q.push(this.add.bind(this,e)),ee())},t.prototype.remove=function(e){return this.config?ee(this.timeline.deregister(e)):(this.q.push(this.remove.bind(this,e)),ee())},t.prototype.dispatchWithCallback=function(e,n){if(!this.config)return n(Ne(e,0,Wr));this.process(e).then(n)},t.prototype.dispatch=function(e){return I(this,void 0,void 0,function(){var n=this;return _(this,function(o){return this.config?[2,this.process(e)]:[2,new Promise(function(s){n.dispatchQ.push(n.dispatchWithCallback.bind(n,e,s))})]})})},t.prototype.process=function(e){return I(this,void 0,void 0,function(){var s,n,o,s;return _(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),this.config.optOut?[2,Ne(e,0,Vr)]:[4,this.timeline.push(e)];case 1:return s=a.sent(),s.code===200?this.config.loggerProvider.log(s.message):this.config.loggerProvider.error(s.message),[2,s];case 2:return n=a.sent(),o=String(n),this.config.loggerProvider.error(o),s=Ne(e,0,o),[2,s];case 3:return[2]}})})},t.prototype.setOptOut=function(e){if(!this.config){this.q.push(this.setOptOut.bind(this,!!e));return}this.config.optOut=!!e},t.prototype.flush=function(){return ee(this.timeline.flush())},t}(),Kr=function(){function t(){this.productId="",this.quantity=1,this.price=0}return t.prototype.setProductId=function(e){return this.productId=e,this},t.prototype.setQuantity=function(e){return e>0&&(this.quantity=e),this},t.prototype.setPrice=function(e){return this.price=e,this},t.prototype.setRevenueType=function(e){return this.revenueType=e,this},t.prototype.setRevenue=function(e){return this.revenue=e,this},t.prototype.setEventProperties=function(e){return ht(e)&&(this.properties=e),this},t.prototype.getEventProperties=function(){var e=this.properties?T({},this.properties):{};return e[me.REVENUE_PRODUCT_ID]=this.productId,e[me.REVENUE_QUANTITY]=this.quantity,e[me.REVENUE_PRICE]=this.price,e[me.REVENUE_TYPE]=this.revenueType,e[me.REVENUE]=this.revenue,e},t}(),Qr=function(t,e){var n=Math.max(e,1);return t.reduce(function(o,s,a){var l=Math.floor(a/n);return o[l]||(o[l]=[]),o[l].push(s),o},[])},We="Amplitude Logger ",zt=function(){function t(){this.logLevel=Z.None}return t.prototype.disable=function(){this.logLevel=Z.None},t.prototype.enable=function(e){e===void 0&&(e=Z.Warn),this.logLevel=e},t.prototype.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.logLevel<Z.Verbose||console.log("".concat(We,"[Log]: ").concat(e.join(" ")))},t.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.logLevel<Z.Warn||console.warn("".concat(We,"[Warn]: ").concat(e.join(" ")))},t.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.logLevel<Z.Error||console.error("".concat(We,"[Error]: ").concat(e.join(" ")))},t.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.logLevel<Z.Debug||console.log("".concat(We,"[Debug]: ").concat(e.join(" ")))},t}(),Qe=function(){return{flushMaxRetries:12,flushQueueSize:200,flushIntervalMillis:1e4,instanceName:"$default_instance",logLevel:Z.Warn,loggerProvider:new zt,optOut:!1,serverUrl:Kt,serverZone:"US",useBatch:!1}},Yr=function(){function t(e){var n,o,s,a;this._optOut=!1;var l=Qe();this.apiKey=e.apiKey,this.flushIntervalMillis=(n=e.flushIntervalMillis)!==null&&n!==void 0?n:l.flushIntervalMillis,this.flushMaxRetries=e.flushMaxRetries||l.flushMaxRetries,this.flushQueueSize=e.flushQueueSize||l.flushQueueSize,this.instanceName=e.instanceName||l.instanceName,this.loggerProvider=e.loggerProvider||l.loggerProvider,this.logLevel=(o=e.logLevel)!==null&&o!==void 0?o:l.logLevel,this.minIdLength=e.minIdLength,this.plan=e.plan,this.ingestionMetadata=e.ingestionMetadata,this.optOut=(s=e.optOut)!==null&&s!==void 0?s:l.optOut,this.serverUrl=e.serverUrl,this.serverZone=e.serverZone||l.serverZone,this.storageProvider=e.storageProvider,this.transportProvider=e.transportProvider,this.useBatch=(a=e.useBatch)!==null&&a!==void 0?a:l.useBatch,this.loggerProvider.enable(this.logLevel);var f=Ht(e.serverUrl,e.serverZone,e.useBatch);this.serverZone=f.serverZone,this.serverUrl=f.serverUrl}return Object.defineProperty(t.prototype,"optOut",{get:function(){return this._optOut},set:function(e){this._optOut=e},enumerable:!1,configurable:!0}),t}(),zr=function(t,e){return t==="EU"?e?kr:Ur:e?Rr:Kt},Ht=function(t,e,n){if(t===void 0&&(t=""),e===void 0&&(e=Qe().serverZone),n===void 0&&(n=Qe().useBatch),t)return{serverUrl:t,serverZone:void 0};var o=["US","EU"].includes(e)?e:Qe().serverZone;return{serverZone:o,serverUrl:zr(o,n)}};function Hr(t){return t instanceof Error?t.message:String(t)}function Ge(t){var e="";try{"body"in t&&(e=JSON.stringify(t.body,null,2))}catch{}return e}var Xr=function(){function t(){this.name="amplitude",this.type="destination",this.retryTimeout=1e3,this.throttleTimeout=3e4,this.storageKey="",this.scheduled=null,this.queue=[]}return t.prototype.setup=function(e){var n;return I(this,void 0,void 0,function(){var o,s=this;return _(this,function(a){switch(a.label){case 0:return this.config=e,this.storageKey="".concat(Ar,"_").concat(this.config.apiKey.substring(0,10)),[4,(n=this.config.storageProvider)===null||n===void 0?void 0:n.get(this.storageKey)];case 1:return o=a.sent(),this.saveEvents(),o&&o.length>0&&Promise.all(o.map(function(l){return s.execute(l)})).catch(),[2,Promise.resolve(void 0)]}})})},t.prototype.execute=function(e){var n=this;return new Promise(function(o){var s={event:e,attempts:0,callback:function(a){return o(a)},timeout:0};n.addToQueue(s)})},t.prototype.addToQueue=function(){for(var e=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var s=n.filter(function(a){return a.attempts<e.config.flushMaxRetries?(a.attempts+=1,!0):(e.fulfillRequest([a],500,qr),!1)});s.forEach(function(a){if(e.queue=e.queue.concat(a),a.timeout===0){e.schedule(e.config.flushIntervalMillis);return}setTimeout(function(){a.timeout=0,e.schedule(0)},a.timeout)}),this.saveEvents()},t.prototype.schedule=function(e){var n=this;this.scheduled||(this.scheduled=setTimeout(function(){n.flush(!0).then(function(){n.queue.length>0&&n.schedule(e)})},e))},t.prototype.flush=function(e){return e===void 0&&(e=!1),I(this,void 0,void 0,function(){var n,o,s,a=this;return _(this,function(l){switch(l.label){case 0:return n=[],o=[],this.queue.forEach(function(f){return f.timeout===0?n.push(f):o.push(f)}),this.queue=o,this.scheduled&&(clearTimeout(this.scheduled),this.scheduled=null),s=Qr(n,this.config.flushQueueSize),[4,Promise.all(s.map(function(f){return a.send(f,e)}))];case 1:return l.sent(),[2]}})})},t.prototype.send=function(e,n){return n===void 0&&(n=!0),I(this,void 0,void 0,function(){var o,s,a,l,f;return _(this,function(g){switch(g.label){case 0:if(!this.config.apiKey)return[2,this.fulfillRequest(e,400,$r)];o={api_key:this.config.apiKey,events:e.map(function(v){var h=v.event;h.extra;var m=dt(h,["extra"]);return m}),options:{min_id_length:this.config.minIdLength}},g.label=1;case 1:return g.trys.push([1,3,,4]),s=Ht(this.config.serverUrl,this.config.serverZone,this.config.useBatch).serverUrl,[4,this.config.transportProvider.send(s,o)];case 2:return a=g.sent(),a===null?(this.fulfillRequest(e,0,Mr),[2]):n?(this.handleResponse(a,e),[3,4]):("body"in a?this.fulfillRequest(e,a.statusCode,"".concat(a.status,": ").concat(Ge(a))):this.fulfillRequest(e,a.statusCode,a.status),[2]);case 3:return l=g.sent(),f=Hr(l),this.config.loggerProvider.error(f),this.fulfillRequest(e,0,f),[3,4];case 4:return[2]}})})},t.prototype.handleResponse=function(e,n){var o=e.status;switch(o){case Q.Success:{this.handleSuccessResponse(e,n);break}case Q.Invalid:{this.handleInvalidResponse(e,n);break}case Q.PayloadTooLarge:{this.handlePayloadTooLargeResponse(e,n);break}case Q.RateLimit:{this.handleRateLimitResponse(e,n);break}default:{this.config.loggerProvider.warn(`{code: 0, error: "Status '`.concat(o,"' provided for ").concat(n.length,' events"}')),this.handleOtherResponse(n);break}}},t.prototype.handleSuccessResponse=function(e,n){this.fulfillRequest(n,e.statusCode,Nr)},t.prototype.handleInvalidResponse=function(e,n){var o=this;if(e.body.missingField||e.body.error.startsWith(jr)){this.fulfillRequest(n,e.statusCode,e.body.error);return}var s=oe(oe(oe(oe([],X(Object.values(e.body.eventsWithInvalidFields)),!1),X(Object.values(e.body.eventsWithMissingFields)),!1),X(Object.values(e.body.eventsWithInvalidIdLengths)),!1),X(e.body.silencedEvents),!1).flat(),a=new Set(s),l=n.filter(function(f,g){if(a.has(g)){o.fulfillRequest([f],e.statusCode,e.body.error);return}return!0});l.length>0&&this.config.loggerProvider.warn(Ge(e)),this.addToQueue.apply(this,oe([],X(l),!1))},t.prototype.handlePayloadTooLargeResponse=function(e,n){if(n.length===1){this.fulfillRequest(n,e.statusCode,e.body.error);return}this.config.loggerProvider.warn(Ge(e)),this.config.flushQueueSize/=2,this.addToQueue.apply(this,oe([],X(n),!1))},t.prototype.handleRateLimitResponse=function(e,n){var o=this,s=Object.keys(e.body.exceededDailyQuotaUsers),a=Object.keys(e.body.exceededDailyQuotaDevices),l=e.body.throttledEvents,f=new Set(s),g=new Set(a),v=new Set(l),h=n.filter(function(m,E){if(m.event.user_id&&f.has(m.event.user_id)||m.event.device_id&&g.has(m.event.device_id)){o.fulfillRequest([m],e.statusCode,e.body.error);return}return v.has(E)&&(m.timeout=o.throttleTimeout),!0});h.length>0&&this.config.loggerProvider.warn(Ge(e)),this.addToQueue.apply(this,oe([],X(h),!1))},t.prototype.handleOtherResponse=function(e){var n=this;this.addToQueue.apply(this,oe([],X(e.map(function(o){return o.timeout=o.attempts*n.retryTimeout,o})),!1))},t.prototype.fulfillRequest=function(e,n,o){this.saveEvents(),e.forEach(function(s){return s.callback(Ne(s.event,n,o))})},t.prototype.saveEvents=function(){if(this.config.storageProvider){var e=Array.from(this.queue.map(function(n){return n.event}));this.config.storageProvider.set(this.storageKey,e)}},t}(),Zr=function(t){t===void 0&&(t=0);var e=new Error().stack||"";return e.split(`
`).slice(2+t).map(function(n){return n.trim()})},$=function(t){return function(){var e=T({},t.config),n=e.loggerProvider,o=e.logLevel;return{logger:n,logLevel:o}}},Jr=function(t,e){var n,o;e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");try{for(var s=Ue(e.split(".")),a=s.next();!a.done;a=s.next()){var l=a.value;if(l in t)t=t[l];else return}}catch(f){n={error:f}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}return t},j=function(t,e){return function(){var n,o,s={};try{for(var a=Ue(e),l=a.next();!l.done;l=a.next()){var f=l.value;s[f]=Jr(t,f)}}catch(g){n={error:g}}finally{try{l&&!l.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return s}},W=function(t,e,n,o,s){return s===void 0&&(s=null),function(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];var f=n(),g=f.logger,v=f.logLevel;if(v&&v<Z.Debug||!v||!g)return t.apply(s,a);var h={type:"invoke public method",name:e,args:a,stacktrace:Zr(1),time:{start:new Date().toISOString()},states:{}};o&&h.states&&(h.states.before=o());var m=t.apply(s,a);return m&&m.promise?m.promise.then(function(){o&&h.states&&(h.states.after=o()),h.time&&(h.time.end=new Date().toISOString()),g.debug(JSON.stringify(h,null,2))}):(o&&h.states&&(h.states.after=o()),h.time&&(h.time.end=new Date().toISOString()),g.debug(JSON.stringify(h,null,2))),m}},Xt=function(){function t(){this.memoryStorage=new Map}return t.prototype.isEnabled=function(){return I(this,void 0,void 0,function(){return _(this,function(e){return[2,!0]})})},t.prototype.get=function(e){return I(this,void 0,void 0,function(){return _(this,function(n){return[2,this.memoryStorage.get(e)]})})},t.prototype.getRaw=function(e){return I(this,void 0,void 0,function(){var n;return _(this,function(o){switch(o.label){case 0:return[4,this.get(e)];case 1:return n=o.sent(),[2,n?JSON.stringify(n):void 0]}})})},t.prototype.set=function(e,n){return I(this,void 0,void 0,function(){return _(this,function(o){return this.memoryStorage.set(e,n),[2]})})},t.prototype.remove=function(e){return I(this,void 0,void 0,function(){return _(this,function(n){return this.memoryStorage.delete(e),[2]})})},t.prototype.reset=function(){return I(this,void 0,void 0,function(){return _(this,function(e){return this.memoryStorage.clear(),[2]})})},t}(),yt=function(){function t(){}return t.prototype.send=function(e,n){return Promise.resolve(null)},t.prototype.buildResponse=function(e){var n,o,s,a,l,f,g,v,h,m,E,w,b,S,x,A,q,R,H,D,k,F;if(typeof e!="object")return null;var K=e.code||0,V=this.buildStatus(K);switch(V){case Q.Success:return{status:V,statusCode:K,body:{eventsIngested:(n=e.events_ingested)!==null&&n!==void 0?n:0,payloadSizeBytes:(o=e.payload_size_bytes)!==null&&o!==void 0?o:0,serverUploadTime:(s=e.server_upload_time)!==null&&s!==void 0?s:0}};case Q.Invalid:return{status:V,statusCode:K,body:{error:(a=e.error)!==null&&a!==void 0?a:"",missingField:(l=e.missing_field)!==null&&l!==void 0?l:"",eventsWithInvalidFields:(f=e.events_with_invalid_fields)!==null&&f!==void 0?f:{},eventsWithMissingFields:(g=e.events_with_missing_fields)!==null&&g!==void 0?g:{},eventsWithInvalidIdLengths:(v=e.events_with_invalid_id_lengths)!==null&&v!==void 0?v:{},epsThreshold:(h=e.eps_threshold)!==null&&h!==void 0?h:0,exceededDailyQuotaDevices:(m=e.exceeded_daily_quota_devices)!==null&&m!==void 0?m:{},silencedDevices:(E=e.silenced_devices)!==null&&E!==void 0?E:[],silencedEvents:(w=e.silenced_events)!==null&&w!==void 0?w:[],throttledDevices:(b=e.throttled_devices)!==null&&b!==void 0?b:{},throttledEvents:(S=e.throttled_events)!==null&&S!==void 0?S:[]}};case Q.PayloadTooLarge:return{status:V,statusCode:K,body:{error:(x=e.error)!==null&&x!==void 0?x:""}};case Q.RateLimit:return{status:V,statusCode:K,body:{error:(A=e.error)!==null&&A!==void 0?A:"",epsThreshold:(q=e.eps_threshold)!==null&&q!==void 0?q:0,throttledDevices:(R=e.throttled_devices)!==null&&R!==void 0?R:{},throttledUsers:(H=e.throttled_users)!==null&&H!==void 0?H:{},exceededDailyQuotaDevices:(D=e.exceeded_daily_quota_devices)!==null&&D!==void 0?D:{},exceededDailyQuotaUsers:(k=e.exceeded_daily_quota_users)!==null&&k!==void 0?k:{},throttledEvents:(F=e.throttled_events)!==null&&F!==void 0?F:[]}};case Q.Timeout:default:return{status:V,statusCode:K}}},t.prototype.buildStatus=function(e){return e>=200&&e<300?Q.Success:e===429?Q.RateLimit:e===413?Q.PayloadTooLarge:e===408?Q.Timeout:e>=400&&e<500?Q.Invalid:e>=500?Q.Failed:Q.Unknown},t}(),ye=function(){if(typeof globalThis<"u")return globalThis;if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof Me<"u")return Me},pt=function(){var t,e=ye();if(!(!((t=e==null?void 0:e.location)===null||t===void 0)&&t.search))return{};var n=e.location.search.substring(1).split("&").filter(Boolean),o=n.reduce(function(s,a){var l=a.split("=",2),f=bt(l[0]),g=bt(l[1]);return g&&(s[f]=g),s},{});return o},bt=function(t){t===void 0&&(t="");try{return decodeURIComponent(t)}catch{return""}},en="utm_campaign",tn="utm_content",rn="utm_id",nn="utm_medium",on="utm_source",un="utm_term",Tt="dclid",xt="fbclid",St="gbraid",Bt="gclid",At="ko_click_id",Ut="li_fat_id",Rt="msclkid",kt="rtd_cid",Pt="ttclid",Ft="twclid",Ct="wbraid",mt={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,referrer:void 0,referring_domain:void 0,dclid:void 0,gbraid:void 0,gclid:void 0,fbclid:void 0,ko_click_id:void 0,li_fat_id:void 0,msclkid:void 0,rtd_cid:void 0,ttclid:void 0,twclid:void 0,wbraid:void 0},Zt=function(){function t(){}return t.prototype.parse=function(){return I(this,void 0,void 0,function(){return _(this,function(e){return[2,T(T(T(T({},mt),this.getUtmParam()),this.getReferrer()),this.getClickIds())]})})},t.prototype.getUtmParam=function(){var e=pt(),n=e[en],o=e[tn],s=e[rn],a=e[nn],l=e[on],f=e[un];return{utm_campaign:n,utm_content:o,utm_id:s,utm_medium:a,utm_source:l,utm_term:f}},t.prototype.getReferrer=function(){var e,n,o={referrer:void 0,referring_domain:void 0};try{o.referrer=document.referrer||void 0,o.referring_domain=(n=(e=o.referrer)===null||e===void 0?void 0:e.split("/")[2])!==null&&n!==void 0?n:void 0}catch{}return o},t.prototype.getClickIds=function(){var e,n=pt();return e={},e[Tt]=n[Tt],e[xt]=n[xt],e[St]=n[St],e[Bt]=n[Bt],e[At]=n[At],e[Ut]=n[Ut],e[Rt]=n[Rt],e[kt]=n[kt],e[Pt]=n[Pt],e[Ft]=n[Ft],e[Ct]=n[Ct],e},t}(),Jt=function(t,e,n){return e===void 0&&(e=""),n===void 0&&(n=10),[Ze,e,t.substring(0,n)].filter(Boolean).join("_")},sn=function(t){return"".concat(Ze.toLowerCase(),"_").concat(t.substring(0,6))},vt=function(){function t(e){this.options=T({},e)}return t.prototype.isEnabled=function(){return I(this,void 0,void 0,function(){var e,n,o;return _(this,function(s){switch(s.label){case 0:if(!ye())return[2,!1];t.testValue=String(Date.now()),e=new t(this.options),n="AMP_TEST",s.label=1;case 1:return s.trys.push([1,4,5,7]),[4,e.set(n,t.testValue)];case 2:return s.sent(),[4,e.get(n)];case 3:return o=s.sent(),[2,o===t.testValue];case 4:return s.sent(),[2,!1];case 5:return[4,e.remove(n)];case 6:return s.sent(),[7];case 7:return[2]}})})},t.prototype.get=function(e){return I(this,void 0,void 0,function(){var n;return _(this,function(o){switch(o.label){case 0:return[4,this.getRaw(e)];case 1:if(n=o.sent(),!n)return[2,void 0];try{try{n=decodeURIComponent(atob(n))}catch{}return[2,JSON.parse(n)]}catch{return[2,void 0]}return[2]}})})},t.prototype.getRaw=function(e){var n,o;return I(this,void 0,void 0,function(){var s,a,l;return _(this,function(f){return s=ye(),a=(o=(n=s==null?void 0:s.document)===null||n===void 0?void 0:n.cookie.split("; "))!==null&&o!==void 0?o:[],l=a.find(function(g){return g.indexOf(e+"=")===0}),l?[2,l.substring(e.length+1)]:[2,void 0]})})},t.prototype.set=function(e,n){var o;return I(this,void 0,void 0,function(){var s,a,l,f,g,v;return _(this,function(h){try{s=(o=this.options.expirationDays)!==null&&o!==void 0?o:0,a=n!==null?s:-1,l=void 0,a&&(f=new Date,f.setTime(f.getTime()+a*24*60*60*1e3),l=f),g="".concat(e,"=").concat(btoa(encodeURIComponent(JSON.stringify(n)))),l&&(g+="; expires=".concat(l.toUTCString())),g+="; path=/",this.options.domain&&(g+="; domain=".concat(this.options.domain)),this.options.secure&&(g+="; Secure"),this.options.sameSite&&(g+="; SameSite=".concat(this.options.sameSite)),v=ye(),v&&(v.document.cookie=g)}catch{}return[2]})})},t.prototype.remove=function(e){return I(this,void 0,void 0,function(){return _(this,function(n){switch(n.label){case 0:return[4,this.set(e,null)];case 1:return n.sent(),[2]}})})},t.prototype.reset=function(){return I(this,void 0,void 0,function(){return _(this,function(e){return[2]})})},t}(),an=function(t){we(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.send=function(n,o){return I(this,void 0,void 0,function(){var s,a,l;return _(this,function(f){switch(f.label){case 0:if(typeof fetch>"u")throw new Error("FetchTransport is not supported");return s={headers:{"Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify(o),method:"POST"},[4,fetch(n,s)];case 1:return a=f.sent(),[4,a.json()];case 2:return l=f.sent(),[2,this.buildResponse(l)]}})})},e}(yt),cn=function(){function t(){}return t.prototype.getApplicationContext=function(){return{versionName:this.versionName,language:fn(),platform:"Web",os:void 0,deviceModel:void 0}},t}(),fn=function(){return typeof navigator<"u"&&(navigator.languages&&navigator.languages[0]||navigator.language)||""},ln=function(){function t(){this.queue=[]}return t.prototype.logEvent=function(e){this.receiver?this.receiver(e):this.queue.length<512&&this.queue.push(e)},t.prototype.setEventReceiver=function(e){this.receiver=e,this.queue.length>0&&(this.queue.forEach(function(n){e(n)}),this.queue=[])},t}(),ge=function(){return ge=Object.assign||function(e){for(var n,o=1,s=arguments.length;o<s;o++){n=arguments[o];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ge.apply(this,arguments)},Ye=function(t,e){var n=["string","number","boolean","undefined"],o=typeof t,s=typeof e;if(o!==s)return!1;for(var a=0,l=n;a<l.length;a++){var f=l[a];if(f===o)return t===e}if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;var g=Array.isArray(t),v=Array.isArray(e);if(g!==v)return!1;if(g&&v){for(var h=0;h<t.length;h++)if(!Ye(t[h],e[h]))return!1}else{var m=Object.keys(t).sort(),E=Object.keys(e).sort();if(!Ye(m,E))return!1;var w=!0;return Object.keys(t).forEach(function(b){Ye(t[b],e[b])||(w=!1)}),w}return!0},dn="$set",hn="$unset",pn="$clearAll";Object.entries||(Object.entries=function(t){for(var e=Object.keys(t),n=e.length,o=new Array(n);n--;)o[n]=[e[n],t[e[n]]];return o});var vn=function(){function t(){this.identity={userProperties:{}},this.listeners=new Set}return t.prototype.editIdentity=function(){var e=this,n=ge({},this.identity.userProperties),o=ge(ge({},this.identity),{userProperties:n});return{setUserId:function(s){return o.userId=s,this},setDeviceId:function(s){return o.deviceId=s,this},setUserProperties:function(s){return o.userProperties=s,this},updateUserProperties:function(s){for(var a=o.userProperties||{},l=0,f=Object.entries(s);l<f.length;l++){var g=f[l],v=g[0],h=g[1];switch(v){case dn:for(var m=0,E=Object.entries(h);m<E.length;m++){var w=E[m],b=w[0],S=w[1];a[b]=S}break;case hn:for(var x=0,A=Object.keys(h);x<A.length;x++){var b=A[x];delete a[b]}break;case pn:a={};break}}return o.userProperties=a,this},commit:function(){return e.setIdentity(o),this}}},t.prototype.getIdentity=function(){return ge({},this.identity)},t.prototype.setIdentity=function(e){var n=ge({},this.identity);this.identity=ge({},e),Ye(n,this.identity)||this.listeners.forEach(function(o){o(e)})},t.prototype.addIdentityListener=function(e){this.listeners.add(e)},t.prototype.removeIdentityListener=function(e){this.listeners.delete(e)},t}(),Oe=typeof globalThis<"u"?globalThis:typeof Me<"u"?Me:self,gn=function(){function t(){this.identityStore=new vn,this.eventBridge=new ln,this.applicationContextProvider=new cn}return t.getInstance=function(e){return Oe.analyticsConnectorInstances||(Oe.analyticsConnectorInstances={}),Oe.analyticsConnectorInstances[e]||(Oe.analyticsConnectorInstances[e]=new t),Oe.analyticsConnectorInstances[e]},t}(),qe=function(t){return t===void 0&&(t="$default_instance"),gn.getInstance(t)},yn=function(t,e){qe(e).identityStore.editIdentity().setUserId(t).commit()},mn=function(t,e){qe(e).identityStore.editIdentity().setDeviceId(t).commit()},En=function(){function t(){this.name="identity",this.type="before",this.identityStore=qe().identityStore}return t.prototype.execute=function(e){return I(this,void 0,void 0,function(){var n;return _(this,function(o){return n=e.user_properties,n&&this.identityStore.editIdentity().updateUserProperties(n).commit(),[2,e]})})},t.prototype.setup=function(e){return I(this,void 0,void 0,function(){return _(this,function(n){return e.instanceName&&(this.identityStore=qe(e.instanceName).identityStore),[2]})})},t}(),wn=function(){var t,e,n,o;if(typeof navigator>"u")return"";var s=navigator.userLanguage;return(o=(n=(e=(t=navigator.languages)===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:navigator.language)!==null&&n!==void 0?n:s)!==null&&o!==void 0?o:""},$e=function(t,e){return typeof t=="boolean"?t:(t==null?void 0:t[e])!==!1},er=function(t){return $e(t,"attribution")},tr=function(t){return $e(t,"fileDownloads")},rr=function(t){return $e(t,"formInteractions")},nr=function(t){return $e(t,"pageViews")},ir=function(t){return $e(t,"sessions")},In=function(t){var e=function(){return!1},n=void 0,o,s=nr(t.defaultTracking);return s&&(e=void 0,o=void 0,t.defaultTracking&&typeof t.defaultTracking=="object"&&t.defaultTracking.pageViews&&typeof t.defaultTracking.pageViews=="object"&&("trackOn"in t.defaultTracking.pageViews&&(e=t.defaultTracking.pageViews.trackOn),"trackHistoryChanges"in t.defaultTracking.pageViews&&(n=t.defaultTracking.pageViews.trackHistoryChanges),"eventType"in t.defaultTracking.pageViews&&t.defaultTracking.pageViews.eventType&&(o=t.defaultTracking.pageViews.eventType))),{trackOn:e,trackHistoryChanges:n,eventType:o}},_n=function(t){return er(t.defaultTracking)&&t.defaultTracking&&typeof t.defaultTracking=="object"&&t.defaultTracking.attribution&&typeof t.defaultTracking.attribution=="object"?T({},t.defaultTracking.attribution):{}},nt=function(t,e){for(var n=0;n<e.length;n++){var o=e[n],s=o.name,a=o.args,l=o.resolve,f=t&&t[s];if(typeof f=="function"){var g=f.apply(t,a);typeof l=="function"&&l(g==null?void 0:g.promise)}}return t},it=function(t){var e=t;return e&&e._q!==void 0},bn="2.1.3",Tn="Web",xn="$remote",Sn=function(){function t(){this.name="@amplitude/plugin-context-browser",this.type="before",this.library="amplitude-ts/".concat(bn),typeof navigator<"u"&&(this.userAgent=navigator.userAgent)}return t.prototype.setup=function(e){return this.config=e,Promise.resolve(void 0)},t.prototype.execute=function(e){var n,o;return I(this,void 0,void 0,function(){var s,a,l,f;return _(this,function(g){return s=new Date().getTime(),a=(n=this.config.lastEventId)!==null&&n!==void 0?n:-1,l=(o=e.event_id)!==null&&o!==void 0?o:a+1,this.config.lastEventId=l,e.time||(this.config.lastEventTime=s),f=T(T(T(T(T(T(T(T({user_id:this.config.userId,device_id:this.config.deviceId,session_id:this.config.sessionId,time:s},this.config.appVersion&&{app_version:this.config.appVersion}),this.config.trackingOptions.platform&&{platform:Tn}),this.config.trackingOptions.language&&{language:wn()}),this.config.trackingOptions.ipAddress&&{ip:xn}),{insert_id:Ve(),partner_id:this.config.partnerId,plan:this.config.plan}),this.config.ingestionMetadata&&{ingestion_metadata:{source_name:this.config.ingestionMetadata.sourceName,source_version:this.config.ingestionMetadata.sourceVersion}}),e),{event_id:l,library:this.library,user_agent:this.userAgent}),[2,f]})})},t}(),or=function(){function t(e){this.storage=e}return t.prototype.isEnabled=function(){return I(this,void 0,void 0,function(){var e,n,o,s;return _(this,function(a){switch(a.label){case 0:if(!this.storage)return[2,!1];e=String(Date.now()),n=new t(this.storage),o="AMP_TEST",a.label=1;case 1:return a.trys.push([1,4,5,7]),[4,n.set(o,e)];case 2:return a.sent(),[4,n.get(o)];case 3:return s=a.sent(),[2,s===e];case 4:return a.sent(),[2,!1];case 5:return[4,n.remove(o)];case 6:return a.sent(),[7];case 7:return[2]}})})},t.prototype.get=function(e){return I(this,void 0,void 0,function(){var n;return _(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.getRaw(e)];case 1:return n=o.sent(),n?[2,JSON.parse(n)]:[2,void 0];case 2:return o.sent(),console.error("[Amplitude] Error: Could not get value from storage"),[2,void 0];case 3:return[2]}})})},t.prototype.getRaw=function(e){var n;return I(this,void 0,void 0,function(){return _(this,function(o){return[2,((n=this.storage)===null||n===void 0?void 0:n.getItem(e))||void 0]})})},t.prototype.set=function(e,n){var o;return I(this,void 0,void 0,function(){return _(this,function(s){try{(o=this.storage)===null||o===void 0||o.setItem(e,JSON.stringify(n))}catch{}return[2]})})},t.prototype.remove=function(e){var n;return I(this,void 0,void 0,function(){return _(this,function(o){try{(n=this.storage)===null||n===void 0||n.removeItem(e)}catch{}return[2]})})},t.prototype.reset=function(){var e;return I(this,void 0,void 0,function(){return _(this,function(n){try{(e=this.storage)===null||e===void 0||e.clear()}catch{}return[2]})})},t}(),ur=function(t){we(e,t);function e(){var n;return t.call(this,(n=ye())===null||n===void 0?void 0:n.localStorage)||this}return e}(or),Bn=function(t){we(e,t);function e(){var n;return t.call(this,(n=ye())===null||n===void 0?void 0:n.sessionStorage)||this}return e}(or),An=function(t){we(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.state={done:4},n}return e.prototype.send=function(n,o){return I(this,void 0,void 0,function(){var s=this;return _(this,function(a){return[2,new Promise(function(l,f){typeof XMLHttpRequest>"u"&&f(new Error("XHRTransport is not supported."));var g=new XMLHttpRequest;g.open("POST",n,!0),g.onreadystatechange=function(){if(g.readyState===s.state.done)try{var v=g.responseText,h=JSON.parse(v),m=s.buildResponse(h);l(m)}catch(E){f(E)}},g.setRequestHeader("Content-Type","application/json"),g.setRequestHeader("Accept","*/*"),g.send(JSON.stringify(o))})]})})},e}(yt),Un=function(t){we(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.send=function(n,o){return I(this,void 0,void 0,function(){var s=this;return _(this,function(a){return[2,new Promise(function(l,f){var g=ye();if(!(g!=null&&g.navigator.sendBeacon))throw new Error("SendBeaconTransport is not supported");try{var v=JSON.stringify(o),h=g.navigator.sendBeacon(n,JSON.stringify(o));return l(h?s.buildResponse({code:200,events_ingested:o.events.length,payload_size_bytes:v.length,server_upload_time:Date.now()}):s.buildResponse({code:500}))}catch(m){f(m)}})]})})},e}(yt),Rn=function(t,e,n){return n===void 0&&(n=!0),I(void 0,void 0,void 0,function(){var o,s,a,l,f,g,v,h,m;return _(this,function(E){switch(E.label){case 0:return o=sn(t),[4,e.getRaw(o)];case 1:return s=E.sent(),s?n?[4,e.remove(o)]:[3,3]:[2,{optOut:!1}];case 2:E.sent(),E.label=3;case 3:return a=X(s.split("."),6),l=a[0],f=a[1],g=a[2],v=a[3],h=a[4],m=a[5],[2,{deviceId:l,userId:kn(f),sessionId:ot(v),lastEventId:ot(m),lastEventTime:ot(h),optOut:!!g}]}})})},ot=function(t){var e=parseInt(t,32);if(!isNaN(e))return e},kn=function(t){if(!(!atob||!escape||!t))try{return decodeURIComponent(escape(atob(t)))}catch{return}},te="[Amplitude]",Dt="".concat(te," Form Started"),Pn="".concat(te," Form Submitted"),Fn="".concat(te," File Downloaded"),Lt="session_start",Ot="session_end",Cn="".concat(te," File Extension"),Dn="".concat(te," File Name"),Ln="".concat(te," Link ID"),On="".concat(te," Link Text"),Nn="".concat(te," Link URL"),ut="".concat(te," Form ID"),st="".concat(te," Form Name"),at="".concat(te," Form Destination"),He="cookie",Mn="US",qn=function(t){we(e,t);function e(n,o,s,a,l,f,g,v,h,m,E,w,b,S,x,A,q,R,H,D,k,F,K,V,re,ce,ne,fe,pe){s===void 0&&(s=new Xt),a===void 0&&(a={domain:"",expiration:365,sameSite:"Lax",secure:!1,upgrade:!0}),l===void 0&&(l=!0),g===void 0&&(g=1e3),v===void 0&&(v=5),h===void 0&&(h=30),m===void 0&&(m=He),x===void 0&&(x=new zt),A===void 0&&(A=Z.Warn),R===void 0&&(R=!1),k===void 0&&(k=""),F===void 0&&(F=Mn),V===void 0&&(V=30*60*1e3),re===void 0&&(re=new ur),ce===void 0&&(ce={ipAddress:!0,language:!0,platform:!0}),ne===void 0&&(ne="fetch"),fe===void 0&&(fe=!1);var B=t.call(this,{apiKey:n,storageProvider:re,transportProvider:sr(ne)})||this;return B.apiKey=n,B.appVersion=o,B.cookieOptions=a,B.defaultTracking=l,B.flushIntervalMillis=g,B.flushMaxRetries=v,B.flushQueueSize=h,B.identityStorage=m,B.ingestionMetadata=E,B.instanceName=w,B.loggerProvider=x,B.logLevel=A,B.minIdLength=q,B.partnerId=H,B.plan=D,B.serverUrl=k,B.serverZone=F,B.sessionTimeout=V,B.storageProvider=re,B.trackingOptions=ce,B.transport=ne,B.useBatch=fe,B._optOut=!1,B._cookieStorage=s,B.deviceId=f,B.lastEventId=b,B.lastEventTime=S,B.optOut=R,B.sessionId=K,B.userId=pe,B.loggerProvider.enable(B.logLevel),B}return Object.defineProperty(e.prototype,"cookieStorage",{get:function(){return this._cookieStorage},set:function(n){this._cookieStorage!==n&&(this._cookieStorage=n,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceId",{get:function(){return this._deviceId},set:function(n){this._deviceId!==n&&(this._deviceId=n,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userId",{get:function(){return this._userId},set:function(n){this._userId!==n&&(this._userId=n,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this._sessionId},set:function(n){this._sessionId!==n&&(this._sessionId=n,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"optOut",{get:function(){return this._optOut},set:function(n){this._optOut!==n&&(this._optOut=n,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastEventTime",{get:function(){return this._lastEventTime},set:function(n){this._lastEventTime!==n&&(this._lastEventTime=n,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastEventId",{get:function(){return this._lastEventId},set:function(n){this._lastEventId!==n&&(this._lastEventId=n,this.updateStorage())},enumerable:!1,configurable:!0}),e.prototype.updateStorage=function(){var n={deviceId:this._deviceId,userId:this._userId,sessionId:this._sessionId,optOut:this._optOut,lastEventTime:this._lastEventTime,lastEventId:this._lastEventId};this.cookieStorage.set(Jt(this.apiKey),n)},e}(Yr),Vn=function(t,e,n){return e===void 0&&(e={}),I(void 0,void 0,void 0,function(){var o,s,a,l,f,g,v,h,m,E,w,b,S,x,A,q,R,H,D,k,F,K,V,re,ce,ne,fe,pe,B,ke,Pe,Fe,Ce,De,L,Y,Ie,_e,be,Te;return _(this,function(le){switch(le.label){case 0:return o=e.identityStorage||He,a=[T({},e.cookieOptions)],R={},o===He?[3,1]:(l="",[3,5]);case 1:return(D=(H=e.cookieOptions)===null||H===void 0?void 0:H.domain)!==null&&D!==void 0?(f=D,[3,4]):[3,2];case 2:return[4,jn()];case 3:f=le.sent(),le.label=4;case 4:l=f,le.label=5;case 5:return s=T.apply(void 0,a.concat([(R.domain=l,R.expiration=365,R.sameSite="Lax",R.secure=!1,R.upgrade=!0,R)])),g=$n(e.identityStorage,s),[4,Rn(t,g,(F=(k=e.cookieOptions)===null||k===void 0?void 0:k.upgrade)!==null&&F!==void 0?F:!0)];case 6:return v=le.sent(),[4,g.get(Jt(t))];case 7:return h=le.sent(),m=pt(),E=(ce=(re=(V=(K=e.deviceId)!==null&&K!==void 0?K:m.deviceId)!==null&&V!==void 0?V:h==null?void 0:h.deviceId)!==null&&re!==void 0?re:v.deviceId)!==null&&ce!==void 0?ce:Ve(),w=(ne=h==null?void 0:h.lastEventId)!==null&&ne!==void 0?ne:v.lastEventId,b=(fe=h==null?void 0:h.lastEventTime)!==null&&fe!==void 0?fe:v.lastEventTime,S=(B=(pe=e.optOut)!==null&&pe!==void 0?pe:h==null?void 0:h.optOut)!==null&&B!==void 0?B:v.optOut,x=(ke=h==null?void 0:h.sessionId)!==null&&ke!==void 0?ke:v.sessionId,A=(Fe=(Pe=e.userId)!==null&&Pe!==void 0?Pe:h==null?void 0:h.userId)!==null&&Fe!==void 0?Fe:v.userId,n.previousSessionDeviceId=(Ce=h==null?void 0:h.deviceId)!==null&&Ce!==void 0?Ce:v.deviceId,n.previousSessionUserId=(De=h==null?void 0:h.userId)!==null&&De!==void 0?De:v.userId,q={ipAddress:(Y=(L=e.trackingOptions)===null||L===void 0?void 0:L.ipAddress)!==null&&Y!==void 0?Y:!0,language:(_e=(Ie=e.trackingOptions)===null||Ie===void 0?void 0:Ie.language)!==null&&_e!==void 0?_e:!0,platform:(Te=(be=e.trackingOptions)===null||be===void 0?void 0:be.platform)!==null&&Te!==void 0?Te:!0},[2,new qn(t,e.appVersion,g,s,e.defaultTracking,E,e.flushIntervalMillis,e.flushMaxRetries,e.flushQueueSize,o,e.ingestionMetadata,e.instanceName,w,b,e.loggerProvider,e.logLevel,e.minIdLength,S,e.partnerId,e.plan,e.serverUrl,e.serverZone,x,e.sessionTimeout,e.storageProvider,q,e.transport,e.useBatch,A)]}})})},$n=function(t,e){switch(t===void 0&&(t=He),e===void 0&&(e={}),t){case"localStorage":return new ur;case"sessionStorage":return new Bn;case"none":return new Xt;case"cookie":default:return new vt(T(T({},e),{expirationDays:e.expiration}))}},sr=function(t){return t==="xhr"?new An:t==="beacon"?new Un:new an},jn=function(t){return I(void 0,void 0,void 0,function(){var e,n,o,s,a,a,l,f,g,v;return _(this,function(h){switch(h.label){case 0:return[4,new vt().isEnabled()];case 1:if(!h.sent()||!t&&typeof location>"u")return[2,""];for(e=t??location.hostname,n=e.split("."),o=[],s="AMP_TLDTEST",a=n.length-2;a>=0;--a)o.push(n.slice(a).join("."));a=0,h.label=2;case 2:return a<o.length?(l=o[a],f={domain:"."+l},g=new vt(f),[4,g.set(s,1)]):[3,7];case 3:return h.sent(),[4,g.get(s)];case 4:return v=h.sent(),v?[4,g.remove(s)]:[3,6];case 5:return h.sent(),[2,"."+l];case 6:return a++,[3,2];case 7:return[2,""]}})})},Wn=function(t,e,n){return e===void 0&&(e=""),n===void 0&&(n=10),[Ze,e,t.substring(0,n)].filter(Boolean).join("_")},Nt=function(t){var e=t.split(".");return e.length<=2?t:e.slice(e.length-2,e.length).join(".")},Gn=function(t,e,n){t.referrer;var o=t.referring_domain,s=dt(t,["referrer","referring_domain"]),a=e||{};a.referrer;var l=a.referring_domain,f=dt(a,["referrer","referring_domain"]);if(Kn(n.excludeReferrers,t.referring_domain))return!1;var g=JSON.stringify(s)!==JSON.stringify(f),v=Nt(o||"")!==Nt(l||"");return!e||g||v},Kn=function(t,e){return t===void 0&&(t=[]),e===void 0&&(e=""),t.some(function(n){return n instanceof RegExp?n.test(e):n===e})},Qn=function(t,e){var n=T(T({},mt),t),o=Object.entries(n).reduce(function(s,a){var l,f=X(a,2),g=f[0],v=f[1];return s.setOnce("initial_".concat(g),(l=v??e.initialEmptyValue)!==null&&l!==void 0?l:"EMPTY"),v?s.set(g,v):s.unset(g)},new ze);return Yt(o)},Yn=function(t){var e=t;return e?(e.startsWith(".")&&(e=e.substring(1)),[new RegExp("".concat(e.replace(".","\\."),"$"))]):[]},zn=function(t){var e=this;t===void 0&&(t={});var n={name:"@amplitude/plugin-web-attribution-browser",type:"before",setup:function(o,s){var a;return I(this,void 0,void 0,function(){var l,f,g,v,h,m,E;return _(this,function(w){switch(w.label){case 0:return l=T({initialEmptyValue:"EMPTY",resetSessionOnNewCampaign:!1,excludeReferrers:Yn((a=o.cookieOptions)===null||a===void 0?void 0:a.domain)},t),o.loggerProvider.log("Installing @amplitude/plugin-web-attribution-browser."),f=o.cookieStorage,g=Wn(o.apiKey,"MKTG"),[4,Promise.all([new Zt().parse(),f.get(g)])];case 1:return v=X.apply(void 0,[w.sent(),2]),h=v[0],m=v[1],Gn(h,m,l)&&(l.resetSessionOnNewCampaign&&(s.setSessionId(Date.now()),o.loggerProvider.log("Created a new session for new campaign.")),o.loggerProvider.log("Tracking attribution."),E=Qn(h,l),s.track(E),f.set(g,h)),[2]}})})},execute:function(o){return I(e,void 0,void 0,function(){return _(this,function(s){return[2,o]})})}};return n},Hn=function(t){var e={};for(var n in t){var o=t[n];o&&(e[n]=o)}return e},Xn=function(t){t===void 0&&(t={});var e,n=ye(),o=void 0,s,a=function(){return I(void 0,void 0,void 0,function(){var m,E,w;return _(this,function(b){switch(b.label){case 0:return E={event_type:(w=t.eventType)!==null&&w!==void 0?w:"[Amplitude] Page Viewed"},m=[{}],[4,Zn()];case 1:return[2,(E.event_properties=T.apply(void 0,[T.apply(void 0,m.concat([b.sent()])),{"[Amplitude] Page Domain":typeof location<"u"&&location.hostname||"","[Amplitude] Page Location":typeof location<"u"&&location.href||"","[Amplitude] Page Path":typeof location<"u"&&location.pathname||"","[Amplitude] Page Title":typeof document<"u"&&document.title||"","[Amplitude] Page URL":typeof location<"u"&&location.href.split("?")[0]||""}]),E)]}})})},l=function(){return typeof t.trackOn>"u"||typeof t.trackOn=="function"&&t.trackOn()},f=typeof location<"u"?location.href:null,g=function(){return I(void 0,void 0,void 0,function(){var m,E,w,b;return _(this,function(S){switch(S.label){case 0:return m=location.href,E=ei(t.trackHistoryChanges,m,f||"")&&l(),f=m,E?(o==null||o.log("Tracking page view event"),e!=null?[3,1]:[3,3]):[3,4];case 1:return b=(w=e).track,[4,a()];case 2:b.apply(w,[S.sent()]),S.label=3;case 3:S.label=4;case 4:return[2]}})})},v=function(){g()},h={name:"@amplitude/plugin-page-view-tracking-browser",type:"enrichment",setup:function(m,E){return I(void 0,void 0,void 0,function(){var w,b;return _(this,function(S){switch(S.label){case 0:return e=E,o=m.loggerProvider,o.log("Installing @amplitude/plugin-page-view-tracking-browser"),n&&(n.addEventListener("popstate",v),s=n.history.pushState,n.history.pushState=new Proxy(n.history.pushState,{apply:function(x,A,q){var R=X(q,3),H=R[0],D=R[1],k=R[2];x.apply(A,[H,D,k]),g()}})),l()?(o.log("Tracking page view event"),b=(w=e).track,[4,a()]):[3,2];case 1:b.apply(w,[S.sent()]),S.label=2;case 2:return[2]}})})},execute:function(m){return I(void 0,void 0,void 0,function(){var E;return _(this,function(w){switch(w.label){case 0:return t.trackOn==="attribution"&&Jn(m)?(o==null||o.log("Enriching campaign event to page view event with campaign parameters"),[4,a()]):[3,2];case 1:E=w.sent(),m.event_type=E.event_type,m.event_properties=T(T({},m.event_properties),E.event_properties),w.label=2;case 2:return[2,m]}})})},teardown:function(){return I(void 0,void 0,void 0,function(){return _(this,function(m){return n&&(n.removeEventListener("popstate",v),s&&(n.history.pushState=s)),[2]})})}};return h},Zn=function(){return I(void 0,void 0,void 0,function(){var t;return _(this,function(e){switch(e.label){case 0:return t=Hn,[4,new Zt().parse()];case 1:return[2,t.apply(void 0,[e.sent()])]}})})},Jn=function(t){if(t.event_type==="$identify"&&t.user_properties){var e=t.user_properties,n=e[z.SET]||{},o=e[z.UNSET]||{},s=oe(oe([],X(Object.keys(n)),!1),X(Object.keys(o)),!1);return Object.keys(mt).every(function(a){return s.includes(a)})}return!1},ei=function(t,e,n){switch(t){case"pathOnly":return e.split("?")[0]!==n.split("?")[0];default:return e!==n}},ti=function(){var t,e=[],n=function(v,h,m){v.addEventListener(h,m),e.push({element:v,type:h,handler:m})},o=function(){e.forEach(function(v){var h=v.element,m=v.type,E=v.handler;h==null||h.removeEventListener(m,E)}),e=[]},s="@amplitude/plugin-form-interaction-tracking-browser",a="enrichment",l=function(v,h){return I(void 0,void 0,void 0,function(){var m,E;return _(this,function(w){return h?typeof document>"u"?[2]:(m=function(b){var S=!1;n(b,"change",function(){var x;S||h.track(Dt,(x={},x[ut]=b.id,x[st]=b.name,x[at]=b.action,x)),S=!0}),n(b,"submit",function(){var x,A;S||h.track(Dt,(x={},x[ut]=b.id,x[st]=b.name,x[at]=b.action,x)),h.track(Pn,(A={},A[ut]=b.id,A[st]=b.name,A[at]=b.action,A)),S=!1})},E=Array.from(document.getElementsByTagName("form")),E.forEach(m),typeof MutationObserver<"u"&&(t=new MutationObserver(function(b){b.forEach(function(S){S.addedNodes.forEach(function(x){x.nodeName==="FORM"&&m(x),"querySelectorAll"in x&&typeof x.querySelectorAll=="function"&&Array.from(x.querySelectorAll("form")).map(m)})})}),t.observe(document.body,{subtree:!0,childList:!0})),[2]):(v.loggerProvider.warn("Form interaction tracking requires a later version of @amplitude/analytics-browser. Form interaction events are not tracked."),[2])})})},f=function(v){return I(void 0,void 0,void 0,function(){return _(this,function(h){return[2,v]})})},g=function(){return I(void 0,void 0,void 0,function(){return _(this,function(v){return t==null||t.disconnect(),o(),[2]})})};return{name:s,type:a,setup:l,execute:f,teardown:g}},ri=function(){var t,e=[],n=function(v,h,m){v.addEventListener(h,m),e.push({element:v,type:h,handler:m})},o=function(){e.forEach(function(v){var h=v.element,m=v.type,E=v.handler;h==null||h.removeEventListener(m,E)}),e=[]},s="@amplitude/plugin-file-download-tracking-browser",a="enrichment",l=function(v,h){return I(void 0,void 0,void 0,function(){var m,E,w;return _(this,function(b){return h?typeof document>"u"?[2]:(m=function(S){var x;try{x=new URL(S.href,window.location.href)}catch{return}var A=E.exec(x.href),q=A==null?void 0:A[1];q&&n(S,"click",function(){var R;q&&h.track(Fn,(R={},R[Cn]=q,R[Dn]=x.pathname,R[Ln]=S.id,R[On]=S.text,R[Nn]=S.href,R))})},E=/\.(pdf|xlsx?|docx?|txt|rtf|csv|exe|key|pp(s|t|tx)|7z|pkg|rar|gz|zip|avi|mov|mp4|mpe?g|wmv|midi?|mp3|wav|wma)$/,w=Array.from(document.getElementsByTagName("a")),w.forEach(m),typeof MutationObserver<"u"&&(t=new MutationObserver(function(S){S.forEach(function(x){x.addedNodes.forEach(function(A){A.nodeName==="A"&&m(A),"querySelectorAll"in A&&typeof A.querySelectorAll=="function"&&Array.from(A.querySelectorAll("a")).map(m)})})}),t.observe(document.body,{subtree:!0,childList:!0})),[2]):(v.loggerProvider.warn("File download tracking requires a later version of @amplitude/analytics-browser. File download events are not tracked."),[2])})})},f=function(v){return I(void 0,void 0,void 0,function(){return _(this,function(h){return[2,v]})})},g=function(){return I(void 0,void 0,void 0,function(){return _(this,function(v){return t==null||t.disconnect(),o(),[2]})})};return{name:s,type:a,setup:l,execute:f,teardown:g}},Mt=!1,ni=function(t){if(!Mt){var e=[nr(t.defaultTracking)?"Page Views":"",ir(t.defaultTracking)?"Sessions":"",tr(t.defaultTracking)?"File Downloads":"",rr(t.defaultTracking)?"Form Interactions":""].filter(Boolean),n=e.join(", ");if(e.length){var o="Your Amplitude instance is configured to track ".concat(n,". Visit https://www.docs.developers.amplitude.com/data/sdks/browser-2/#tracking-default-events for more details.");t.loggerProvider.log(o),t.logLevel<Z.Verbose&&console.log(o)}Mt=!0}},ii=function(t){we(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.init=function(n,o,s){n===void 0&&(n="");var a,l;return arguments.length>2?(a=o,l=s):typeof o=="string"?(a=o,l=void 0):(a=o==null?void 0:o.userId,l=o),ee(this._init(T(T({},l),{userId:a,apiKey:n})))},e.prototype._init=function(n){var o,s;return I(this,void 0,void 0,function(){var a,l,f,g,v=this;return _(this,function(h){switch(h.label){case 0:return this.initializing?[2]:(this.initializing=!0,[4,Vn(n.apiKey,n,this)]);case 1:return a=h.sent(),[4,t.prototype._init.call(this,a)];case 2:return h.sent(),this.setSessionId((s=(o=n.sessionId)!==null&&o!==void 0?o:this.config.sessionId)!==null&&s!==void 0?s:Date.now()),l=qe(n.instanceName),l.identityStore.setIdentity({userId:this.config.userId,deviceId:this.config.deviceId}),[4,this.add(new Xr).promise];case 3:return h.sent(),[4,this.add(new Sn).promise];case 4:return h.sent(),[4,this.add(new En).promise];case 5:return h.sent(),ni(this.config),tr(this.config.defaultTracking)?[4,this.add(ri()).promise]:[3,7];case 6:h.sent(),h.label=7;case 7:return rr(this.config.defaultTracking)?[4,this.add(ti()).promise]:[3,9];case 8:h.sent(),h.label=9;case 9:return er(this.config.defaultTracking)?(f=_n(this.config),g=zn(f),[4,this.add(g).promise]):[3,11];case 10:h.sent(),h.label=11;case 11:return[4,this.add(Xn(In(this.config))).promise];case 12:return h.sent(),this.initializing=!1,[4,this.runQueuedFunctions("dispatchQ")];case 13:return h.sent(),l.eventBridge.setEventReceiver(function(m){v.track(m.eventType,m.eventProperties)}),[2]}})})},e.prototype.getUserId=function(){var n;return(n=this.config)===null||n===void 0?void 0:n.userId},e.prototype.setUserId=function(n){if(!this.config){this.q.push(this.setUserId.bind(this,n));return}(n!==this.config.userId||n===void 0)&&(this.config.userId=n,yn(n,this.config.instanceName))},e.prototype.getDeviceId=function(){var n;return(n=this.config)===null||n===void 0?void 0:n.deviceId},e.prototype.setDeviceId=function(n){if(!this.config){this.q.push(this.setDeviceId.bind(this,n));return}this.config.deviceId=n,mn(n,this.config.instanceName)},e.prototype.reset=function(){this.setDeviceId(Ve()),this.setUserId(void 0)},e.prototype.getSessionId=function(){var n;return(n=this.config)===null||n===void 0?void 0:n.sessionId},e.prototype.setSessionId=function(n){var o;if(!this.config){this.q.push(this.setSessionId.bind(this,n));return}if(n!==this.config.sessionId){var s=this.getSessionId(),a=this.config.lastEventTime,l=(o=this.config.lastEventId)!==null&&o!==void 0?o:-1;this.config.sessionId=n,this.config.lastEventTime=void 0,ir(this.config.defaultTracking)&&(s&&a&&this.track(Ot,void 0,{device_id:this.previousSessionDeviceId,event_id:++l,session_id:s,time:a+1,user_id:this.previousSessionUserId}),this.config.lastEventTime=this.config.sessionId,this.track(Lt,void 0,{event_id:++l,session_id:this.config.sessionId,time:this.config.lastEventTime})),this.previousSessionDeviceId=this.config.deviceId,this.previousSessionUserId=this.config.userId}},e.prototype.extendSession=function(){if(!this.config){this.q.push(this.extendSession.bind(this));return}this.config.lastEventTime=Date.now()},e.prototype.setTransport=function(n){if(!this.config){this.q.push(this.setTransport.bind(this,n));return}this.config.transportProvider=sr(n)},e.prototype.identify=function(n,o){if(it(n)){var s=n._q;n._q=[],n=nt(new ze,s)}return o!=null&&o.user_id&&this.setUserId(o.user_id),o!=null&&o.device_id&&this.setDeviceId(o.device_id),t.prototype.identify.call(this,n,o)},e.prototype.groupIdentify=function(n,o,s,a){if(it(s)){var l=s._q;s._q=[],s=nt(new ze,l)}return t.prototype.groupIdentify.call(this,n,o,s,a)},e.prototype.revenue=function(n,o){if(it(n)){var s=n._q;n._q=[],n=nt(new Kr,s)}return t.prototype.revenue.call(this,n,o)},e.prototype.process=function(n){return I(this,void 0,void 0,function(){var o,s,a;return _(this,function(l){return o=Date.now(),s=this.config.lastEventTime||Date.now(),a=o-s,n.event_type!==Lt&&n.event_type!==Ot&&(!n.session_id||n.session_id===this.getSessionId())&&a>this.config.sessionTimeout&&this.setSessionId(o),[2,t.prototype.process.call(this,n)]})})},e}(Gr),oi=function(){var t=new ii;return{init:W(t.init.bind(t),"init",$(t),j(t,["config"])),add:W(t.add.bind(t),"add",$(t),j(t,["config.apiKey","timeline.plugins"])),remove:W(t.remove.bind(t),"remove",$(t),j(t,["config.apiKey","timeline.plugins"])),track:W(t.track.bind(t),"track",$(t),j(t,["config.apiKey","timeline.queue.length"])),logEvent:W(t.logEvent.bind(t),"logEvent",$(t),j(t,["config.apiKey","timeline.queue.length"])),identify:W(t.identify.bind(t),"identify",$(t),j(t,["config.apiKey","timeline.queue.length"])),groupIdentify:W(t.groupIdentify.bind(t),"groupIdentify",$(t),j(t,["config.apiKey","timeline.queue.length"])),setGroup:W(t.setGroup.bind(t),"setGroup",$(t),j(t,["config.apiKey","timeline.queue.length"])),revenue:W(t.revenue.bind(t),"revenue",$(t),j(t,["config.apiKey","timeline.queue.length"])),flush:W(t.flush.bind(t),"flush",$(t),j(t,["config.apiKey","timeline.queue.length"])),getUserId:W(t.getUserId.bind(t),"getUserId",$(t),j(t,["config","config.userId"])),setUserId:W(t.setUserId.bind(t),"setUserId",$(t),j(t,["config","config.userId"])),getDeviceId:W(t.getDeviceId.bind(t),"getDeviceId",$(t),j(t,["config","config.deviceId"])),setDeviceId:W(t.setDeviceId.bind(t),"setDeviceId",$(t),j(t,["config","config.deviceId"])),reset:W(t.reset.bind(t),"reset",$(t),j(t,["config","config.userId","config.deviceId"])),getSessionId:W(t.getSessionId.bind(t),"getSessionId",$(t),j(t,["config"])),setSessionId:W(t.setSessionId.bind(t),"setSessionId",$(t),j(t,["config"])),extendSession:W(t.extendSession.bind(t),"extendSession",$(t),j(t,["config"])),setOptOut:W(t.setOptOut.bind(t),"setOptOut",$(t),j(t,["config"])),setTransport:W(t.setTransport.bind(t),"setTransport",$(t),j(t,["config"]))}};const G=oi();G.add;G.extendSession;G.flush;G.getDeviceId;G.getSessionId;G.getUserId;G.groupIdentify;G.identify;var ci=G.init;G.logEvent;G.remove;G.reset;G.revenue;G.setDeviceId;G.setGroup;G.setOptOut;G.setSessionId;G.setTransport;G.setUserId;var fi=G.track;export{T as _,dt as a,oe as b,Xe as c,ai as d,qt as e,X as f,ci as i,Me as o,Br as p,fi as t};
