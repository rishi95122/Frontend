var bc=Object.defineProperty;var wc=(t,e,r)=>e in t?bc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var ze=(t,e,r)=>(wc(t,typeof e!="symbol"?e+"":e,r),r);import{C as mc,S as bt,E as Kn,R as vc,M as Ec}from"./core-31553e76.js";import{n as Tt,i as Sc,U as go}from"../@cosmjs/cosmwasm-stargate-9f258b2c.js";import{p as Ct,o as wt,e as pr}from"../@amplitude/analytics-browser-ad7e1a7e.js";import{c as ft,g as Dc,b as ar}from"../vendor-e56015e7.js";import{a as xc}from"./coin98-ca182315.js";import{L as Oc}from"../long-9036a742.js";var Qr={exports:{}};Qr.exports;(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,a=9007199254740991,c="[object Arguments]",h="[object Array]",l="[object AsyncFunction]",g="[object Boolean]",m="[object Date]",y="[object Error]",v="[object Function]",S="[object GeneratorFunction]",P="[object Map]",N="[object Number]",z="[object Null]",E="[object Object]",I="[object Promise]",_="[object Proxy]",w="[object RegExp]",d="[object Set]",o="[object String]",f="[object Symbol]",R="[object Undefined]",U="[object WeakMap]",K="[object ArrayBuffer]",G="[object DataView]",X="[object Float32Array]",O="[object Float64Array]",A="[object Int8Array]",W="[object Int16Array]",j="[object Int32Array]",$="[object Uint8Array]",M="[object Uint8ClampedArray]",F="[object Uint16Array]",q="[object Uint32Array]",te=/[\\^$.*+?()[\]{}|]/g,B=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,Y={};Y[X]=Y[O]=Y[A]=Y[W]=Y[j]=Y[$]=Y[M]=Y[F]=Y[q]=!0,Y[c]=Y[h]=Y[K]=Y[g]=Y[G]=Y[m]=Y[y]=Y[v]=Y[P]=Y[N]=Y[E]=Y[w]=Y[d]=Y[o]=Y[U]=!1;var ee=typeof ft=="object"&&ft&&ft.Object===Object&&ft,T=typeof self=="object"&&self&&self.Object===Object&&self,C=ee||T||Function("return this")(),D=e&&!e.nodeType&&e,u=D&&!0&&t&&!t.nodeType&&t,b=u&&u.exports===D,H=b&&ee.process,k=function(){try{return H&&H.binding&&H.binding("util")}catch{}}(),he=k&&k.isTypedArray;function _e(p,x){for(var L=-1,J=p==null?0:p.length,Oe=0,se=[];++L<J;){var Ne=p[L];x(Ne,L,p)&&(se[Oe++]=Ne)}return se}function de(p,x){for(var L=-1,J=x.length,Oe=p.length;++L<J;)p[Oe+L]=x[L];return p}function ve(p,x){for(var L=-1,J=p==null?0:p.length;++L<J;)if(x(p[L],L,p))return!0;return!1}function Ue(p,x){for(var L=-1,J=Array(p);++L<p;)J[L]=x(L);return J}function Te(p){return function(x){return p(x)}}function ye(p,x){return p.has(x)}function ge(p,x){return p==null?void 0:p[x]}function fe(p){var x=-1,L=Array(p.size);return p.forEach(function(J,Oe){L[++x]=[Oe,J]}),L}function ue(p,x){return function(L){return p(x(L))}}function ce(p){var x=-1,L=Array(p.size);return p.forEach(function(J){L[++x]=J}),L}var ae=Array.prototype,oe=Function.prototype,re=Object.prototype,le=C["__core-js_shared__"],pe=oe.toString,ie=re.hasOwnProperty,be=function(){var p=/[^.]+$/.exec(le&&le.keys&&le.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),me=re.toString,Se=RegExp("^"+pe.call(ie).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=b?C.Buffer:void 0,Ee=C.Symbol,mt=C.Uint8Array,Dt=re.propertyIsEnumerable,Ft=ae.splice,lt=Ee?Ee.toStringTag:void 0,Kt=Object.getOwnPropertySymbols,fr=De?De.isBuffer:void 0,zr=ue(Object.keys,Object),Fe=rr(C,"DataView"),Ae=rr(C,"Map"),$e=rr(C,"Promise"),Le=rr(C,"Set"),Me=rr(C,"WeakMap"),Pe=rr(Object,"create"),He=Vt(Fe),Ve=Vt(Ae),Ge=Vt($e),We=Vt(Le),ke=Vt(Me),Be=Ee?Ee.prototype:void 0,je=Be?Be.valueOf:void 0;function Ie(p){var x=-1,L=p==null?0:p.length;for(this.clear();++x<L;){var J=p[x];this.set(J[0],J[1])}}function Ye(){this.__data__=Pe?Pe(null):{},this.size=0}function Je(p){var x=this.has(p)&&delete this.__data__[p];return this.size-=x?1:0,x}function Pa(p){var x=this.__data__;if(Pe){var L=x[p];return L===i?void 0:L}return ie.call(x,p)?x[p]:void 0}function Na(p){var x=this.__data__;return Pe?x[p]!==void 0:ie.call(x,p)}function Ra(p,x){var L=this.__data__;return this.size+=this.has(p)?0:1,L[p]=Pe&&x===void 0?i:x,this}Ie.prototype.clear=Ye,Ie.prototype.delete=Je,Ie.prototype.get=Pa,Ie.prototype.has=Na,Ie.prototype.set=Ra;function At(p){var x=-1,L=p==null?0:p.length;for(this.clear();++x<L;){var J=p[x];this.set(J[0],J[1])}}function Ua(){this.__data__=[],this.size=0}function Fa(p){var x=this.__data__,L=Hr(x,p);if(L<0)return!1;var J=x.length-1;return L==J?x.pop():Ft.call(x,L,1),--this.size,!0}function $a(p){var x=this.__data__,L=Hr(x,p);return L<0?void 0:x[L][1]}function La(p){return Hr(this.__data__,p)>-1}function Ma(p,x){var L=this.__data__,J=Hr(L,p);return J<0?(++this.size,L.push([p,x])):L[J][1]=x,this}At.prototype.clear=Ua,At.prototype.delete=Fa,At.prototype.get=$a,At.prototype.has=La,At.prototype.set=Ma;function Ht(p){var x=-1,L=p==null?0:p.length;for(this.clear();++x<L;){var J=p[x];this.set(J[0],J[1])}}function ja(){this.size=0,this.__data__={hash:new Ie,map:new(Ae||At),string:new Ie}}function qa(p){var x=Vr(this,p).delete(p);return this.size-=x?1:0,x}function Ba(p){return Vr(this,p).get(p)}function za(p){return Vr(this,p).has(p)}function Ka(p,x){var L=Vr(this,p),J=L.size;return L.set(p,x),this.size+=L.size==J?0:1,this}Ht.prototype.clear=ja,Ht.prototype.delete=qa,Ht.prototype.get=Ba,Ht.prototype.has=za,Ht.prototype.set=Ka;function Kr(p){var x=-1,L=p==null?0:p.length;for(this.__data__=new Ht;++x<L;)this.add(p[x])}function Ha(p){return this.__data__.set(p,i),this}function Va(p){return this.__data__.has(p)}Kr.prototype.add=Kr.prototype.push=Ha,Kr.prototype.has=Va;function $t(p){var x=this.__data__=new At(p);this.size=x.size}function Ga(){this.__data__=new At,this.size=0}function Wa(p){var x=this.__data__,L=x.delete(p);return this.size=x.size,L}function ka(p){return this.__data__.get(p)}function Ya(p){return this.__data__.has(p)}function Ja(p,x){var L=this.__data__;if(L instanceof At){var J=L.__data__;if(!Ae||J.length<r-1)return J.push([p,x]),this.size=++L.size,this;L=this.__data__=new Ht(J)}return L.set(p,x),this.size=L.size,this}$t.prototype.clear=Ga,$t.prototype.delete=Wa,$t.prototype.get=ka,$t.prototype.has=Ya,$t.prototype.set=Ja;function Xa(p,x){var L=Gr(p),J=!L&&fc(p),Oe=!L&&!J&&bi(p),se=!L&&!J&&!Oe&&Bn(p),Ne=L||J||Oe||se,Xe=Ne?Ue(p.length,String):[],Ze=Xe.length;for(var Ce in p)(x||ie.call(p,Ce))&&!(Ne&&(Ce=="length"||Oe&&(Ce=="offset"||Ce=="parent")||se&&(Ce=="buffer"||Ce=="byteLength"||Ce=="byteOffset")||ac(Ce,Ze)))&&Xe.push(Ce);return Xe}function Hr(p,x){for(var L=p.length;L--;)if(Ln(p[L][0],x))return L;return-1}function Qa(p,x,L){var J=x(p);return Gr(p)?J:de(J,L(p))}function dr(p){return p==null?p===void 0?R:z:lt&&lt in Object(p)?sc(p):hc(p)}function Rn(p){return gr(p)&&dr(p)==c}function Un(p,x,L,J,Oe){return p===x?!0:p==null||x==null||!gr(p)&&!gr(x)?p!==p&&x!==x:Za(p,x,L,J,Un,Oe)}function Za(p,x,L,J,Oe,se){var Ne=Gr(p),Xe=Gr(x),Ze=Ne?h:Lt(p),Ce=Xe?h:Lt(x);Ze=Ze==c?E:Ze,Ce=Ce==c?E:Ce;var ht=Ze==E,vt=Ce==E,rt=Ze==Ce;if(rt&&bi(p)){if(!bi(x))return!1;Ne=!0,ht=!1}if(rt&&!ht)return se||(se=new $t),Ne||Bn(p)?Fn(p,x,L,J,Oe,se):ic(p,x,Ze,L,J,Oe,se);if(!(L&n)){var gt=ht&&ie.call(p,"__wrapped__"),pt=vt&&ie.call(x,"__wrapped__");if(gt||pt){var Mt=gt?p.value():p,Pt=pt?x.value():x;return se||(se=new $t),Oe(Mt,Pt,L,J,se)}}return rt?(se||(se=new $t),nc(p,x,L,J,Oe,se)):!1}function ec(p){if(!qn(p)||uc(p))return!1;var x=Mn(p)?Se:B;return x.test(Vt(p))}function tc(p){return gr(p)&&jn(p.length)&&!!Y[dr(p)]}function rc(p){if(!lc(p))return zr(p);var x=[];for(var L in Object(p))ie.call(p,L)&&L!="constructor"&&x.push(L);return x}function Fn(p,x,L,J,Oe,se){var Ne=L&n,Xe=p.length,Ze=x.length;if(Xe!=Ze&&!(Ne&&Ze>Xe))return!1;var Ce=se.get(p);if(Ce&&se.get(x))return Ce==x;var ht=-1,vt=!0,rt=L&s?new Kr:void 0;for(se.set(p,x),se.set(x,p);++ht<Xe;){var gt=p[ht],pt=x[ht];if(J)var Mt=Ne?J(pt,gt,ht,x,p,se):J(gt,pt,ht,p,x,se);if(Mt!==void 0){if(Mt)continue;vt=!1;break}if(rt){if(!ve(x,function(Pt,Gt){if(!ye(rt,Gt)&&(gt===Pt||Oe(gt,Pt,L,J,se)))return rt.push(Gt)})){vt=!1;break}}else if(!(gt===pt||Oe(gt,pt,L,J,se))){vt=!1;break}}return se.delete(p),se.delete(x),vt}function ic(p,x,L,J,Oe,se,Ne){switch(L){case G:if(p.byteLength!=x.byteLength||p.byteOffset!=x.byteOffset)return!1;p=p.buffer,x=x.buffer;case K:return!(p.byteLength!=x.byteLength||!se(new mt(p),new mt(x)));case g:case m:case N:return Ln(+p,+x);case y:return p.name==x.name&&p.message==x.message;case w:case o:return p==x+"";case P:var Xe=fe;case d:var Ze=J&n;if(Xe||(Xe=ce),p.size!=x.size&&!Ze)return!1;var Ce=Ne.get(p);if(Ce)return Ce==x;J|=s,Ne.set(p,x);var ht=Fn(Xe(p),Xe(x),J,Oe,se,Ne);return Ne.delete(p),ht;case f:if(je)return je.call(p)==je.call(x)}return!1}function nc(p,x,L,J,Oe,se){var Ne=L&n,Xe=$n(p),Ze=Xe.length,Ce=$n(x),ht=Ce.length;if(Ze!=ht&&!Ne)return!1;for(var vt=Ze;vt--;){var rt=Xe[vt];if(!(Ne?rt in x:ie.call(x,rt)))return!1}var gt=se.get(p);if(gt&&se.get(x))return gt==x;var pt=!0;se.set(p,x),se.set(x,p);for(var Mt=Ne;++vt<Ze;){rt=Xe[vt];var Pt=p[rt],Gt=x[rt];if(J)var zn=Ne?J(Gt,Pt,rt,x,p,se):J(Pt,Gt,rt,p,x,se);if(!(zn===void 0?Pt===Gt||Oe(Pt,Gt,L,J,se):zn)){pt=!1;break}Mt||(Mt=rt=="constructor")}if(pt&&!Mt){var Wr=p.constructor,kr=x.constructor;Wr!=kr&&"constructor"in p&&"constructor"in x&&!(typeof Wr=="function"&&Wr instanceof Wr&&typeof kr=="function"&&kr instanceof kr)&&(pt=!1)}return se.delete(p),se.delete(x),pt}function $n(p){return Qa(p,pc,oc)}function Vr(p,x){var L=p.__data__;return cc(x)?L[typeof x=="string"?"string":"hash"]:L.map}function rr(p,x){var L=ge(p,x);return ec(L)?L:void 0}function sc(p){var x=ie.call(p,lt),L=p[lt];try{p[lt]=void 0;var J=!0}catch{}var Oe=me.call(p);return J&&(x?p[lt]=L:delete p[lt]),Oe}var oc=Kt?function(p){return p==null?[]:(p=Object(p),_e(Kt(p),function(x){return Dt.call(p,x)}))}:yc,Lt=dr;(Fe&&Lt(new Fe(new ArrayBuffer(1)))!=G||Ae&&Lt(new Ae)!=P||$e&&Lt($e.resolve())!=I||Le&&Lt(new Le)!=d||Me&&Lt(new Me)!=U)&&(Lt=function(p){var x=dr(p),L=x==E?p.constructor:void 0,J=L?Vt(L):"";if(J)switch(J){case He:return G;case Ve:return P;case Ge:return I;case We:return d;case ke:return U}return x});function ac(p,x){return x=x??a,!!x&&(typeof p=="number"||Z.test(p))&&p>-1&&p%1==0&&p<x}function cc(p){var x=typeof p;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?p!=="__proto__":p===null}function uc(p){return!!be&&be in p}function lc(p){var x=p&&p.constructor,L=typeof x=="function"&&x.prototype||re;return p===L}function hc(p){return me.call(p)}function Vt(p){if(p!=null){try{return pe.call(p)}catch{}try{return p+""}catch{}}return""}function Ln(p,x){return p===x||p!==p&&x!==x}var fc=Rn(function(){return arguments}())?Rn:function(p){return gr(p)&&ie.call(p,"callee")&&!Dt.call(p,"callee")},Gr=Array.isArray;function dc(p){return p!=null&&jn(p.length)&&!Mn(p)}var bi=fr||_c;function gc(p,x){return Un(p,x)}function Mn(p){if(!qn(p))return!1;var x=dr(p);return x==v||x==S||x==l||x==_}function jn(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=a}function qn(p){var x=typeof p;return p!=null&&(x=="object"||x=="function")}function gr(p){return p!=null&&typeof p=="object"}var Bn=he?Te(he):tc;function pc(p){return dc(p)?Xa(p):rc(p)}function yc(){return[]}function _c(){return!1}t.exports=gc})(Qr,Qr.exports);var Ic=Qr.exports;const Cc=Dc(Ic);class u_ extends mc{constructor(r,i,n){super(r,i);ze(this,"WCClient");ze(this,"clientMutable",{state:bt.Init});ze(this,"options");this.WCClient=n}setClientNotExist(){this.setState(bt.Error),this.setMessage(this.clientMutable.message)}}var si={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var $i=function(t,e){return $i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},$i(t,e)};function Tc(t,e){$i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Li=function(){return Li=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Li.apply(this,arguments)};function Ac(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Pc(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Nc(t,e){return function(r,i){e(r,i,t)}}function Rc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Uc(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(g){try{l(i.next(g))}catch(m){a(m)}}function h(g){try{l(i.throw(g))}catch(m){a(m)}}function l(g){g.done?s(g.value):n(g.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function Fc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(g){return h([l,g])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(g){l=[6,g],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function $c(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Lc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Mi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function po(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function Mc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(po(arguments[e]));return t}function jc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Ar(t){return this instanceof Ar?(this.v=t,this):new Ar(t)}function qc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(v){return new Promise(function(S,P){s.push([y,v,S,P])>1||c(y,v)})})}function c(y,v){try{h(i[y](v))}catch(S){m(s[0][3],S)}}function h(y){y.value instanceof Ar?Promise.resolve(y.value.v).then(l,g):m(s[0][2],y)}function l(y){c("next",y)}function g(y){c("throw",y)}function m(y,v){y(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Bc(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Ar(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function zc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Mi=="function"?Mi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function Kc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Hc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Vc(t){return t&&t.__esModule?t:{default:t}}function Gc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Wc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const kc=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Li},__asyncDelegator:Bc,__asyncGenerator:qc,__asyncValues:zc,__await:Ar,__awaiter:Uc,__classPrivateFieldGet:Gc,__classPrivateFieldSet:Wc,__createBinding:$c,__decorate:Pc,__exportStar:Lc,__extends:Tc,__generator:Fc,__importDefault:Vc,__importStar:Hc,__makeTemplateObject:Kc,__metadata:Rc,__param:Nc,__read:po,__rest:Ac,__spread:Mc,__spreadArrays:jc,__values:Mi},Symbol.toStringTag,{value:"Module"})),yo=ar(kc);var $r={};Object.defineProperty($r,"__esModule",{value:!0});function Yc(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}$r.safeJsonParse=Yc;function Jc(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}$r.safeJsonStringify=Jc;var yr={exports:{}},Hn;function Xc(){return Hn||(Hn=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ft<"u"&&ft.localStorage?yr.exports=ft.localStorage:typeof window<"u"&&window.localStorage?yr.exports=window.localStorage:yr.exports=new e}()),yr.exports}var wi={},_r={},Vn;function Qc(){if(Vn)return _r;Vn=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.IKeyValueStorage=void 0;class t{}return _r.IKeyValueStorage=t,_r}var br={},Gn;function Zc(){if(Gn)return br;Gn=1,Object.defineProperty(br,"__esModule",{value:!0}),br.parseEntry=void 0;const t=$r;function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return br.parseEntry=e,br}var Wn;function eu(){return Wn||(Wn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yo;e.__exportStar(Qc(),t),e.__exportStar(Zc(),t)}(wi)),wi}Object.defineProperty(si,"__esModule",{value:!0});si.KeyValueStorage=void 0;const nr=yo,kn=$r,tu=nr.__importDefault(Xc()),ru=eu();class _o{constructor(){this.localStorage=tu.default}getKeys(){return nr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return nr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(ru.parseEntry)})}getItem(e){return nr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return kn.safeJsonParse(r)})}setItem(e,r){return nr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,kn.safeJsonStringify(r))})}removeItem(e){return nr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}si.KeyValueStorage=_o;var iu=si.default=_o,cr={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ji=function(t,e){return ji=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},ji(t,e)};function nu(t,e){ji(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var qi=function(){return qi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},qi.apply(this,arguments)};function su(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function ou(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function au(t,e){return function(r,i){e(r,i,t)}}function cu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function uu(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(g){try{l(i.next(g))}catch(m){a(m)}}function h(g){try{l(i.throw(g))}catch(m){a(m)}}function l(g){g.done?s(g.value):n(g.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function lu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(g){return h([l,g])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(g){l=[6,g],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function hu(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function fu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Bi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function bo(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function du(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(bo(arguments[e]));return t}function gu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Pr(t){return this instanceof Pr?(this.v=t,this):new Pr(t)}function pu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(v){return new Promise(function(S,P){s.push([y,v,S,P])>1||c(y,v)})})}function c(y,v){try{h(i[y](v))}catch(S){m(s[0][3],S)}}function h(y){y.value instanceof Pr?Promise.resolve(y.value.v).then(l,g):m(s[0][2],y)}function l(y){c("next",y)}function g(y){c("throw",y)}function m(y,v){y(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function yu(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Pr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function _u(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Bi=="function"?Bi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function bu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function wu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function mu(t){return t&&t.__esModule?t:{default:t}}function vu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Eu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const Su=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return qi},__asyncDelegator:yu,__asyncGenerator:pu,__asyncValues:_u,__await:Pr,__awaiter:uu,__classPrivateFieldGet:vu,__classPrivateFieldSet:Eu,__createBinding:hu,__decorate:ou,__exportStar:fu,__extends:nu,__generator:lu,__importDefault:mu,__importStar:wu,__makeTemplateObject:bu,__metadata:cu,__param:au,__read:bo,__rest:su,__spread:du,__spreadArrays:gu,__values:Bi},Symbol.toStringTag,{value:"Module"})),oi=ar(Su);var wr={},Q={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var zi=function(t,e){return zi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},zi(t,e)};function Du(t,e){zi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ki=function(){return Ki=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ki.apply(this,arguments)};function xu(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Ou(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Iu(t,e){return function(r,i){e(r,i,t)}}function Cu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Tu(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(g){try{l(i.next(g))}catch(m){a(m)}}function h(g){try{l(i.throw(g))}catch(m){a(m)}}function l(g){g.done?s(g.value):n(g.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function Au(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(g){return h([l,g])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(g){l=[6,g],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Pu(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Nu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Hi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function wo(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function Ru(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(wo(arguments[e]));return t}function Uu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Nr(t){return this instanceof Nr?(this.v=t,this):new Nr(t)}function Fu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(v){return new Promise(function(S,P){s.push([y,v,S,P])>1||c(y,v)})})}function c(y,v){try{h(i[y](v))}catch(S){m(s[0][3],S)}}function h(y){y.value instanceof Nr?Promise.resolve(y.value.v).then(l,g):m(s[0][2],y)}function l(y){c("next",y)}function g(y){c("throw",y)}function m(y,v){y(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function $u(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Nr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function Lu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Hi=="function"?Hi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function Mu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function ju(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function qu(t){return t&&t.__esModule?t:{default:t}}function Bu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function zu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const Ku=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ki},__asyncDelegator:$u,__asyncGenerator:Fu,__asyncValues:Lu,__await:Nr,__awaiter:Tu,__classPrivateFieldGet:Bu,__classPrivateFieldSet:zu,__createBinding:Pu,__decorate:Ou,__exportStar:Nu,__extends:Du,__generator:Au,__importDefault:qu,__importStar:ju,__makeTemplateObject:Mu,__metadata:Cu,__param:Iu,__read:wo,__rest:xu,__spread:Ru,__spreadArrays:Uu,__values:Hi},Symbol.toStringTag,{value:"Module"})),ai=ar(Ku);var mi={},mr={},Yn;function Hu(){if(Yn)return mr;Yn=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return mr.delay=t,mr}var Wt={},vi={},kt={},Jn;function Vu(){return Jn||(Jn=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.ONE_THOUSAND=kt.ONE_HUNDRED=void 0,kt.ONE_HUNDRED=100,kt.ONE_THOUSAND=1e3),kt}var Ei={},Xn;function Gu(){return Xn||(Xn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Ei)),Ei}var Qn;function mo(){return Qn||(Qn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ai;e.__exportStar(Vu(),t),e.__exportStar(Gu(),t)}(vi)),vi}var Zn;function Wu(){if(Zn)return Wt;Zn=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.fromMiliseconds=Wt.toMiliseconds=void 0;const t=mo();function e(i){return i*t.ONE_THOUSAND}Wt.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return Wt.fromMiliseconds=r,Wt}var es;function ku(){return es||(es=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ai;e.__exportStar(Hu(),t),e.__exportStar(Wu(),t)}(mi)),mi}var ir={},ts;function Yu(){if(ts)return ir;ts=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return ir.Watch=t,ir.default=t,ir}var Si={},vr={},rs;function Ju(){if(rs)return vr;rs=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.IWatch=void 0;class t{}return vr.IWatch=t,vr}var is;function Xu(){return is||(is=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),ai.__exportStar(Ju(),t)}(Si)),Si}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ai;e.__exportStar(ku(),t),e.__exportStar(Yu(),t),e.__exportStar(Xu(),t),e.__exportStar(mo(),t)})(Q);var Di={},Er={};let Zt=class{};const Qu=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Zt},Symbol.toStringTag,{value:"Module"})),Zu=ar(Qu);var ns;function el(){if(ns)return Er;ns=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.IHeartBeat=void 0;const t=Zu;class e extends t.IEvents{constructor(i){super()}}return Er.IHeartBeat=e,Er}var ss;function vo(){return ss||(ss=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),oi.__exportStar(el(),t)}(Di)),Di}var xi={},Yt={},os;function tl(){if(os)return Yt;os=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.HEARTBEAT_EVENTS=Yt.HEARTBEAT_INTERVAL=void 0;const t=Q;return Yt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Yt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Yt}var as;function Eo(){return as||(as=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),oi.__exportStar(tl(),t)}(xi)),xi}var cs;function rl(){if(cs)return wr;cs=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.HeartBeat=void 0;const t=oi,e=Tt,r=Q,i=vo(),n=Eo();class s extends i.IHeartBeat{constructor(c){super(c),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=(c==null?void 0:c.interval)||n.HEARTBEAT_INTERVAL}static init(c){return t.__awaiter(this,void 0,void 0,function*(){const h=new s(c);return yield h.init(),h})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(c,h){this.events.on(c,h)}once(c,h){this.events.once(c,h)}off(c,h){this.events.off(c,h)}removeListener(c,h){this.events.removeListener(c,h)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return wr.HeartBeat=s,wr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=oi;e.__exportStar(rl(),t),e.__exportStar(vo(),t),e.__exportStar(Eo(),t)})(cr);var we={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Vi=function(t,e){return Vi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Vi(t,e)};function il(t,e){Vi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Gi=function(){return Gi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Gi.apply(this,arguments)};function nl(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function sl(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function ol(t,e){return function(r,i){e(r,i,t)}}function al(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function cl(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(g){try{l(i.next(g))}catch(m){a(m)}}function h(g){try{l(i.throw(g))}catch(m){a(m)}}function l(g){g.done?s(g.value):n(g.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function ul(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(g){return h([l,g])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(g){l=[6,g],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function ll(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function hl(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Wi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function So(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function fl(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(So(arguments[e]));return t}function dl(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Rr(t){return this instanceof Rr?(this.v=t,this):new Rr(t)}function gl(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(v){return new Promise(function(S,P){s.push([y,v,S,P])>1||c(y,v)})})}function c(y,v){try{h(i[y](v))}catch(S){m(s[0][3],S)}}function h(y){y.value instanceof Rr?Promise.resolve(y.value.v).then(l,g):m(s[0][2],y)}function l(y){c("next",y)}function g(y){c("throw",y)}function m(y,v){y(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function pl(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Rr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function yl(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Wi=="function"?Wi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function _l(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function bl(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function wl(t){return t&&t.__esModule?t:{default:t}}function ml(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function vl(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const El=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Gi},__asyncDelegator:pl,__asyncGenerator:gl,__asyncValues:yl,__await:Rr,__awaiter:cl,__classPrivateFieldGet:ml,__classPrivateFieldSet:vl,__createBinding:ll,__decorate:sl,__exportStar:hl,__extends:il,__generator:ul,__importDefault:wl,__importStar:bl,__makeTemplateObject:_l,__metadata:al,__param:ol,__read:So,__rest:nl,__spread:fl,__spreadArrays:dl,__values:Wi},Symbol.toStringTag,{value:"Module"})),Sl=ar(El);var Oi,us;function Dl(){if(us)return Oi;us=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Oi=e;function e(r,i,n){var s=n&&n.stringify||t,a=1;if(typeof r=="object"&&r!==null){var c=i.length+a;if(c===1)return r;var h=new Array(c);h[0]=s(r);for(var l=1;l<c;l++)h[l]=s(i[l]);return h.join(" ")}if(typeof r!="string")return r;var g=i.length;if(g===0)return r;for(var m="",y=1-a,v=-1,S=r&&r.length||0,P=0;P<S;){if(r.charCodeAt(P)===37&&P+1<S){switch(v=v>-1?v:0,r.charCodeAt(P+1)){case 100:case 102:if(y>=g||i[y]==null)break;v<P&&(m+=r.slice(v,P)),m+=Number(i[y]),v=P+2,P++;break;case 105:if(y>=g||i[y]==null)break;v<P&&(m+=r.slice(v,P)),m+=Math.floor(Number(i[y])),v=P+2,P++;break;case 79:case 111:case 106:if(y>=g||i[y]===void 0)break;v<P&&(m+=r.slice(v,P));var N=typeof i[y];if(N==="string"){m+="'"+i[y]+"'",v=P+2,P++;break}if(N==="function"){m+=i[y].name||"<anonymous>",v=P+2,P++;break}m+=s(i[y]),v=P+2,P++;break;case 115:if(y>=g)break;v<P&&(m+=r.slice(v,P)),m+=String(i[y]),v=P+2,P++;break;case 37:v<P&&(m+=r.slice(v,P)),m+="%",v=P+2,P++,y--;break}++y}++P}return v===-1?r:(v<S&&(m+=r.slice(v)),m)}return Oi}var Ii,ls;function xl(){if(ls)return Ii;ls=1;const t=Dl();Ii=n;const e=w().console||{},r={mapHttpRequest:S,mapHttpResponse:S,wrapRequestSerializer:P,wrapResponseSerializer:P,wrapErrorSerializer:P,req:S,res:S,err:y};function i(d,o){return Array.isArray(d)?d.filter(function(R){return R!=="!stdSerializers.err"}):d===!0?Object.keys(o):!1}function n(d){d=d||{},d.browser=d.browser||{};const o=d.browser.transmit;if(o&&typeof o.send!="function")throw Error("pino: transmit option must have a send function");const f=d.browser.write||e;d.browser.write&&(d.browser.asObject=!0);const R=d.serializers||{},U=i(d.browser.serialize,R);let K=d.browser.serialize;Array.isArray(d.browser.serialize)&&d.browser.serialize.indexOf("!stdSerializers.err")>-1&&(K=!1);const G=["error","fatal","warn","info","debug","trace"];typeof f=="function"&&(f.error=f.fatal=f.warn=f.info=f.debug=f.trace=f),d.enabled===!1&&(d.level="silent");const X=d.level||"info",O=Object.create(f);O.log||(O.log=N),Object.defineProperty(O,"levelVal",{get:W}),Object.defineProperty(O,"level",{get:j,set:$});const A={transmit:o,serialize:U,asObject:d.browser.asObject,levels:G,timestamp:v(d)};O.levels=n.levels,O.level=X,O.setMaxListeners=O.getMaxListeners=O.emit=O.addListener=O.on=O.prependListener=O.once=O.prependOnceListener=O.removeListener=O.removeAllListeners=O.listeners=O.listenerCount=O.eventNames=O.write=O.flush=N,O.serializers=R,O._serialize=U,O._stdErrSerialize=K,O.child=M,o&&(O._logEvent=m());function W(){return this.level==="silent"?1/0:this.levels.values[this.level]}function j(){return this._level}function $(F){if(F!=="silent"&&!this.levels.values[F])throw Error("unknown level "+F);this._level=F,s(A,O,"error","log"),s(A,O,"fatal","error"),s(A,O,"warn","error"),s(A,O,"info","log"),s(A,O,"debug","log"),s(A,O,"trace","log")}function M(F,q){if(!F)throw new Error("missing bindings for child Pino");q=q||{},U&&F.serializers&&(q.serializers=F.serializers);const te=q.serializers;if(U&&te){var B=Object.assign({},R,te),Z=d.browser.serialize===!0?Object.keys(B):U;delete F.serializers,h([F],Z,B,this._stdErrSerialize)}function Y(ee){this._childLevel=(ee._childLevel|0)+1,this.error=l(ee,F,"error"),this.fatal=l(ee,F,"fatal"),this.warn=l(ee,F,"warn"),this.info=l(ee,F,"info"),this.debug=l(ee,F,"debug"),this.trace=l(ee,F,"trace"),B&&(this.serializers=B,this._serialize=Z),o&&(this._logEvent=m([].concat(ee._logEvent.bindings,F)))}return Y.prototype=this,new Y(this)}return O}n.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},n.stdSerializers=r,n.stdTimeFunctions=Object.assign({},{nullTime:z,epochTime:E,unixTime:I,isoTime:_});function s(d,o,f,R){const U=Object.getPrototypeOf(o);o[f]=o.levelVal>o.levels.values[f]?N:U[f]?U[f]:e[f]||e[R]||N,a(d,o,f)}function a(d,o,f){!d.transmit&&o[f]===N||(o[f]=function(R){return function(){const K=d.timestamp(),G=new Array(arguments.length),X=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var O=0;O<G.length;O++)G[O]=arguments[O];if(d.serialize&&!d.asObject&&h(G,this._serialize,this.serializers,this._stdErrSerialize),d.asObject?R.call(X,c(this,f,G,K)):R.apply(X,G),d.transmit){const A=d.transmit.level||o.level,W=n.levels.values[A],j=n.levels.values[f];if(j<W)return;g(this,{ts:K,methodLevel:f,methodValue:j,transmitLevel:A,transmitValue:n.levels.values[d.transmit.level||o.level],send:d.transmit.send,val:o.levelVal},G)}}}(o[f]))}function c(d,o,f,R){d._serialize&&h(f,d._serialize,d.serializers,d._stdErrSerialize);const U=f.slice();let K=U[0];const G={};R&&(G.time=R),G.level=n.levels.values[o];let X=(d._childLevel|0)+1;if(X<1&&(X=1),K!==null&&typeof K=="object"){for(;X--&&typeof U[0]=="object";)Object.assign(G,U.shift());K=U.length?t(U.shift(),U):void 0}else typeof K=="string"&&(K=t(U.shift(),U));return K!==void 0&&(G.msg=K),G}function h(d,o,f,R){for(const U in d)if(R&&d[U]instanceof Error)d[U]=n.stdSerializers.err(d[U]);else if(typeof d[U]=="object"&&!Array.isArray(d[U]))for(const K in d[U])o&&o.indexOf(K)>-1&&K in f&&(d[U][K]=f[K](d[U][K]))}function l(d,o,f){return function(){const R=new Array(1+arguments.length);R[0]=o;for(var U=1;U<R.length;U++)R[U]=arguments[U-1];return d[f].apply(this,R)}}function g(d,o,f){const R=o.send,U=o.ts,K=o.methodLevel,G=o.methodValue,X=o.val,O=d._logEvent.bindings;h(f,d._serialize||Object.keys(d.serializers),d.serializers,d._stdErrSerialize===void 0?!0:d._stdErrSerialize),d._logEvent.ts=U,d._logEvent.messages=f.filter(function(A){return O.indexOf(A)===-1}),d._logEvent.level.label=K,d._logEvent.level.value=G,R(K,d._logEvent,X),d._logEvent=m(O)}function m(d){return{ts:0,messages:[],bindings:d||[],level:{label:"",value:0}}}function y(d){const o={type:d.constructor.name,msg:d.message,stack:d.stack};for(const f in d)o[f]===void 0&&(o[f]=d[f]);return o}function v(d){return typeof d.timestamp=="function"?d.timestamp:d.timestamp===!1?z:E}function S(){return{}}function P(d){return d}function N(){}function z(){return!1}function E(){return Date.now()}function I(){return Math.round(Date.now()/1e3)}function _(){return new Date(Date.now()).toISOString()}function w(){function d(o){return typeof o<"u"&&o}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return d(self)||d(window)||d(this)||{}}}return Ii}var Jt={},hs;function Do(){return hs||(hs=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.PINO_CUSTOM_CONTEXT_KEY=Jt.PINO_LOGGER_DEFAULTS=void 0,Jt.PINO_LOGGER_DEFAULTS={level:"info"},Jt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Jt}var nt={},fs;function Ol(){if(fs)return nt;fs=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.generateChildLogger=nt.formatChildLoggerContext=nt.getLoggerContext=nt.setBrowserLoggerContext=nt.getBrowserLoggerContext=nt.getDefaultLoggerOptions=void 0;const t=Do();function e(c){return Object.assign(Object.assign({},c),{level:(c==null?void 0:c.level)||t.PINO_LOGGER_DEFAULTS.level})}nt.getDefaultLoggerOptions=e;function r(c,h=t.PINO_CUSTOM_CONTEXT_KEY){return c[h]||""}nt.getBrowserLoggerContext=r;function i(c,h,l=t.PINO_CUSTOM_CONTEXT_KEY){return c[l]=h,c}nt.setBrowserLoggerContext=i;function n(c,h=t.PINO_CUSTOM_CONTEXT_KEY){let l="";return typeof c.bindings>"u"?l=r(c,h):l=c.bindings().context||"",l}nt.getLoggerContext=n;function s(c,h,l=t.PINO_CUSTOM_CONTEXT_KEY){const g=n(c,l);return g.trim()?`${g}/${h}`:h}nt.formatChildLoggerContext=s;function a(c,h,l=t.PINO_CUSTOM_CONTEXT_KEY){const g=s(c,h,l),m=c.child({context:g});return i(m,g,l)}return nt.generateChildLogger=a,nt}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Sl,r=e.__importDefault(xl());Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Do(),t),e.__exportStar(Ol(),t)})(we);class Il extends Zt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Cl extends Zt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Tl{constructor(e,r){this.logger=e,this.core=r}}class Al extends Zt{constructor(e,r){super(),this.relayer=e,this.logger=r}}let Pl=class extends Zt{constructor(e){super()}},Nl=class{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}};class Rl extends Zt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Ul extends Zt{constructor(e,r){super(),this.core=e,this.logger=r}}let Fl=class{constructor(e,r){this.projectId=e,this.logger=r}},$l=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}};class Ll{constructor(e){this.client=e}}const Ml=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),jl=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function xo(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return jl(t)}catch{return t}}function Oo(t){return typeof t=="string"?t:Ml(t)||""}var hn={},ur={},ci={},ui={};Object.defineProperty(ui,"__esModule",{value:!0});ui.BrowserRandomSource=void 0;const ds=65536;class ql{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=ds)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,ds)));return r}}ui.BrowserRandomSource=ql;var li={},dt={};Object.defineProperty(dt,"__esModule",{value:!0});function Bl(t){for(var e=0;e<t.length;e++)t[e]=0;return t}dt.wipe=Bl;Object.defineProperty(li,"__esModule",{value:!0});li.NodeRandomSource=void 0;const zl=dt;class Kl{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof xc<"u"){const e=Sc();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,zl.wipe)(r),i}}li.NodeRandomSource=Kl;Object.defineProperty(ci,"__esModule",{value:!0});ci.SystemRandomSource=void 0;const Hl=ui,Vl=li;class Gl{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Hl.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Vl.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ci.SystemRandomSource=Gl;var ne={},Io={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,h){var l=c>>>16&65535,g=c&65535,m=h>>>16&65535,y=h&65535;return g*y+(l*y+g*m<<16>>>0)|0}t.mul=Math.imul||e;function r(c,h){return c+h|0}t.add=r;function i(c,h){return c-h|0}t.sub=i;function n(c,h){return c<<h|c>>>32-h}t.rotl=n;function s(c,h){return c<<32-h|c>>>h}t.rotr=s;function a(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}t.isInteger=Number.isInteger||a,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(c){return t.isInteger(c)&&c>=-t.MAX_SAFE_INTEGER&&c<=t.MAX_SAFE_INTEGER}})(Io);Object.defineProperty(ne,"__esModule",{value:!0});var Co=Io;function Wl(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}ne.readInt16BE=Wl;function kl(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}ne.readUint16BE=kl;function Yl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}ne.readInt16LE=Yl;function Jl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}ne.readUint16LE=Jl;function To(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}ne.writeUint16BE=To;ne.writeInt16BE=To;function Ao(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}ne.writeUint16LE=Ao;ne.writeInt16LE=Ao;function ki(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}ne.readInt32BE=ki;function Yi(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}ne.readUint32BE=Yi;function Ji(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}ne.readInt32LE=Ji;function Xi(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}ne.readUint32LE=Xi;function Zr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}ne.writeUint32BE=Zr;ne.writeInt32BE=Zr;function ei(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}ne.writeUint32LE=ei;ne.writeInt32LE=ei;function Xl(t,e){e===void 0&&(e=0);var r=ki(t,e),i=ki(t,e+4);return r*4294967296+i-(i>>31)*4294967296}ne.readInt64BE=Xl;function Ql(t,e){e===void 0&&(e=0);var r=Yi(t,e),i=Yi(t,e+4);return r*4294967296+i}ne.readUint64BE=Ql;function Zl(t,e){e===void 0&&(e=0);var r=Ji(t,e),i=Ji(t,e+4);return i*4294967296+r-(r>>31)*4294967296}ne.readInt64LE=Zl;function eh(t,e){e===void 0&&(e=0);var r=Xi(t,e),i=Xi(t,e+4);return i*4294967296+r}ne.readUint64LE=eh;function Po(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Zr(t/4294967296>>>0,e,r),Zr(t>>>0,e,r+4),e}ne.writeUint64BE=Po;ne.writeInt64BE=Po;function No(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),ei(t>>>0,e,r),ei(t/4294967296>>>0,e,r+4),e}ne.writeUint64LE=No;ne.writeInt64LE=No;function th(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}ne.readUintBE=th;function rh(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}ne.readUintLE=rh;function ih(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Co.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}ne.writeUintBE=ih;function nh(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Co.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}ne.writeUintLE=nh;function sh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}ne.readFloat32BE=sh;function oh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}ne.readFloat32LE=oh;function ah(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}ne.readFloat64BE=ah;function ch(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}ne.readFloat64LE=ch;function uh(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}ne.writeFloat32BE=uh;function lh(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}ne.writeFloat32LE=lh;function hh(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}ne.writeFloat64BE=hh;function fh(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}ne.writeFloat64LE=fh;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=ci,r=ne,i=dt;t.defaultRandomSource=new e.SystemRandomSource;function n(l,g=t.defaultRandomSource){return g.randomBytes(l)}t.randomBytes=n;function s(l=t.defaultRandomSource){const g=n(4,l),m=(0,r.readUint32LE)(g);return(0,i.wipe)(g),m}t.randomUint32=s;const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(l,g=a,m=t.defaultRandomSource){if(g.length<2)throw new Error("randomString charset is too short");if(g.length>256)throw new Error("randomString charset is too long");let y="";const v=g.length,S=256-256%v;for(;l>0;){const P=n(Math.ceil(l*256/S),m);for(let N=0;N<P.length&&l>0;N++){const z=P[N];z<S&&(y+=g.charAt(z%v),l--)}(0,i.wipe)(P)}return y}t.randomString=c;function h(l,g=a,m=t.defaultRandomSource){const y=Math.ceil(l/(Math.log(g.length)/Math.LN2));return c(y,g,m)}t.randomStringForEntropy=h})(ur);var Ro={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ne,r=dt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(h,l){if(l===void 0&&(l=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var g=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&l>0;)this._buffer[this._bufferLength++]=h[g++],l--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(g=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,g,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=h[g++],l--;return this},c.prototype.finish=function(h){if(!this._finished){var l=this._bytesHashed,g=this._bufferLength,m=l/536870912|0,y=l<<3,v=l%128<112?128:256;this._buffer[g]=128;for(var S=g+1;S<v-8;S++)this._buffer[S]=0;e.writeUint32BE(m,this._buffer,v-8),e.writeUint32BE(y,this._buffer,v-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,v),this._finished=!0}for(var S=0;S<this.digestLength/8;S++)e.writeUint32BE(this._stateHi[S],h,S*8),e.writeUint32BE(this._stateLo[S],h,S*8+4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(c,h,l,g,m,y,v){for(var S=l[0],P=l[1],N=l[2],z=l[3],E=l[4],I=l[5],_=l[6],w=l[7],d=g[0],o=g[1],f=g[2],R=g[3],U=g[4],K=g[5],G=g[6],X=g[7],O,A,W,j,$,M,F,q;v>=128;){for(var te=0;te<16;te++){var B=8*te+y;c[te]=e.readUint32BE(m,B),h[te]=e.readUint32BE(m,B+4)}for(var te=0;te<80;te++){var Z=S,Y=P,ee=N,T=z,C=E,D=I,u=_,b=w,H=d,k=o,he=f,_e=R,de=U,ve=K,Ue=G,Te=X;if(O=w,A=X,$=A&65535,M=A>>>16,F=O&65535,q=O>>>16,O=(E>>>14|U<<32-14)^(E>>>18|U<<32-18)^(U>>>41-32|E<<32-(41-32)),A=(U>>>14|E<<32-14)^(U>>>18|E<<32-18)^(E>>>41-32|U<<32-(41-32)),$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,O=E&I^~E&_,A=U&K^~U&G,$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,O=n[te*2],A=n[te*2+1],$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,O=c[te%16],A=h[te%16],$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,M+=$>>>16,F+=M>>>16,q+=F>>>16,W=F&65535|q<<16,j=$&65535|M<<16,O=W,A=j,$=A&65535,M=A>>>16,F=O&65535,q=O>>>16,O=(S>>>28|d<<32-28)^(d>>>34-32|S<<32-(34-32))^(d>>>39-32|S<<32-(39-32)),A=(d>>>28|S<<32-28)^(S>>>34-32|d<<32-(34-32))^(S>>>39-32|d<<32-(39-32)),$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,O=S&P^S&N^P&N,A=d&o^d&f^o&f,$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,M+=$>>>16,F+=M>>>16,q+=F>>>16,b=F&65535|q<<16,Te=$&65535|M<<16,O=T,A=_e,$=A&65535,M=A>>>16,F=O&65535,q=O>>>16,O=W,A=j,$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,M+=$>>>16,F+=M>>>16,q+=F>>>16,T=F&65535|q<<16,_e=$&65535|M<<16,P=Z,N=Y,z=ee,E=T,I=C,_=D,w=u,S=b,o=H,f=k,R=he,U=_e,K=de,G=ve,X=Ue,d=Te,te%16===15)for(var B=0;B<16;B++)O=c[B],A=h[B],$=A&65535,M=A>>>16,F=O&65535,q=O>>>16,O=c[(B+9)%16],A=h[(B+9)%16],$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,W=c[(B+1)%16],j=h[(B+1)%16],O=(W>>>1|j<<32-1)^(W>>>8|j<<32-8)^W>>>7,A=(j>>>1|W<<32-1)^(j>>>8|W<<32-8)^(j>>>7|W<<32-7),$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,W=c[(B+14)%16],j=h[(B+14)%16],O=(W>>>19|j<<32-19)^(j>>>61-32|W<<32-(61-32))^W>>>6,A=(j>>>19|W<<32-19)^(W>>>61-32|j<<32-(61-32))^(j>>>6|W<<32-6),$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,M+=$>>>16,F+=M>>>16,q+=F>>>16,c[B]=F&65535|q<<16,h[B]=$&65535|M<<16}O=S,A=d,$=A&65535,M=A>>>16,F=O&65535,q=O>>>16,O=l[0],A=g[0],$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,M+=$>>>16,F+=M>>>16,q+=F>>>16,l[0]=S=F&65535|q<<16,g[0]=d=$&65535|M<<16,O=P,A=o,$=A&65535,M=A>>>16,F=O&65535,q=O>>>16,O=l[1],A=g[1],$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,M+=$>>>16,F+=M>>>16,q+=F>>>16,l[1]=P=F&65535|q<<16,g[1]=o=$&65535|M<<16,O=N,A=f,$=A&65535,M=A>>>16,F=O&65535,q=O>>>16,O=l[2],A=g[2],$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,M+=$>>>16,F+=M>>>16,q+=F>>>16,l[2]=N=F&65535|q<<16,g[2]=f=$&65535|M<<16,O=z,A=R,$=A&65535,M=A>>>16,F=O&65535,q=O>>>16,O=l[3],A=g[3],$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,M+=$>>>16,F+=M>>>16,q+=F>>>16,l[3]=z=F&65535|q<<16,g[3]=R=$&65535|M<<16,O=E,A=U,$=A&65535,M=A>>>16,F=O&65535,q=O>>>16,O=l[4],A=g[4],$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,M+=$>>>16,F+=M>>>16,q+=F>>>16,l[4]=E=F&65535|q<<16,g[4]=U=$&65535|M<<16,O=I,A=K,$=A&65535,M=A>>>16,F=O&65535,q=O>>>16,O=l[5],A=g[5],$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,M+=$>>>16,F+=M>>>16,q+=F>>>16,l[5]=I=F&65535|q<<16,g[5]=K=$&65535|M<<16,O=_,A=G,$=A&65535,M=A>>>16,F=O&65535,q=O>>>16,O=l[6],A=g[6],$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,M+=$>>>16,F+=M>>>16,q+=F>>>16,l[6]=_=F&65535|q<<16,g[6]=G=$&65535|M<<16,O=w,A=X,$=A&65535,M=A>>>16,F=O&65535,q=O>>>16,O=l[7],A=g[7],$+=A&65535,M+=A>>>16,F+=O&65535,q+=O>>>16,M+=$>>>16,F+=M>>>16,q+=F>>>16,l[7]=w=F&65535|q<<16,g[7]=X=$&65535|M<<16,y+=128,v-=128}return y}function a(c){var h=new i;h.update(c);var l=h.digest();return h.clean(),l}t.hash=a})(Ro);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=ur,r=Ro,i=dt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(T){const C=new Float64Array(16);if(T)for(let D=0;D<T.length;D++)C[D]=T[D];return C}const s=new Uint8Array(32);s[0]=9;const a=n(),c=n([1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),g=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),y=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function v(T,C){for(let D=0;D<16;D++)T[D]=C[D]|0}function S(T){let C=1;for(let D=0;D<16;D++){let u=T[D]+C+65535;C=Math.floor(u/65536),T[D]=u-C*65536}T[0]+=C-1+37*(C-1)}function P(T,C,D){const u=~(D-1);for(let b=0;b<16;b++){const H=u&(T[b]^C[b]);T[b]^=H,C[b]^=H}}function N(T,C){const D=n(),u=n();for(let b=0;b<16;b++)u[b]=C[b];S(u),S(u),S(u);for(let b=0;b<2;b++){D[0]=u[0]-65517;for(let k=1;k<15;k++)D[k]=u[k]-65535-(D[k-1]>>16&1),D[k-1]&=65535;D[15]=u[15]-32767-(D[14]>>16&1);const H=D[15]>>16&1;D[14]&=65535,P(u,D,1-H)}for(let b=0;b<16;b++)T[2*b]=u[b]&255,T[2*b+1]=u[b]>>8}function z(T,C){let D=0;for(let u=0;u<32;u++)D|=T[u]^C[u];return(1&D-1>>>8)-1}function E(T,C){const D=new Uint8Array(32),u=new Uint8Array(32);return N(D,T),N(u,C),z(D,u)}function I(T){const C=new Uint8Array(32);return N(C,T),C[0]&1}function _(T,C){for(let D=0;D<16;D++)T[D]=C[2*D]+(C[2*D+1]<<8);T[15]&=32767}function w(T,C,D){for(let u=0;u<16;u++)T[u]=C[u]+D[u]}function d(T,C,D){for(let u=0;u<16;u++)T[u]=C[u]-D[u]}function o(T,C,D){let u,b,H=0,k=0,he=0,_e=0,de=0,ve=0,Ue=0,Te=0,ye=0,ge=0,fe=0,ue=0,ce=0,ae=0,oe=0,re=0,le=0,pe=0,ie=0,be=0,me=0,Se=0,De=0,Ee=0,mt=0,Dt=0,Ft=0,lt=0,Kt=0,fr=0,zr=0,Fe=D[0],Ae=D[1],$e=D[2],Le=D[3],Me=D[4],Pe=D[5],He=D[6],Ve=D[7],Ge=D[8],We=D[9],ke=D[10],Be=D[11],je=D[12],Ie=D[13],Ye=D[14],Je=D[15];u=C[0],H+=u*Fe,k+=u*Ae,he+=u*$e,_e+=u*Le,de+=u*Me,ve+=u*Pe,Ue+=u*He,Te+=u*Ve,ye+=u*Ge,ge+=u*We,fe+=u*ke,ue+=u*Be,ce+=u*je,ae+=u*Ie,oe+=u*Ye,re+=u*Je,u=C[1],k+=u*Fe,he+=u*Ae,_e+=u*$e,de+=u*Le,ve+=u*Me,Ue+=u*Pe,Te+=u*He,ye+=u*Ve,ge+=u*Ge,fe+=u*We,ue+=u*ke,ce+=u*Be,ae+=u*je,oe+=u*Ie,re+=u*Ye,le+=u*Je,u=C[2],he+=u*Fe,_e+=u*Ae,de+=u*$e,ve+=u*Le,Ue+=u*Me,Te+=u*Pe,ye+=u*He,ge+=u*Ve,fe+=u*Ge,ue+=u*We,ce+=u*ke,ae+=u*Be,oe+=u*je,re+=u*Ie,le+=u*Ye,pe+=u*Je,u=C[3],_e+=u*Fe,de+=u*Ae,ve+=u*$e,Ue+=u*Le,Te+=u*Me,ye+=u*Pe,ge+=u*He,fe+=u*Ve,ue+=u*Ge,ce+=u*We,ae+=u*ke,oe+=u*Be,re+=u*je,le+=u*Ie,pe+=u*Ye,ie+=u*Je,u=C[4],de+=u*Fe,ve+=u*Ae,Ue+=u*$e,Te+=u*Le,ye+=u*Me,ge+=u*Pe,fe+=u*He,ue+=u*Ve,ce+=u*Ge,ae+=u*We,oe+=u*ke,re+=u*Be,le+=u*je,pe+=u*Ie,ie+=u*Ye,be+=u*Je,u=C[5],ve+=u*Fe,Ue+=u*Ae,Te+=u*$e,ye+=u*Le,ge+=u*Me,fe+=u*Pe,ue+=u*He,ce+=u*Ve,ae+=u*Ge,oe+=u*We,re+=u*ke,le+=u*Be,pe+=u*je,ie+=u*Ie,be+=u*Ye,me+=u*Je,u=C[6],Ue+=u*Fe,Te+=u*Ae,ye+=u*$e,ge+=u*Le,fe+=u*Me,ue+=u*Pe,ce+=u*He,ae+=u*Ve,oe+=u*Ge,re+=u*We,le+=u*ke,pe+=u*Be,ie+=u*je,be+=u*Ie,me+=u*Ye,Se+=u*Je,u=C[7],Te+=u*Fe,ye+=u*Ae,ge+=u*$e,fe+=u*Le,ue+=u*Me,ce+=u*Pe,ae+=u*He,oe+=u*Ve,re+=u*Ge,le+=u*We,pe+=u*ke,ie+=u*Be,be+=u*je,me+=u*Ie,Se+=u*Ye,De+=u*Je,u=C[8],ye+=u*Fe,ge+=u*Ae,fe+=u*$e,ue+=u*Le,ce+=u*Me,ae+=u*Pe,oe+=u*He,re+=u*Ve,le+=u*Ge,pe+=u*We,ie+=u*ke,be+=u*Be,me+=u*je,Se+=u*Ie,De+=u*Ye,Ee+=u*Je,u=C[9],ge+=u*Fe,fe+=u*Ae,ue+=u*$e,ce+=u*Le,ae+=u*Me,oe+=u*Pe,re+=u*He,le+=u*Ve,pe+=u*Ge,ie+=u*We,be+=u*ke,me+=u*Be,Se+=u*je,De+=u*Ie,Ee+=u*Ye,mt+=u*Je,u=C[10],fe+=u*Fe,ue+=u*Ae,ce+=u*$e,ae+=u*Le,oe+=u*Me,re+=u*Pe,le+=u*He,pe+=u*Ve,ie+=u*Ge,be+=u*We,me+=u*ke,Se+=u*Be,De+=u*je,Ee+=u*Ie,mt+=u*Ye,Dt+=u*Je,u=C[11],ue+=u*Fe,ce+=u*Ae,ae+=u*$e,oe+=u*Le,re+=u*Me,le+=u*Pe,pe+=u*He,ie+=u*Ve,be+=u*Ge,me+=u*We,Se+=u*ke,De+=u*Be,Ee+=u*je,mt+=u*Ie,Dt+=u*Ye,Ft+=u*Je,u=C[12],ce+=u*Fe,ae+=u*Ae,oe+=u*$e,re+=u*Le,le+=u*Me,pe+=u*Pe,ie+=u*He,be+=u*Ve,me+=u*Ge,Se+=u*We,De+=u*ke,Ee+=u*Be,mt+=u*je,Dt+=u*Ie,Ft+=u*Ye,lt+=u*Je,u=C[13],ae+=u*Fe,oe+=u*Ae,re+=u*$e,le+=u*Le,pe+=u*Me,ie+=u*Pe,be+=u*He,me+=u*Ve,Se+=u*Ge,De+=u*We,Ee+=u*ke,mt+=u*Be,Dt+=u*je,Ft+=u*Ie,lt+=u*Ye,Kt+=u*Je,u=C[14],oe+=u*Fe,re+=u*Ae,le+=u*$e,pe+=u*Le,ie+=u*Me,be+=u*Pe,me+=u*He,Se+=u*Ve,De+=u*Ge,Ee+=u*We,mt+=u*ke,Dt+=u*Be,Ft+=u*je,lt+=u*Ie,Kt+=u*Ye,fr+=u*Je,u=C[15],re+=u*Fe,le+=u*Ae,pe+=u*$e,ie+=u*Le,be+=u*Me,me+=u*Pe,Se+=u*He,De+=u*Ve,Ee+=u*Ge,mt+=u*We,Dt+=u*ke,Ft+=u*Be,lt+=u*je,Kt+=u*Ie,fr+=u*Ye,zr+=u*Je,H+=38*le,k+=38*pe,he+=38*ie,_e+=38*be,de+=38*me,ve+=38*Se,Ue+=38*De,Te+=38*Ee,ye+=38*mt,ge+=38*Dt,fe+=38*Ft,ue+=38*lt,ce+=38*Kt,ae+=38*fr,oe+=38*zr,b=1,u=H+b+65535,b=Math.floor(u/65536),H=u-b*65536,u=k+b+65535,b=Math.floor(u/65536),k=u-b*65536,u=he+b+65535,b=Math.floor(u/65536),he=u-b*65536,u=_e+b+65535,b=Math.floor(u/65536),_e=u-b*65536,u=de+b+65535,b=Math.floor(u/65536),de=u-b*65536,u=ve+b+65535,b=Math.floor(u/65536),ve=u-b*65536,u=Ue+b+65535,b=Math.floor(u/65536),Ue=u-b*65536,u=Te+b+65535,b=Math.floor(u/65536),Te=u-b*65536,u=ye+b+65535,b=Math.floor(u/65536),ye=u-b*65536,u=ge+b+65535,b=Math.floor(u/65536),ge=u-b*65536,u=fe+b+65535,b=Math.floor(u/65536),fe=u-b*65536,u=ue+b+65535,b=Math.floor(u/65536),ue=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=ae+b+65535,b=Math.floor(u/65536),ae=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,H+=b-1+37*(b-1),b=1,u=H+b+65535,b=Math.floor(u/65536),H=u-b*65536,u=k+b+65535,b=Math.floor(u/65536),k=u-b*65536,u=he+b+65535,b=Math.floor(u/65536),he=u-b*65536,u=_e+b+65535,b=Math.floor(u/65536),_e=u-b*65536,u=de+b+65535,b=Math.floor(u/65536),de=u-b*65536,u=ve+b+65535,b=Math.floor(u/65536),ve=u-b*65536,u=Ue+b+65535,b=Math.floor(u/65536),Ue=u-b*65536,u=Te+b+65535,b=Math.floor(u/65536),Te=u-b*65536,u=ye+b+65535,b=Math.floor(u/65536),ye=u-b*65536,u=ge+b+65535,b=Math.floor(u/65536),ge=u-b*65536,u=fe+b+65535,b=Math.floor(u/65536),fe=u-b*65536,u=ue+b+65535,b=Math.floor(u/65536),ue=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=ae+b+65535,b=Math.floor(u/65536),ae=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,H+=b-1+37*(b-1),T[0]=H,T[1]=k,T[2]=he,T[3]=_e,T[4]=de,T[5]=ve,T[6]=Ue,T[7]=Te,T[8]=ye,T[9]=ge,T[10]=fe,T[11]=ue,T[12]=ce,T[13]=ae,T[14]=oe,T[15]=re}function f(T,C){o(T,C,C)}function R(T,C){const D=n();let u;for(u=0;u<16;u++)D[u]=C[u];for(u=253;u>=0;u--)f(D,D),u!==2&&u!==4&&o(D,D,C);for(u=0;u<16;u++)T[u]=D[u]}function U(T,C){const D=n();let u;for(u=0;u<16;u++)D[u]=C[u];for(u=250;u>=0;u--)f(D,D),u!==1&&o(D,D,C);for(u=0;u<16;u++)T[u]=D[u]}function K(T,C){const D=n(),u=n(),b=n(),H=n(),k=n(),he=n(),_e=n(),de=n(),ve=n();d(D,T[1],T[0]),d(ve,C[1],C[0]),o(D,D,ve),w(u,T[0],T[1]),w(ve,C[0],C[1]),o(u,u,ve),o(b,T[3],C[3]),o(b,b,l),o(H,T[2],C[2]),w(H,H,H),d(k,u,D),d(he,H,b),w(_e,H,b),w(de,u,D),o(T[0],k,he),o(T[1],de,_e),o(T[2],_e,he),o(T[3],k,de)}function G(T,C,D){for(let u=0;u<4;u++)P(T[u],C[u],D)}function X(T,C){const D=n(),u=n(),b=n();R(b,C[2]),o(D,C[0],b),o(u,C[1],b),N(T,u),T[31]^=I(D)<<7}function O(T,C,D){v(T[0],a),v(T[1],c),v(T[2],c),v(T[3],a);for(let u=255;u>=0;--u){const b=D[u/8|0]>>(u&7)&1;G(T,C,b),K(C,T),K(T,T),G(T,C,b)}}function A(T,C){const D=[n(),n(),n(),n()];v(D[0],g),v(D[1],m),v(D[2],c),o(D[3],g,m),O(T,D,C)}function W(T){if(T.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const C=(0,r.hash)(T);C[0]&=248,C[31]&=127,C[31]|=64;const D=new Uint8Array(32),u=[n(),n(),n(),n()];A(u,C),X(D,u);const b=new Uint8Array(64);return b.set(T),b.set(D,32),{publicKey:D,secretKey:b}}t.generateKeyPairFromSeed=W;function j(T){const C=(0,e.randomBytes)(32,T),D=W(C);return(0,i.wipe)(C),D}t.generateKeyPair=j;function $(T){if(T.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(T.subarray(32))}t.extractPublicKeyFromSecretKey=$;const M=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function F(T,C){let D,u,b,H;for(u=63;u>=32;--u){for(D=0,b=u-32,H=u-12;b<H;++b)C[b]+=D-16*C[u]*M[b-(u-32)],D=Math.floor((C[b]+128)/256),C[b]-=D*256;C[b]+=D,C[u]=0}for(D=0,b=0;b<32;b++)C[b]+=D-(C[31]>>4)*M[b],D=C[b]>>8,C[b]&=255;for(b=0;b<32;b++)C[b]-=D*M[b];for(u=0;u<32;u++)C[u+1]+=C[u]>>8,T[u]=C[u]&255}function q(T){const C=new Float64Array(64);for(let D=0;D<64;D++)C[D]=T[D];for(let D=0;D<64;D++)T[D]=0;F(T,C)}function te(T,C){const D=new Float64Array(64),u=[n(),n(),n(),n()],b=(0,r.hash)(T.subarray(0,32));b[0]&=248,b[31]&=127,b[31]|=64;const H=new Uint8Array(64);H.set(b.subarray(32),32);const k=new r.SHA512;k.update(H.subarray(32)),k.update(C);const he=k.digest();k.clean(),q(he),A(u,he),X(H,u),k.reset(),k.update(H.subarray(0,32)),k.update(T.subarray(32)),k.update(C);const _e=k.digest();q(_e);for(let de=0;de<32;de++)D[de]=he[de];for(let de=0;de<32;de++)for(let ve=0;ve<32;ve++)D[de+ve]+=_e[de]*b[ve];return F(H.subarray(32),D),H}t.sign=te;function B(T,C){const D=n(),u=n(),b=n(),H=n(),k=n(),he=n(),_e=n();return v(T[2],c),_(T[1],C),f(b,T[1]),o(H,b,h),d(b,b,T[2]),w(H,T[2],H),f(k,H),f(he,k),o(_e,he,k),o(D,_e,b),o(D,D,H),U(D,D),o(D,D,b),o(D,D,H),o(D,D,H),o(T[0],D,H),f(u,T[0]),o(u,u,H),E(u,b)&&o(T[0],T[0],y),f(u,T[0]),o(u,u,H),E(u,b)?-1:(I(T[0])===C[31]>>7&&d(T[0],a,T[0]),o(T[3],T[0],T[1]),0)}function Z(T,C,D){const u=new Uint8Array(32),b=[n(),n(),n(),n()],H=[n(),n(),n(),n()];if(D.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(B(H,T))return!1;const k=new r.SHA512;k.update(D.subarray(0,32)),k.update(T),k.update(C);const he=k.digest();return q(he),O(b,H,he),A(H,D.subarray(32)),K(b,H),X(u,b),!z(D,u)}t.verify=Z;function Y(T){let C=[n(),n(),n(),n()];if(B(C,T))throw new Error("Ed25519: invalid public key");let D=n(),u=n(),b=C[1];w(D,c,b),d(u,c,b),R(u,u),o(D,D,u);let H=new Uint8Array(32);return N(H,D),H}t.convertPublicKeyToX25519=Y;function ee(T){const C=(0,r.hash)(T.subarray(0,32));C[0]&=248,C[31]&=127,C[31]|=64;const D=new Uint8Array(C.subarray(0,32));return(0,i.wipe)(C),D}t.convertSecretKeyToX25519=ee})(hn);const dh="EdDSA",gh="JWT",Uo=".",Fo="base64url",ph="utf8",yh="utf8",_h=":",bh="did",wh="key",gs="base58btc",mh="z",vh="K36",Eh=32;function fn(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function $o(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?fn(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Qi(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=$o(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return fn(r)}function Sh(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var c=t.length,h=t.charAt(0),l=Math.log(c)/Math.log(256),g=Math.log(256)/Math.log(c);function m(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var P=0,N=0,z=0,E=S.length;z!==E&&S[z]===0;)z++,P++;for(var I=(E-z)*g+1>>>0,_=new Uint8Array(I);z!==E;){for(var w=S[z],d=0,o=I-1;(w!==0||d<N)&&o!==-1;o--,d++)w+=256*_[o]>>>0,_[o]=w%c>>>0,w=w/c>>>0;if(w!==0)throw new Error("Non-zero carry");N=d,z++}for(var f=I-N;f!==I&&_[f]===0;)f++;for(var R=h.repeat(P);f<I;++f)R+=t.charAt(_[f]);return R}function y(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var P=0;if(S[P]!==" "){for(var N=0,z=0;S[P]===h;)N++,P++;for(var E=(S.length-P)*l+1>>>0,I=new Uint8Array(E);S[P];){var _=r[S.charCodeAt(P)];if(_===255)return;for(var w=0,d=E-1;(_!==0||w<z)&&d!==-1;d--,w++)_+=c*I[d]>>>0,I[d]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");z=w,P++}if(S[P]!==" "){for(var o=E-z;o!==E&&I[o]===0;)o++;for(var f=new Uint8Array(N+(E-o)),R=N;o!==E;)f[R++]=I[o++];return f}}}function v(S){var P=y(S);if(P)return P;throw new Error(`Non-${e} character`)}return{encode:m,decodeUnsafe:y,decode:v}}var Dh=Sh,xh=Dh;const Oh=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Ih=t=>new TextEncoder().encode(t),Ch=t=>new TextDecoder().decode(t);class Th{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ah{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Lo(this,e)}}class Ph{constructor(e){this.decoders=e}or(e){return Lo(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Lo=(t,e)=>new Ph({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Nh{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new Th(e,r,i),this.decoder=new Ah(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const hi=({name:t,prefix:e,encode:r,decode:i})=>new Nh(t,e,r,i),Lr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=xh(r,e);return hi({prefix:t,name:e,encode:i,decode:s=>Oh(n(s))})},Rh=(t,e,r,i)=>{const n={};for(let g=0;g<e.length;++g)n[e[g]]=g;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,h=0,l=0;for(let g=0;g<s;++g){const m=n[t[g]];if(m===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|m,c+=r,c>=8&&(c-=8,a[l++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return a},Uh=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,c=0;for(let h=0;h<t.length;++h)for(c=c<<8|t[h],a+=8;a>r;)a-=r,s+=e[n&c>>a];if(a&&(s+=e[n&c<<r-a]),i)for(;s.length*r&7;)s+="=";return s},et=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>hi({prefix:e,name:t,encode(n){return Uh(n,i,r)},decode(n){return Rh(n,i,r,t)}}),Fh=hi({prefix:"\0",name:"identity",encode:t=>Ch(t),decode:t=>Ih(t)}),$h=Object.freeze(Object.defineProperty({__proto__:null,identity:Fh},Symbol.toStringTag,{value:"Module"})),Lh=et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Mh=Object.freeze(Object.defineProperty({__proto__:null,base2:Lh},Symbol.toStringTag,{value:"Module"})),jh=et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),qh=Object.freeze(Object.defineProperty({__proto__:null,base8:jh},Symbol.toStringTag,{value:"Module"})),Bh=Lr({prefix:"9",name:"base10",alphabet:"0123456789"}),zh=Object.freeze(Object.defineProperty({__proto__:null,base10:Bh},Symbol.toStringTag,{value:"Module"})),Kh=et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Hh=et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Vh=Object.freeze(Object.defineProperty({__proto__:null,base16:Kh,base16upper:Hh},Symbol.toStringTag,{value:"Module"})),Gh=et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Wh=et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),kh=et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Yh=et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Jh=et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Xh=et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Qh=et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Zh=et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ef=et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),tf=Object.freeze(Object.defineProperty({__proto__:null,base32:Gh,base32hex:Jh,base32hexpad:Qh,base32hexpadupper:Zh,base32hexupper:Xh,base32pad:kh,base32padupper:Yh,base32upper:Wh,base32z:ef},Symbol.toStringTag,{value:"Module"})),rf=Lr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),nf=Lr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),sf=Object.freeze(Object.defineProperty({__proto__:null,base36:rf,base36upper:nf},Symbol.toStringTag,{value:"Module"})),of=Lr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),af=Lr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),cf=Object.freeze(Object.defineProperty({__proto__:null,base58btc:of,base58flickr:af},Symbol.toStringTag,{value:"Module"})),uf=et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),lf=et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),hf=et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ff=et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),df=Object.freeze(Object.defineProperty({__proto__:null,base64:uf,base64pad:lf,base64url:hf,base64urlpad:ff},Symbol.toStringTag,{value:"Module"})),Mo=Array.from(""),gf=Mo.reduce((t,e,r)=>(t[r]=e,t),[]),pf=Mo.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function yf(t){return t.reduce((e,r)=>(e+=gf[r],e),"")}function _f(t){const e=[];for(const r of t){const i=pf[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const bf=hi({prefix:"",name:"base256emoji",encode:yf,decode:_f}),wf=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:bf},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const ps={...$h,...Mh,...qh,...zh,...Vh,...tf,...sf,...cf,...df,...wf};function jo(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const ys=jo("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ci=jo("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=$o(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),qo={utf8:ys,"utf-8":ys,hex:ps.base16,latin1:Ci,ascii:Ci,binary:Ci,...ps};function at(t,e="utf8"){const r=qo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function ut(t,e="utf8"){const r=qo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?fn(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function mf(t){return typeof t=="string"?t:JSON.stringify(t)}function ti(t){return at(ut(mf(t),ph),Fo)}function Bo(t){const e=ut(vh,gs),r=mh+at(Qi([e,t]),gs);return[bh,wh,r].join(_h)}function vf(t){return at(t,Fo)}function Ef(t){return ut([ti(t.header),ti(t.payload)].join(Uo),yh)}function Sf(t){return[ti(t.header),ti(t.payload),vf(t.signature)].join(Uo)}function _s(t=ur.randomBytes(Eh)){return hn.generateKeyPairFromSeed(t)}async function Df(t,e,r,i,n=Q.fromMiliseconds(Date.now())){const s={alg:dh,typ:gh},a=Bo(i.publicKey),c=n+r,h={iss:a,sub:t,aud:e,iat:n,exp:c},l=Ef({header:s,payload:h}),g=hn.sign(i.secretKey,l);return Sf({header:s,payload:h,signature:g})}var dn={},fi={};Object.defineProperty(fi,"__esModule",{value:!0});var it=ne,Zi=dt,xf=20;function Of(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,a=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],l=r[11]<<24|r[10]<<16|r[9]<<8|r[8],g=r[15]<<24|r[14]<<16|r[13]<<8|r[12],m=r[19]<<24|r[18]<<16|r[17]<<8|r[16],y=r[23]<<24|r[22]<<16|r[21]<<8|r[20],v=r[27]<<24|r[26]<<16|r[25]<<8|r[24],S=r[31]<<24|r[30]<<16|r[29]<<8|r[28],P=e[3]<<24|e[2]<<16|e[1]<<8|e[0],N=e[7]<<24|e[6]<<16|e[5]<<8|e[4],z=e[11]<<24|e[10]<<16|e[9]<<8|e[8],E=e[15]<<24|e[14]<<16|e[13]<<8|e[12],I=i,_=n,w=s,d=a,o=c,f=h,R=l,U=g,K=m,G=y,X=v,O=S,A=P,W=N,j=z,$=E,M=0;M<xf;M+=2)I=I+o|0,A^=I,A=A>>>32-16|A<<16,K=K+A|0,o^=K,o=o>>>32-12|o<<12,_=_+f|0,W^=_,W=W>>>32-16|W<<16,G=G+W|0,f^=G,f=f>>>32-12|f<<12,w=w+R|0,j^=w,j=j>>>32-16|j<<16,X=X+j|0,R^=X,R=R>>>32-12|R<<12,d=d+U|0,$^=d,$=$>>>32-16|$<<16,O=O+$|0,U^=O,U=U>>>32-12|U<<12,w=w+R|0,j^=w,j=j>>>32-8|j<<8,X=X+j|0,R^=X,R=R>>>32-7|R<<7,d=d+U|0,$^=d,$=$>>>32-8|$<<8,O=O+$|0,U^=O,U=U>>>32-7|U<<7,_=_+f|0,W^=_,W=W>>>32-8|W<<8,G=G+W|0,f^=G,f=f>>>32-7|f<<7,I=I+o|0,A^=I,A=A>>>32-8|A<<8,K=K+A|0,o^=K,o=o>>>32-7|o<<7,I=I+f|0,$^=I,$=$>>>32-16|$<<16,X=X+$|0,f^=X,f=f>>>32-12|f<<12,_=_+R|0,A^=_,A=A>>>32-16|A<<16,O=O+A|0,R^=O,R=R>>>32-12|R<<12,w=w+U|0,W^=w,W=W>>>32-16|W<<16,K=K+W|0,U^=K,U=U>>>32-12|U<<12,d=d+o|0,j^=d,j=j>>>32-16|j<<16,G=G+j|0,o^=G,o=o>>>32-12|o<<12,w=w+U|0,W^=w,W=W>>>32-8|W<<8,K=K+W|0,U^=K,U=U>>>32-7|U<<7,d=d+o|0,j^=d,j=j>>>32-8|j<<8,G=G+j|0,o^=G,o=o>>>32-7|o<<7,_=_+R|0,A^=_,A=A>>>32-8|A<<8,O=O+A|0,R^=O,R=R>>>32-7|R<<7,I=I+f|0,$^=I,$=$>>>32-8|$<<8,X=X+$|0,f^=X,f=f>>>32-7|f<<7;it.writeUint32LE(I+i|0,t,0),it.writeUint32LE(_+n|0,t,4),it.writeUint32LE(w+s|0,t,8),it.writeUint32LE(d+a|0,t,12),it.writeUint32LE(o+c|0,t,16),it.writeUint32LE(f+h|0,t,20),it.writeUint32LE(R+l|0,t,24),it.writeUint32LE(U+g|0,t,28),it.writeUint32LE(K+m|0,t,32),it.writeUint32LE(G+y|0,t,36),it.writeUint32LE(X+v|0,t,40),it.writeUint32LE(O+S|0,t,44),it.writeUint32LE(A+P|0,t,48),it.writeUint32LE(W+N|0,t,52),it.writeUint32LE(j+z|0,t,56),it.writeUint32LE($+E|0,t,60)}function zo(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,a;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),a=s.length-e.length,s.set(e,a)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,a=n}for(var c=new Uint8Array(64),h=0;h<r.length;h+=64){Of(c,s,t);for(var l=h;l<h+64&&l<r.length;l++)i[l]=r[l]^c[l-h];Cf(s,0,a)}return Zi.wipe(c),n===0&&Zi.wipe(s),i}fi.streamXOR=zo;function If(t,e,r,i){return i===void 0&&(i=0),Zi.wipe(r),zo(t,e,r,r,i)}fi.stream=If;function Cf(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var Ko={},zt={};Object.defineProperty(zt,"__esModule",{value:!0});function Tf(t,e,r){return~(t-1)&e|t-1&r}zt.select=Tf;function Af(t,e){return(t|0)-(e|0)-1>>>31&1}zt.lessOrEqual=Af;function Ho(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}zt.compare=Ho;function Pf(t,e){return t.length===0||e.length===0?!1:Ho(t,e)!==0}zt.equal=Pf;(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=zt,r=dt;t.DIGEST_LENGTH=16;var i=function(){function a(c){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=c[0]|c[1]<<8;this._r[0]=h&8191;var l=c[2]|c[3]<<8;this._r[1]=(h>>>13|l<<3)&8191;var g=c[4]|c[5]<<8;this._r[2]=(l>>>10|g<<6)&7939;var m=c[6]|c[7]<<8;this._r[3]=(g>>>7|m<<9)&8191;var y=c[8]|c[9]<<8;this._r[4]=(m>>>4|y<<12)&255,this._r[5]=y>>>1&8190;var v=c[10]|c[11]<<8;this._r[6]=(y>>>14|v<<2)&8191;var S=c[12]|c[13]<<8;this._r[7]=(v>>>11|S<<5)&8065;var P=c[14]|c[15]<<8;this._r[8]=(S>>>8|P<<8)&8191,this._r[9]=P>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return a.prototype._blocks=function(c,h,l){for(var g=this._fin?0:2048,m=this._h[0],y=this._h[1],v=this._h[2],S=this._h[3],P=this._h[4],N=this._h[5],z=this._h[6],E=this._h[7],I=this._h[8],_=this._h[9],w=this._r[0],d=this._r[1],o=this._r[2],f=this._r[3],R=this._r[4],U=this._r[5],K=this._r[6],G=this._r[7],X=this._r[8],O=this._r[9];l>=16;){var A=c[h+0]|c[h+1]<<8;m+=A&8191;var W=c[h+2]|c[h+3]<<8;y+=(A>>>13|W<<3)&8191;var j=c[h+4]|c[h+5]<<8;v+=(W>>>10|j<<6)&8191;var $=c[h+6]|c[h+7]<<8;S+=(j>>>7|$<<9)&8191;var M=c[h+8]|c[h+9]<<8;P+=($>>>4|M<<12)&8191,N+=M>>>1&8191;var F=c[h+10]|c[h+11]<<8;z+=(M>>>14|F<<2)&8191;var q=c[h+12]|c[h+13]<<8;E+=(F>>>11|q<<5)&8191;var te=c[h+14]|c[h+15]<<8;I+=(q>>>8|te<<8)&8191,_+=te>>>5|g;var B=0,Z=B;Z+=m*w,Z+=y*(5*O),Z+=v*(5*X),Z+=S*(5*G),Z+=P*(5*K),B=Z>>>13,Z&=8191,Z+=N*(5*U),Z+=z*(5*R),Z+=E*(5*f),Z+=I*(5*o),Z+=_*(5*d),B+=Z>>>13,Z&=8191;var Y=B;Y+=m*d,Y+=y*w,Y+=v*(5*O),Y+=S*(5*X),Y+=P*(5*G),B=Y>>>13,Y&=8191,Y+=N*(5*K),Y+=z*(5*U),Y+=E*(5*R),Y+=I*(5*f),Y+=_*(5*o),B+=Y>>>13,Y&=8191;var ee=B;ee+=m*o,ee+=y*d,ee+=v*w,ee+=S*(5*O),ee+=P*(5*X),B=ee>>>13,ee&=8191,ee+=N*(5*G),ee+=z*(5*K),ee+=E*(5*U),ee+=I*(5*R),ee+=_*(5*f),B+=ee>>>13,ee&=8191;var T=B;T+=m*f,T+=y*o,T+=v*d,T+=S*w,T+=P*(5*O),B=T>>>13,T&=8191,T+=N*(5*X),T+=z*(5*G),T+=E*(5*K),T+=I*(5*U),T+=_*(5*R),B+=T>>>13,T&=8191;var C=B;C+=m*R,C+=y*f,C+=v*o,C+=S*d,C+=P*w,B=C>>>13,C&=8191,C+=N*(5*O),C+=z*(5*X),C+=E*(5*G),C+=I*(5*K),C+=_*(5*U),B+=C>>>13,C&=8191;var D=B;D+=m*U,D+=y*R,D+=v*f,D+=S*o,D+=P*d,B=D>>>13,D&=8191,D+=N*w,D+=z*(5*O),D+=E*(5*X),D+=I*(5*G),D+=_*(5*K),B+=D>>>13,D&=8191;var u=B;u+=m*K,u+=y*U,u+=v*R,u+=S*f,u+=P*o,B=u>>>13,u&=8191,u+=N*d,u+=z*w,u+=E*(5*O),u+=I*(5*X),u+=_*(5*G),B+=u>>>13,u&=8191;var b=B;b+=m*G,b+=y*K,b+=v*U,b+=S*R,b+=P*f,B=b>>>13,b&=8191,b+=N*o,b+=z*d,b+=E*w,b+=I*(5*O),b+=_*(5*X),B+=b>>>13,b&=8191;var H=B;H+=m*X,H+=y*G,H+=v*K,H+=S*U,H+=P*R,B=H>>>13,H&=8191,H+=N*f,H+=z*o,H+=E*d,H+=I*w,H+=_*(5*O),B+=H>>>13,H&=8191;var k=B;k+=m*O,k+=y*X,k+=v*G,k+=S*K,k+=P*U,B=k>>>13,k&=8191,k+=N*R,k+=z*f,k+=E*o,k+=I*d,k+=_*w,B+=k>>>13,k&=8191,B=(B<<2)+B|0,B=B+Z|0,Z=B&8191,B=B>>>13,Y+=B,m=Z,y=Y,v=ee,S=T,P=C,N=D,z=u,E=b,I=H,_=k,h+=16,l-=16}this._h[0]=m,this._h[1]=y,this._h[2]=v,this._h[3]=S,this._h[4]=P,this._h[5]=N,this._h[6]=z,this._h[7]=E,this._h[8]=I,this._h[9]=_},a.prototype.finish=function(c,h){h===void 0&&(h=0);var l=new Uint16Array(10),g,m,y,v;if(this._leftover){for(v=this._leftover,this._buffer[v++]=1;v<16;v++)this._buffer[v]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(g=this._h[1]>>>13,this._h[1]&=8191,v=2;v<10;v++)this._h[v]+=g,g=this._h[v]>>>13,this._h[v]&=8191;for(this._h[0]+=g*5,g=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=g,g=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=g,l[0]=this._h[0]+5,g=l[0]>>>13,l[0]&=8191,v=1;v<10;v++)l[v]=this._h[v]+g,g=l[v]>>>13,l[v]&=8191;for(l[9]-=8192,m=(g^1)-1,v=0;v<10;v++)l[v]&=m;for(m=~m,v=0;v<10;v++)this._h[v]=this._h[v]&m|l[v];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,y=this._h[0]+this._pad[0],this._h[0]=y&65535,v=1;v<8;v++)y=(this._h[v]+this._pad[v]|0)+(y>>>16)|0,this._h[v]=y&65535;return c[h+0]=this._h[0]>>>0,c[h+1]=this._h[0]>>>8,c[h+2]=this._h[1]>>>0,c[h+3]=this._h[1]>>>8,c[h+4]=this._h[2]>>>0,c[h+5]=this._h[2]>>>8,c[h+6]=this._h[3]>>>0,c[h+7]=this._h[3]>>>8,c[h+8]=this._h[4]>>>0,c[h+9]=this._h[4]>>>8,c[h+10]=this._h[5]>>>0,c[h+11]=this._h[5]>>>8,c[h+12]=this._h[6]>>>0,c[h+13]=this._h[6]>>>8,c[h+14]=this._h[7]>>>0,c[h+15]=this._h[7]>>>8,this._finished=!0,this},a.prototype.update=function(c){var h=0,l=c.length,g;if(this._leftover){g=16-this._leftover,g>l&&(g=l);for(var m=0;m<g;m++)this._buffer[this._leftover+m]=c[h+m];if(l-=g,h+=g,this._leftover+=g,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(l>=16&&(g=l-l%16,this._blocks(c,h,g),h+=g,l-=g),l){for(var m=0;m<l;m++)this._buffer[this._leftover+m]=c[h+m];this._leftover+=l}return this},a.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},a.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},a}();t.Poly1305=i;function n(a,c){var h=new i(a);h.update(c);var l=h.digest();return h.clean(),l}t.oneTimeAuth=n;function s(a,c){return a.length!==t.DIGEST_LENGTH||c.length!==t.DIGEST_LENGTH?!1:e.equal(a,c)}t.equal=s})(Ko);(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=fi,r=Ko,i=dt,n=ne,s=zt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var a=new Uint8Array(16),c=function(){function h(l){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,l.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(l)}return h.prototype.seal=function(l,g,m,y){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var v=new Uint8Array(16);v.set(l,v.length-l.length);var S=new Uint8Array(32);e.stream(this._key,v,S,4);var P=g.length+this.tagLength,N;if(y){if(y.length!==P)throw new Error("ChaCha20Poly1305: incorrect destination length");N=y}else N=new Uint8Array(P);return e.streamXOR(this._key,v,g,N,4),this._authenticate(N.subarray(N.length-this.tagLength,N.length),S,N.subarray(0,N.length-this.tagLength),m),i.wipe(v),N},h.prototype.open=function(l,g,m,y){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(g.length<this.tagLength)return null;var v=new Uint8Array(16);v.set(l,v.length-l.length);var S=new Uint8Array(32);e.stream(this._key,v,S,4);var P=new Uint8Array(this.tagLength);if(this._authenticate(P,S,g.subarray(0,g.length-this.tagLength),m),!s.equal(P,g.subarray(g.length-this.tagLength,g.length)))return null;var N=g.length-this.tagLength,z;if(y){if(y.length!==N)throw new Error("ChaCha20Poly1305: incorrect destination length");z=y}else z=new Uint8Array(N);return e.streamXOR(this._key,v,g.subarray(0,g.length-this.tagLength),z,4),i.wipe(v),z},h.prototype.clean=function(){return i.wipe(this._key),this},h.prototype._authenticate=function(l,g,m,y){var v=new r.Poly1305(g);y&&(v.update(y),y.length%16>0&&v.update(a.subarray(y.length%16))),v.update(m),m.length%16>0&&v.update(a.subarray(m.length%16));var S=new Uint8Array(8);y&&n.writeUint64LE(y.length,S),v.update(S),n.writeUint64LE(m.length,S),v.update(S);for(var P=v.digest(),N=0;N<P.length;N++)l[N]=P[N];v.clean(),i.wipe(P),i.wipe(S)},h}();t.ChaCha20Poly1305=c})(dn);var Vo={},Mr={},gn={};Object.defineProperty(gn,"__esModule",{value:!0});function Nf(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}gn.isSerializableHash=Nf;Object.defineProperty(Mr,"__esModule",{value:!0});var xt=gn,Rf=zt,Uf=dt,Go=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),xt.isSerializableHash(this._inner)&&xt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Uf.wipe(i)}return t.prototype.reset=function(){if(!xt.isSerializableHash(this._inner)||!xt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){xt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),xt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!xt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!xt.isSerializableHash(this._inner)||!xt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!xt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Mr.HMAC=Go;function Ff(t,e,r){var i=new Go(t,e);i.update(r);var n=i.digest();return i.clean(),n}Mr.hmac=Ff;Mr.equal=Rf.equal;Object.defineProperty(Vo,"__esModule",{value:!0});var bs=Mr,ws=dt,$f=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=bs.hmac(this._hash,i,r);this._hmac=new bs.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),ws.wipe(this._buffer),ws.wipe(this._counter),this._bufpos=0},t}(),Lf=Vo.HKDF=$f,di={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ne,r=dt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(h,l){if(l===void 0&&(l=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var g=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&l>0;)this._buffer[this._bufferLength++]=h[g++],l--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(g=s(this._temp,this._state,h,g,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=h[g++],l--;return this},c.prototype.finish=function(h){if(!this._finished){var l=this._bytesHashed,g=this._bufferLength,m=l/536870912|0,y=l<<3,v=l%64<56?64:128;this._buffer[g]=128;for(var S=g+1;S<v-8;S++)this._buffer[S]=0;e.writeUint32BE(m,this._buffer,v-8),e.writeUint32BE(y,this._buffer,v-4),s(this._temp,this._state,this._buffer,0,v),this._finished=!0}for(var S=0;S<this.digestLength/4;S++)e.writeUint32BE(this._state[S],h,S*4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(c,h,l,g,m){for(;m>=64;){for(var y=h[0],v=h[1],S=h[2],P=h[3],N=h[4],z=h[5],E=h[6],I=h[7],_=0;_<16;_++){var w=g+_*4;c[_]=e.readUint32BE(l,w)}for(var _=16;_<64;_++){var d=c[_-2],o=(d>>>17|d<<32-17)^(d>>>19|d<<32-19)^d>>>10;d=c[_-15];var f=(d>>>7|d<<32-7)^(d>>>18|d<<32-18)^d>>>3;c[_]=(o+c[_-7]|0)+(f+c[_-16]|0)}for(var _=0;_<64;_++){var o=(((N>>>6|N<<26)^(N>>>11|N<<21)^(N>>>25|N<<7))+(N&z^~N&E)|0)+(I+(n[_]+c[_]|0)|0)|0,f=((y>>>2|y<<32-2)^(y>>>13|y<<32-13)^(y>>>22|y<<32-22))+(y&v^y&S^v&S)|0;I=E,E=z,z=N,N=P+o|0,P=S,S=v,v=y,y=o+f|0}h[0]+=y,h[1]+=v,h[2]+=S,h[3]+=P,h[4]+=N,h[5]+=z,h[6]+=E,h[7]+=I,g+=64,m-=64}return g}function a(c){var h=new i;h.update(c);var l=h.digest();return h.clean(),l}t.hash=a})(di);var pn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=ur,r=dt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(_){const w=new Float64Array(16);if(_)for(let d=0;d<_.length;d++)w[d]=_[d];return w}const n=new Uint8Array(32);n[0]=9;const s=i([56129,1]);function a(_){let w=1;for(let d=0;d<16;d++){let o=_[d]+w+65535;w=Math.floor(o/65536),_[d]=o-w*65536}_[0]+=w-1+37*(w-1)}function c(_,w,d){const o=~(d-1);for(let f=0;f<16;f++){const R=o&(_[f]^w[f]);_[f]^=R,w[f]^=R}}function h(_,w){const d=i(),o=i();for(let f=0;f<16;f++)o[f]=w[f];a(o),a(o),a(o);for(let f=0;f<2;f++){d[0]=o[0]-65517;for(let U=1;U<15;U++)d[U]=o[U]-65535-(d[U-1]>>16&1),d[U-1]&=65535;d[15]=o[15]-32767-(d[14]>>16&1);const R=d[15]>>16&1;d[14]&=65535,c(o,d,1-R)}for(let f=0;f<16;f++)_[2*f]=o[f]&255,_[2*f+1]=o[f]>>8}function l(_,w){for(let d=0;d<16;d++)_[d]=w[2*d]+(w[2*d+1]<<8);_[15]&=32767}function g(_,w,d){for(let o=0;o<16;o++)_[o]=w[o]+d[o]}function m(_,w,d){for(let o=0;o<16;o++)_[o]=w[o]-d[o]}function y(_,w,d){let o,f,R=0,U=0,K=0,G=0,X=0,O=0,A=0,W=0,j=0,$=0,M=0,F=0,q=0,te=0,B=0,Z=0,Y=0,ee=0,T=0,C=0,D=0,u=0,b=0,H=0,k=0,he=0,_e=0,de=0,ve=0,Ue=0,Te=0,ye=d[0],ge=d[1],fe=d[2],ue=d[3],ce=d[4],ae=d[5],oe=d[6],re=d[7],le=d[8],pe=d[9],ie=d[10],be=d[11],me=d[12],Se=d[13],De=d[14],Ee=d[15];o=w[0],R+=o*ye,U+=o*ge,K+=o*fe,G+=o*ue,X+=o*ce,O+=o*ae,A+=o*oe,W+=o*re,j+=o*le,$+=o*pe,M+=o*ie,F+=o*be,q+=o*me,te+=o*Se,B+=o*De,Z+=o*Ee,o=w[1],U+=o*ye,K+=o*ge,G+=o*fe,X+=o*ue,O+=o*ce,A+=o*ae,W+=o*oe,j+=o*re,$+=o*le,M+=o*pe,F+=o*ie,q+=o*be,te+=o*me,B+=o*Se,Z+=o*De,Y+=o*Ee,o=w[2],K+=o*ye,G+=o*ge,X+=o*fe,O+=o*ue,A+=o*ce,W+=o*ae,j+=o*oe,$+=o*re,M+=o*le,F+=o*pe,q+=o*ie,te+=o*be,B+=o*me,Z+=o*Se,Y+=o*De,ee+=o*Ee,o=w[3],G+=o*ye,X+=o*ge,O+=o*fe,A+=o*ue,W+=o*ce,j+=o*ae,$+=o*oe,M+=o*re,F+=o*le,q+=o*pe,te+=o*ie,B+=o*be,Z+=o*me,Y+=o*Se,ee+=o*De,T+=o*Ee,o=w[4],X+=o*ye,O+=o*ge,A+=o*fe,W+=o*ue,j+=o*ce,$+=o*ae,M+=o*oe,F+=o*re,q+=o*le,te+=o*pe,B+=o*ie,Z+=o*be,Y+=o*me,ee+=o*Se,T+=o*De,C+=o*Ee,o=w[5],O+=o*ye,A+=o*ge,W+=o*fe,j+=o*ue,$+=o*ce,M+=o*ae,F+=o*oe,q+=o*re,te+=o*le,B+=o*pe,Z+=o*ie,Y+=o*be,ee+=o*me,T+=o*Se,C+=o*De,D+=o*Ee,o=w[6],A+=o*ye,W+=o*ge,j+=o*fe,$+=o*ue,M+=o*ce,F+=o*ae,q+=o*oe,te+=o*re,B+=o*le,Z+=o*pe,Y+=o*ie,ee+=o*be,T+=o*me,C+=o*Se,D+=o*De,u+=o*Ee,o=w[7],W+=o*ye,j+=o*ge,$+=o*fe,M+=o*ue,F+=o*ce,q+=o*ae,te+=o*oe,B+=o*re,Z+=o*le,Y+=o*pe,ee+=o*ie,T+=o*be,C+=o*me,D+=o*Se,u+=o*De,b+=o*Ee,o=w[8],j+=o*ye,$+=o*ge,M+=o*fe,F+=o*ue,q+=o*ce,te+=o*ae,B+=o*oe,Z+=o*re,Y+=o*le,ee+=o*pe,T+=o*ie,C+=o*be,D+=o*me,u+=o*Se,b+=o*De,H+=o*Ee,o=w[9],$+=o*ye,M+=o*ge,F+=o*fe,q+=o*ue,te+=o*ce,B+=o*ae,Z+=o*oe,Y+=o*re,ee+=o*le,T+=o*pe,C+=o*ie,D+=o*be,u+=o*me,b+=o*Se,H+=o*De,k+=o*Ee,o=w[10],M+=o*ye,F+=o*ge,q+=o*fe,te+=o*ue,B+=o*ce,Z+=o*ae,Y+=o*oe,ee+=o*re,T+=o*le,C+=o*pe,D+=o*ie,u+=o*be,b+=o*me,H+=o*Se,k+=o*De,he+=o*Ee,o=w[11],F+=o*ye,q+=o*ge,te+=o*fe,B+=o*ue,Z+=o*ce,Y+=o*ae,ee+=o*oe,T+=o*re,C+=o*le,D+=o*pe,u+=o*ie,b+=o*be,H+=o*me,k+=o*Se,he+=o*De,_e+=o*Ee,o=w[12],q+=o*ye,te+=o*ge,B+=o*fe,Z+=o*ue,Y+=o*ce,ee+=o*ae,T+=o*oe,C+=o*re,D+=o*le,u+=o*pe,b+=o*ie,H+=o*be,k+=o*me,he+=o*Se,_e+=o*De,de+=o*Ee,o=w[13],te+=o*ye,B+=o*ge,Z+=o*fe,Y+=o*ue,ee+=o*ce,T+=o*ae,C+=o*oe,D+=o*re,u+=o*le,b+=o*pe,H+=o*ie,k+=o*be,he+=o*me,_e+=o*Se,de+=o*De,ve+=o*Ee,o=w[14],B+=o*ye,Z+=o*ge,Y+=o*fe,ee+=o*ue,T+=o*ce,C+=o*ae,D+=o*oe,u+=o*re,b+=o*le,H+=o*pe,k+=o*ie,he+=o*be,_e+=o*me,de+=o*Se,ve+=o*De,Ue+=o*Ee,o=w[15],Z+=o*ye,Y+=o*ge,ee+=o*fe,T+=o*ue,C+=o*ce,D+=o*ae,u+=o*oe,b+=o*re,H+=o*le,k+=o*pe,he+=o*ie,_e+=o*be,de+=o*me,ve+=o*Se,Ue+=o*De,Te+=o*Ee,R+=38*Y,U+=38*ee,K+=38*T,G+=38*C,X+=38*D,O+=38*u,A+=38*b,W+=38*H,j+=38*k,$+=38*he,M+=38*_e,F+=38*de,q+=38*ve,te+=38*Ue,B+=38*Te,f=1,o=R+f+65535,f=Math.floor(o/65536),R=o-f*65536,o=U+f+65535,f=Math.floor(o/65536),U=o-f*65536,o=K+f+65535,f=Math.floor(o/65536),K=o-f*65536,o=G+f+65535,f=Math.floor(o/65536),G=o-f*65536,o=X+f+65535,f=Math.floor(o/65536),X=o-f*65536,o=O+f+65535,f=Math.floor(o/65536),O=o-f*65536,o=A+f+65535,f=Math.floor(o/65536),A=o-f*65536,o=W+f+65535,f=Math.floor(o/65536),W=o-f*65536,o=j+f+65535,f=Math.floor(o/65536),j=o-f*65536,o=$+f+65535,f=Math.floor(o/65536),$=o-f*65536,o=M+f+65535,f=Math.floor(o/65536),M=o-f*65536,o=F+f+65535,f=Math.floor(o/65536),F=o-f*65536,o=q+f+65535,f=Math.floor(o/65536),q=o-f*65536,o=te+f+65535,f=Math.floor(o/65536),te=o-f*65536,o=B+f+65535,f=Math.floor(o/65536),B=o-f*65536,o=Z+f+65535,f=Math.floor(o/65536),Z=o-f*65536,R+=f-1+37*(f-1),f=1,o=R+f+65535,f=Math.floor(o/65536),R=o-f*65536,o=U+f+65535,f=Math.floor(o/65536),U=o-f*65536,o=K+f+65535,f=Math.floor(o/65536),K=o-f*65536,o=G+f+65535,f=Math.floor(o/65536),G=o-f*65536,o=X+f+65535,f=Math.floor(o/65536),X=o-f*65536,o=O+f+65535,f=Math.floor(o/65536),O=o-f*65536,o=A+f+65535,f=Math.floor(o/65536),A=o-f*65536,o=W+f+65535,f=Math.floor(o/65536),W=o-f*65536,o=j+f+65535,f=Math.floor(o/65536),j=o-f*65536,o=$+f+65535,f=Math.floor(o/65536),$=o-f*65536,o=M+f+65535,f=Math.floor(o/65536),M=o-f*65536,o=F+f+65535,f=Math.floor(o/65536),F=o-f*65536,o=q+f+65535,f=Math.floor(o/65536),q=o-f*65536,o=te+f+65535,f=Math.floor(o/65536),te=o-f*65536,o=B+f+65535,f=Math.floor(o/65536),B=o-f*65536,o=Z+f+65535,f=Math.floor(o/65536),Z=o-f*65536,R+=f-1+37*(f-1),_[0]=R,_[1]=U,_[2]=K,_[3]=G,_[4]=X,_[5]=O,_[6]=A,_[7]=W,_[8]=j,_[9]=$,_[10]=M,_[11]=F,_[12]=q,_[13]=te,_[14]=B,_[15]=Z}function v(_,w){y(_,w,w)}function S(_,w){const d=i();for(let o=0;o<16;o++)d[o]=w[o];for(let o=253;o>=0;o--)v(d,d),o!==2&&o!==4&&y(d,d,w);for(let o=0;o<16;o++)_[o]=d[o]}function P(_,w){const d=new Uint8Array(32),o=new Float64Array(80),f=i(),R=i(),U=i(),K=i(),G=i(),X=i();for(let j=0;j<31;j++)d[j]=_[j];d[31]=_[31]&127|64,d[0]&=248,l(o,w);for(let j=0;j<16;j++)R[j]=o[j];f[0]=K[0]=1;for(let j=254;j>=0;--j){const $=d[j>>>3]>>>(j&7)&1;c(f,R,$),c(U,K,$),g(G,f,U),m(f,f,U),g(U,R,K),m(R,R,K),v(K,G),v(X,f),y(f,U,f),y(U,R,G),g(G,f,U),m(f,f,U),v(R,f),m(U,K,X),y(f,U,s),g(f,f,K),y(U,U,f),y(f,K,X),y(K,R,o),v(R,G),c(f,R,$),c(U,K,$)}for(let j=0;j<16;j++)o[j+16]=f[j],o[j+32]=U[j],o[j+48]=R[j],o[j+64]=K[j];const O=o.subarray(32),A=o.subarray(16);S(O,O),y(A,A,O);const W=new Uint8Array(32);return h(W,A),W}t.scalarMult=P;function N(_){return P(_,n)}t.scalarMultBase=N;function z(_){if(_.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const w=new Uint8Array(_);return{publicKey:N(w),secretKey:w}}t.generateKeyPairFromSeed=z;function E(_){const w=(0,e.randomBytes)(32,_),d=z(w);return(0,r.wipe)(w),d}t.generateKeyPair=E;function I(_,w,d=!1){if(_.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(w.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=P(_,w);if(d){let f=0;for(let R=0;R<o.length;R++)f|=o[R];if(f===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=I})(pn);var ms=globalThis&&globalThis.__spreadArray||function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},Mf=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),jf=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=Ct.platform}return t}(),qf=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),Bf=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),zf=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Kf=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Hf=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,vs=3,Vf=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Kf]],Es=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Gf(t){return t?Ss(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new zf:typeof navigator<"u"?Ss(navigator.userAgent):Yf()}function Wf(t){return t!==""&&Vf.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function Ss(t){var e=Wf(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new Bf;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<vs&&(n=ms(ms([],n,!0),Jf(vs-n.length),!0)):n=[];var s=n.join("."),a=kf(t),c=Hf.exec(t);return c&&c[1]?new qf(r,s,a,c[1]):new Mf(r,s,a)}function kf(t){for(var e=0,r=Es.length;e<r;e++){var i=Es[e],n=i[0],s=i[1],a=s.exec(t);if(a)return n}return null}function Yf(){var t=typeof Ct<"u"&&Ct.version;return t?new jf(Ct.version.slice(1)):null}function Jf(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.getLocalStorage=xe.getLocalStorageOrThrow=xe.getCrypto=xe.getCryptoOrThrow=ko=xe.getLocation=xe.getLocationOrThrow=yn=xe.getNavigator=xe.getNavigatorOrThrow=Wo=xe.getDocument=xe.getDocumentOrThrow=xe.getFromWindowOrThrow=xe.getFromWindow=void 0;function er(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}xe.getFromWindow=er;function lr(t){const e=er(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}xe.getFromWindowOrThrow=lr;function Xf(){return lr("document")}xe.getDocumentOrThrow=Xf;function Qf(){return er("document")}var Wo=xe.getDocument=Qf;function Zf(){return lr("navigator")}xe.getNavigatorOrThrow=Zf;function ed(){return er("navigator")}var yn=xe.getNavigator=ed;function td(){return lr("location")}xe.getLocationOrThrow=td;function rd(){return er("location")}var ko=xe.getLocation=rd;function id(){return lr("crypto")}xe.getCryptoOrThrow=id;function nd(){return er("crypto")}xe.getCrypto=nd;function sd(){return lr("localStorage")}xe.getLocalStorageOrThrow=sd;function od(){return er("localStorage")}xe.getLocalStorage=od;var _n={};Object.defineProperty(_n,"__esModule",{value:!0});var Yo=_n.getWindowMetadata=void 0;const Ds=xe;function ad(){let t,e;try{t=Ds.getDocumentOrThrow(),e=Ds.getLocationOrThrow()}catch{return null}function r(){const m=t.getElementsByTagName("link"),y=[];for(let v=0;v<m.length;v++){const S=m[v],P=S.getAttribute("rel");if(P&&P.toLowerCase().indexOf("icon")>-1){const N=S.getAttribute("href");if(N)if(N.toLowerCase().indexOf("https:")===-1&&N.toLowerCase().indexOf("http:")===-1&&N.indexOf("//")!==0){let z=e.protocol+"//"+e.host;if(N.indexOf("/")===0)z+=N;else{const E=e.pathname.split("/");E.pop();const I=E.join("/");z+=I+"/"+N}y.push(z)}else if(N.indexOf("//")===0){const z=e.protocol+N;y.push(z)}else y.push(N)}}return y}function i(...m){const y=t.getElementsByTagName("meta");for(let v=0;v<y.length;v++){const S=y[v],P=["itemprop","property","name"].map(N=>S.getAttribute(N)).filter(N=>N?m.includes(N):!1);if(P.length&&P){const N=S.getAttribute("content");if(N)return N}}return""}function n(){let m=i("name","og:site_name","og:title","twitter:title");return m||(m=t.title),m}function s(){return i("description","og:description","twitter:description","keywords")}const a=n(),c=s(),h=e.origin,l=r();return{description:c,url:h,icons:l,name:a}}Yo=_n.getWindowMetadata=ad;var Ur={},cd=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Jo="%[a-f0-9]{2}",xs=new RegExp("("+Jo+")|([^%]+?)","gi"),Os=new RegExp("("+Jo+")+","gi");function en(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],en(r),en(i))}function ud(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(xs)||[],r=1;r<e.length;r++)t=en(e,r).join(""),e=t.match(xs)||[];return t}}function ld(t){for(var e={"%FE%FF":"","%FF%FE":""},r=Os.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=ud(r[0]);i!==r[0]&&(e[r[0]]=i)}r=Os.exec(t)}e["%C2"]="";for(var n=Object.keys(e),s=0;s<n.length;s++){var a=n[s];t=t.replace(new RegExp(a,"g"),e[a])}return t}var hd=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return ld(t)}},fd=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},dd=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var a=i[s],c=t[a];(n?e.indexOf(a)!==-1:e(a,c,t))&&(r[a]=c)}return r};(function(t){const e=cd,r=hd,i=fd,n=dd,s=E=>E==null,a=Symbol("encodeFragmentIdentifier");function c(E){switch(E.arrayFormat){case"index":return I=>(_,w)=>{const d=_.length;return w===void 0||E.skipNull&&w===null||E.skipEmptyString&&w===""?_:w===null?[..._,[g(I,E),"[",d,"]"].join("")]:[..._,[g(I,E),"[",g(d,E),"]=",g(w,E)].join("")]};case"bracket":return I=>(_,w)=>w===void 0||E.skipNull&&w===null||E.skipEmptyString&&w===""?_:w===null?[..._,[g(I,E),"[]"].join("")]:[..._,[g(I,E),"[]=",g(w,E)].join("")];case"colon-list-separator":return I=>(_,w)=>w===void 0||E.skipNull&&w===null||E.skipEmptyString&&w===""?_:w===null?[..._,[g(I,E),":list="].join("")]:[..._,[g(I,E),":list=",g(w,E)].join("")];case"comma":case"separator":case"bracket-separator":{const I=E.arrayFormat==="bracket-separator"?"[]=":"=";return _=>(w,d)=>d===void 0||E.skipNull&&d===null||E.skipEmptyString&&d===""?w:(d=d===null?"":d,w.length===0?[[g(_,E),I,g(d,E)].join("")]:[[w,g(d,E)].join(E.arrayFormatSeparator)])}default:return I=>(_,w)=>w===void 0||E.skipNull&&w===null||E.skipEmptyString&&w===""?_:w===null?[..._,g(I,E)]:[..._,[g(I,E),"=",g(w,E)].join("")]}}function h(E){let I;switch(E.arrayFormat){case"index":return(_,w,d)=>{if(I=/\[(\d*)\]$/.exec(_),_=_.replace(/\[\d*\]$/,""),!I){d[_]=w;return}d[_]===void 0&&(d[_]={}),d[_][I[1]]=w};case"bracket":return(_,w,d)=>{if(I=/(\[\])$/.exec(_),_=_.replace(/\[\]$/,""),!I){d[_]=w;return}if(d[_]===void 0){d[_]=[w];return}d[_]=[].concat(d[_],w)};case"colon-list-separator":return(_,w,d)=>{if(I=/(:list)$/.exec(_),_=_.replace(/:list$/,""),!I){d[_]=w;return}if(d[_]===void 0){d[_]=[w];return}d[_]=[].concat(d[_],w)};case"comma":case"separator":return(_,w,d)=>{const o=typeof w=="string"&&w.includes(E.arrayFormatSeparator),f=typeof w=="string"&&!o&&m(w,E).includes(E.arrayFormatSeparator);w=f?m(w,E):w;const R=o||f?w.split(E.arrayFormatSeparator).map(U=>m(U,E)):w===null?w:m(w,E);d[_]=R};case"bracket-separator":return(_,w,d)=>{const o=/(\[\])$/.test(_);if(_=_.replace(/\[\]$/,""),!o){d[_]=w&&m(w,E);return}const f=w===null?[]:w.split(E.arrayFormatSeparator).map(R=>m(R,E));if(d[_]===void 0){d[_]=f;return}d[_]=[].concat(d[_],f)};default:return(_,w,d)=>{if(d[_]===void 0){d[_]=w;return}d[_]=[].concat(d[_],w)}}}function l(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function g(E,I){return I.encode?I.strict?e(E):encodeURIComponent(E):E}function m(E,I){return I.decode?r(E):E}function y(E){return Array.isArray(E)?E.sort():typeof E=="object"?y(Object.keys(E)).sort((I,_)=>Number(I)-Number(_)).map(I=>E[I]):E}function v(E){const I=E.indexOf("#");return I!==-1&&(E=E.slice(0,I)),E}function S(E){let I="";const _=E.indexOf("#");return _!==-1&&(I=E.slice(_)),I}function P(E){E=v(E);const I=E.indexOf("?");return I===-1?"":E.slice(I+1)}function N(E,I){return I.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):I.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function z(E,I){I=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},I),l(I.arrayFormatSeparator);const _=h(I),w=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return w;for(const d of E.split("&")){if(d==="")continue;let[o,f]=i(I.decode?d.replace(/\+/g," "):d,"=");f=f===void 0?null:["comma","separator","bracket-separator"].includes(I.arrayFormat)?f:m(f,I),_(m(o,I),f,w)}for(const d of Object.keys(w)){const o=w[d];if(typeof o=="object"&&o!==null)for(const f of Object.keys(o))o[f]=N(o[f],I);else w[d]=N(o,I)}return I.sort===!1?w:(I.sort===!0?Object.keys(w).sort():Object.keys(w).sort(I.sort)).reduce((d,o)=>{const f=w[o];return f&&typeof f=="object"&&!Array.isArray(f)?d[o]=y(f):d[o]=f,d},Object.create(null))}t.extract=P,t.parse=z,t.stringify=(E,I)=>{if(!E)return"";I=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},I),l(I.arrayFormatSeparator);const _=f=>I.skipNull&&s(E[f])||I.skipEmptyString&&E[f]==="",w=c(I),d={};for(const f of Object.keys(E))_(f)||(d[f]=E[f]);const o=Object.keys(d);return I.sort!==!1&&o.sort(I.sort),o.map(f=>{const R=E[f];return R===void 0?"":R===null?g(f,I):Array.isArray(R)?R.length===0&&I.arrayFormat==="bracket-separator"?g(f,I)+"[]":R.reduce(w(f),[]).join("&"):g(f,I)+"="+g(R,I)}).filter(f=>f.length>0).join("&")},t.parseUrl=(E,I)=>{I=Object.assign({decode:!0},I);const[_,w]=i(E,"#");return Object.assign({url:_.split("?")[0]||"",query:z(P(E),I)},I&&I.parseFragmentIdentifier&&w?{fragmentIdentifier:m(w,I)}:{})},t.stringifyUrl=(E,I)=>{I=Object.assign({encode:!0,strict:!0,[a]:!0},I);const _=v(E.url).split("?")[0]||"",w=t.extract(E.url),d=t.parse(w,{sort:!1}),o=Object.assign(d,E.query);let f=t.stringify(o,I);f&&(f=`?${f}`);let R=S(E.url);return E.fragmentIdentifier&&(R=`#${I[a]?g(E.fragmentIdentifier,I):E.fragmentIdentifier}`),`${_}${f}${R}`},t.pick=(E,I,_)=>{_=Object.assign({parseFragmentIdentifier:!0,[a]:!1},_);const{url:w,query:d,fragmentIdentifier:o}=t.parseUrl(E,_);return t.stringifyUrl({url:w,query:n(d,I),fragmentIdentifier:o},_)},t.exclude=(E,I,_)=>{const w=Array.isArray(I)?d=>!I.includes(d):(d,o)=>!I(d,o);return t.pick(E,w,_)}})(Ur);const gd={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function Xo(t,e){return t.includes(":")?[t]:e.chains||[]}const Qo="base10",ot="base16",tn="base64pad",bn="utf8",Zo=0,tr=1,pd=0,Is=1,rn=12,wn=32;function yd(){const t=pn.generateKeyPair();return{privateKey:at(t.secretKey,ot),publicKey:at(t.publicKey,ot)}}function nn(){const t=ur.randomBytes(wn);return at(t,ot)}function _d(t,e){const r=pn.sharedKey(ut(t,ot),ut(e,ot)),i=new Lf(di.SHA256,r).expand(wn);return at(i,ot)}function bd(t){const e=di.hash(ut(t,ot));return at(e,ot)}function or(t){const e=di.hash(ut(t,bn));return at(e,ot)}function wd(t){return ut(`${t}`,Qo)}function jr(t){return Number(at(t,Qo))}function md(t){const e=wd(typeof t.type<"u"?t.type:Zo);if(jr(e)===tr&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?ut(t.senderPublicKey,ot):void 0,i=typeof t.iv<"u"?ut(t.iv,ot):ur.randomBytes(rn),n=new dn.ChaCha20Poly1305(ut(t.symKey,ot)).seal(i,ut(t.message,bn));return Ed({type:e,sealed:n,iv:i,senderPublicKey:r})}function vd(t){const e=new dn.ChaCha20Poly1305(ut(t.symKey,ot)),{sealed:r,iv:i}=ri(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return at(n,bn)}function Ed(t){if(jr(t.type)===tr){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return at(Qi([t.type,t.senderPublicKey,t.iv,t.sealed]),tn)}return at(Qi([t.type,t.iv,t.sealed]),tn)}function ri(t){const e=ut(t,tn),r=e.slice(pd,Is),i=Is;if(jr(r)===tr){const c=i+wn,h=c+rn,l=e.slice(i,c),g=e.slice(c,h),m=e.slice(h);return{type:r,sealed:m,iv:g,senderPublicKey:l}}const n=i+rn,s=e.slice(i,n),a=e.slice(n);return{type:r,sealed:a,iv:s}}function Sd(t,e){const r=ri(t);return ea({type:jr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?at(r.senderPublicKey,ot):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function ea(t){const e=(t==null?void 0:t.type)||Zo;if(e===tr){if(typeof(t==null?void 0:t.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(t==null?void 0:t.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t==null?void 0:t.senderPublicKey,receiverPublicKey:t==null?void 0:t.receiverPublicKey}}function Cs(t){return t.type===tr&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Dd=Object.defineProperty,Ts=Object.getOwnPropertySymbols,xd=Object.prototype.hasOwnProperty,Od=Object.prototype.propertyIsEnumerable,As=(t,e,r)=>e in t?Dd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ps=(t,e)=>{for(var r in e||(e={}))xd.call(e,r)&&As(t,r,e[r]);if(Ts)for(var r of Ts(e))Od.call(e,r)&&As(t,r,e[r]);return t};const Id="ReactNative",qt={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Cd="js";function mn(){return typeof Ct<"u"&&typeof Ct.versions<"u"&&typeof Ct.versions.node<"u"}function ta(){return!Wo()&&!!yn()&&navigator.product===Id}function vn(){return!mn()&&!!yn()}function En(){return ta()?qt.reactNative:mn()?qt.node:vn()?qt.browser:qt.unknown}function Td(t,e){let r=Ur.parse(t);return r=Ps(Ps({},r),e),t=Ur.stringify(r),t}function Ad(){return Yo()||{name:"",description:"",url:"",icons:[""]}}function Pd(){if(En()===qt.reactNative&&typeof wt<"u"&&typeof(wt==null?void 0:wt.Platform)<"u"){const{OS:r,Version:i}=wt.Platform;return[r,i].join("-")}const t=Gf();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Nd(){var t;const e=En();return e===qt.browser?[e,((t=ko())==null?void 0:t.host)||"unknown"].join(":"):e}function Rd(t,e,r){const i=Pd(),n=Nd();return[[t,e].join("-"),[Cd,r].join("-"),i,n].join("/")}function Ud({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:a}){const c=r.split("?"),h=Rd(t,e,i),l={auth:n,ua:h,projectId:s,useOnCloseEvent:a||void 0},g=Td(c[1]||"",l);return c[0]+"?"+g}function Xt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function ra(t){return Object.fromEntries(t.entries())}function ia(t){return new Map(Object.entries(t))}function sr(t=Q.FIVE_MINUTES,e){const r=Q.toMiliseconds(t||Q.FIVE_MINUTES);let i,n,s;return{resolve:a=>{s&&i&&(clearTimeout(s),i(a))},reject:a=>{s&&n&&(clearTimeout(s),n(a))},done:()=>new Promise((a,c)=>{s=setTimeout(()=>{c(new Error(e))},r),i=a,n=c})}}function ii(t,e,r){return new Promise(async(i,n)=>{const s=setTimeout(()=>n(new Error(r)),e);try{const a=await t;i(a)}catch(a){n(a)}clearTimeout(s)})}function na(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Fd(t){return na("topic",t)}function $d(t){return na("id",t)}function sa(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function Et(t,e){return Q.fromMiliseconds((e||Date.now())+Q.toMiliseconds(t))}function jt(t){return Date.now()>=Q.toMiliseconds(t)}function qe(t,e){return`${t}${e?`:${e}`:""}`}async function Ld({id:t,topic:e,wcDeepLink:r}){try{if(!r)return;const i=typeof r=="string"?JSON.parse(r):r;let n=i==null?void 0:i.href;if(typeof n!="string")return;n.endsWith("/")&&(n=n.slice(0,-1));const s=`${n}/wc?requestId=${t}&sessionTopic=${e}`,a=En();a===qt.browser?s.startsWith("https://")?window.open(s,"_blank","noreferrer noopener"):window.open(s,"_self","noreferrer noopener"):a===qt.reactNative&&typeof(wt==null?void 0:wt.Linking)<"u"&&await wt.Linking.openURL(s)}catch(i){console.error(i)}}const Md="irn";function sn(t){return(t==null?void 0:t.relay)||{protocol:Md}}function Jr(t){const e=gd[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var jd=Object.defineProperty,Ns=Object.getOwnPropertySymbols,qd=Object.prototype.hasOwnProperty,Bd=Object.prototype.propertyIsEnumerable,Rs=(t,e,r)=>e in t?jd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zd=(t,e)=>{for(var r in e||(e={}))qd.call(e,r)&&Rs(t,r,e[r]);if(Ns)for(var r of Ns(e))Bd.call(e,r)&&Rs(t,r,e[r]);return t};function Kd(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),a=t[n];r[s]=a}}),r}function Hd(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",a=Ur.parse(s);return{protocol:i,topic:Vd(n[0]),version:parseInt(n[1],10),symKey:a.symKey,relay:Kd(a)}}function Vd(t){return t.startsWith("//")?t.substring(2):t}function Gd(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function Wd(t){return`${t.protocol}:${t.topic}@${t.version}?`+Ur.stringify(zd({symKey:t.symKey},Gd(t.relay)))}function hr(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function kd(t){const e=[];return Object.values(t).forEach(r=>{e.push(...hr(r.accounts))}),e}function Yd(t,e){const r=[];return Object.values(t).forEach(i=>{hr(i.accounts).includes(e)&&r.push(...i.methods)}),r}function Jd(t,e){const r=[];return Object.values(t).forEach(i=>{hr(i.accounts).includes(e)&&r.push(...i.events)}),r}function Xd(t,e){const r=Xr(t,e);if(r)throw new Error(r.message);const i={};for(const[n,s]of Object.entries(t))i[n]={methods:s.methods,events:s.events,chains:s.accounts.map(a=>`${a.split(":")[0]}:${a.split(":")[1]}`)};return i}const Qd={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Zd={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function V(t,e){const{message:r,code:i}=Zd[t];return{message:e?`${r} ${e}`:r,code:i}}function Ke(t,e){const{message:r,code:i}=Qd[t];return{message:e?`${r} ${e}`:r,code:i}}function qr(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Cr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function st(t){return typeof t>"u"}function Qe(t,e){return e&&st(t)?!0:typeof t=="string"&&!!t.trim().length}function Sn(t,e){return e&&st(t)?!0:typeof t=="number"&&!isNaN(t)}function eg(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return Xt(n,i)?(i.forEach(a=>{const{accounts:c,methods:h,events:l}=t.namespaces[a],g=hr(c),m=r[a];(!Xt(Xo(a,m),g)||!Xt(m.methods,h)||!Xt(m.events,l))&&(s=!1)}),s):!1}function ni(t){return Qe(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function tg(t){if(Qe(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&ni(r)}}return!1}function rg(t){if(Qe(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function ig(t){var e;return(e=t==null?void 0:t.proposer)==null?void 0:e.publicKey}function ng(t){return t==null?void 0:t.topic}function sg(t,e){let r=null;return Qe(t==null?void 0:t.publicKey,!1)||(r=V("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Us(t){let e=!0;return qr(t)?t.length&&(e=t.every(r=>Qe(r,!1))):e=!1,e}function og(t,e,r){let i=null;return qr(e)&&e.length?e.forEach(n=>{i||ni(n)||(i=Ke("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):ni(t)||(i=Ke("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function ag(t,e,r){let i=null;return Object.entries(t).forEach(([n,s])=>{if(i)return;const a=og(n,Xo(n,s),`${e} ${r}`);a&&(i=a)}),i}function cg(t,e){let r=null;return qr(t)?t.forEach(i=>{r||tg(i)||(r=Ke("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=Ke("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function ug(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=cg(i==null?void 0:i.accounts,`${e} namespace`);n&&(r=n)}),r}function lg(t,e){let r=null;return Us(t==null?void 0:t.methods)?Us(t==null?void 0:t.events)||(r=Ke("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Ke("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function oa(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=lg(i,`${e}, namespace`);n&&(r=n)}),r}function hg(t,e,r){let i=null;if(t&&Cr(t)){const n=oa(t,e);n&&(i=n);const s=ag(t,e,r);s&&(i=s)}else i=V("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function Xr(t,e){let r=null;if(t&&Cr(t)){const i=oa(t,e);i&&(r=i);const n=ug(t,e);n&&(r=n)}else r=V("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function aa(t){return Qe(t.protocol,!0)}function fg(t,e){let r=!1;return e&&!t?r=!0:t&&qr(t)&&t.length&&t.forEach(i=>{r=aa(i)}),r}function dg(t){return typeof t=="number"}function ct(t){return typeof t<"u"&&typeof t!==null}function gg(t){return!(!t||typeof t!="object"||!t.code||!Sn(t.code,!1)||!t.message||!Qe(t.message,!1))}function pg(t){return!(st(t)||!Qe(t.method,!1))}function yg(t){return!(st(t)||st(t.result)&&st(t.error)||!Sn(t.id,!1)||!Qe(t.jsonrpc,!1))}function _g(t){return!(st(t)||!Qe(t.name,!1))}function Fs(t,e){return!(!ni(e)||!kd(t).includes(e))}function bg(t,e,r){return Qe(r,!1)?Yd(t,e).includes(r):!1}function wg(t,e,r){return Qe(r,!1)?Jd(t,e).includes(r):!1}function $s(t,e,r){let i=null;const n=mg(t),s=vg(e),a=Object.keys(n),c=Object.keys(s),h=Ls(Object.keys(t)),l=Ls(Object.keys(e)),g=h.filter(m=>!l.includes(m));return g.length&&(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${g.toString()}
      Received: ${Object.keys(e).toString()}`)),Xt(a,c)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${a.toString()}
      Approved: ${c.toString()}`)),Object.keys(e).forEach(m=>{if(!m.includes(":")||i)return;const y=hr(e[m].accounts);y.includes(m)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${m}
        Required: ${m}
        Approved: ${y.toString()}`))}),a.forEach(m=>{i||(Xt(n[m].methods,s[m].methods)?Xt(n[m].events,s[m].events)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${m}`)):i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${m}`))}),i}function mg(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(n=>{e[n]={methods:t[r].methods,events:t[r].events}})}),e}function Ls(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function vg(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const i=hr(t[r].accounts);i==null||i.forEach(n=>{e[n]={accounts:t[r].accounts.filter(s=>s.includes(`${n}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function Eg(t,e){return Sn(t,!1)&&t<=e.max&&t>=e.min}const Sg="PARSE_ERROR",Dg="INVALID_REQUEST",xg="METHOD_NOT_FOUND",Og="INVALID_PARAMS",ca="INTERNAL_ERROR",Dn="SERVER_ERROR",Ig=[-32700,-32600,-32601,-32602,-32603],Tr={[Sg]:{code:-32700,message:"Parse error"},[Dg]:{code:-32600,message:"Invalid Request"},[xg]:{code:-32601,message:"Method not found"},[Og]:{code:-32602,message:"Invalid params"},[ca]:{code:-32603,message:"Internal error"},[Dn]:{code:-32e3,message:"Server error"}},ua=Dn;function Cg(t){return Ig.includes(t)}function Ms(t){return Object.keys(Tr).includes(t)?Tr[t]:Tr[ua]}function Tg(t){const e=Object.values(Tr).find(r=>r.code===t);return e||Tr[ua]}function Ag(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var la={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var on=function(t,e){return on=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},on(t,e)};function Pg(t,e){on(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var an=function(){return an=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},an.apply(this,arguments)};function Ng(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Rg(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Ug(t,e){return function(r,i){e(r,i,t)}}function Fg(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function $g(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(g){try{l(i.next(g))}catch(m){a(m)}}function h(g){try{l(i.throw(g))}catch(m){a(m)}}function l(g){g.done?s(g.value):n(g.value).then(c,h)}l((i=i.apply(t,e||[])).next())})}function Lg(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(g){return h([l,g])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(g){l=[6,g],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Mg(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function jg(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function cn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ha(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function qg(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ha(arguments[e]));return t}function Bg(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Fr(t){return this instanceof Fr?(this.v=t,this):new Fr(t)}function zg(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(v){return new Promise(function(S,P){s.push([y,v,S,P])>1||c(y,v)})})}function c(y,v){try{h(i[y](v))}catch(S){m(s[0][3],S)}}function h(y){y.value instanceof Fr?Promise.resolve(y.value.v).then(l,g):m(s[0][2],y)}function l(y){c("next",y)}function g(y){c("throw",y)}function m(y,v){y(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Kg(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Fr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function Hg(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof cn=="function"?cn(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,h){a=t[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(l){s({value:l,done:c})},a)}}function Vg(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Gg(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Wg(t){return t&&t.__esModule?t:{default:t}}function kg(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Yg(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const Jg=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return an},__asyncDelegator:Kg,__asyncGenerator:zg,__asyncValues:Hg,__await:Fr,__awaiter:$g,__classPrivateFieldGet:kg,__classPrivateFieldSet:Yg,__createBinding:Mg,__decorate:Rg,__exportStar:jg,__extends:Pg,__generator:Lg,__importDefault:Wg,__importStar:Gg,__makeTemplateObject:Vg,__metadata:Fg,__param:Ug,__read:ha,__rest:Ng,__spread:qg,__spreadArrays:Bg,__values:cn},Symbol.toStringTag,{value:"Module"})),Xg=ar(Jg);var Nt={},js;function Qg(){if(js)return Nt;js=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.isBrowserCryptoAvailable=Nt.getSubtleCrypto=Nt.getBrowerCrypto=void 0;function t(){return(ft===null||ft===void 0?void 0:ft.crypto)||(ft===null||ft===void 0?void 0:ft.msCrypto)||{}}Nt.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}Nt.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Nt.isBrowserCryptoAvailable=r,Nt}var Rt={},qs;function Zg(){if(qs)return Rt;qs=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.isBrowser=Rt.isNode=Rt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Rt.isReactNative=t;function e(){return typeof Ct<"u"&&typeof Ct.versions<"u"&&typeof Ct.versions.node<"u"}Rt.isNode=e;function r(){return!t()&&!e()}return Rt.isBrowser=r,Rt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Xg;e.__exportStar(Qg(),t),e.__exportStar(Zg(),t)})(la);function fa(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function xn(t=6){return BigInt(fa(t))}function gi(t,e,r){return{id:r||fa(),jsonrpc:"2.0",method:t,params:e}}function On(t,e){return{id:t,jsonrpc:"2.0",result:e}}function In(t,e,r){return{id:t,jsonrpc:"2.0",error:ep(e,r)}}function ep(t,e){return typeof t>"u"?Ms(ca):(typeof t=="string"&&(t=Object.assign(Object.assign({},Ms(Dn)),{message:t})),typeof e<"u"&&(t.data=e),Cg(t.code)&&(t=Tg(t.code)),t)}class tp{}class rp extends tp{constructor(){super()}}class ip extends rp{constructor(e){super()}}const np="^wss?:";function sp(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function op(t,e){const r=sp(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Bs(t){return op(t,np)}function ap(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function da(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Cn(t){return da(t)&&"method"in t}function pi(t){return da(t)&&(Ut(t)||St(t))}function Ut(t){return"result"in t}function St(t){return"error"in t}class cp extends ip{constructor(e){super(e),this.events=new Tt.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(gi(e.method,e.params||[],e.id||xn().toString()),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{St(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),pi(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}var Ti,zs;function up(){return zs||(zs=1,Ti=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}),Ti}const lp=()=>typeof WebSocket<"u"?WebSocket:typeof wt<"u"&&typeof wt.WebSocket<"u"?wt.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:up(),hp=()=>typeof WebSocket<"u"||typeof wt<"u"&&typeof wt.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Ks=t=>t.split("?")[0],Hs=10,fp=lp();class dp{constructor(e){if(this.url=e,this.events=new Tt.EventEmitter,this.registering=!1,!Bs(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Oo(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!Bs(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=la.isReactNative()?void 0:{rejectUnauthorized:!ap(e)},s=new fp(e,[],n);hp()?s.onerror=a=>{const c=a;i(this.emitError(c.error))}:s.on("error",a=>{i(this.emitError(a))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?xo(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=In(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Ag(e,Ks(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Hs&&this.events.setMaxListeners(Hs)}emitError(e){const r=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Ks(this.url)}`));return this.events.emit("register_error",r),r}}function gp(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var c=t.length,h=t.charAt(0),l=Math.log(c)/Math.log(256),g=Math.log(256)/Math.log(c);function m(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var P=0,N=0,z=0,E=S.length;z!==E&&S[z]===0;)z++,P++;for(var I=(E-z)*g+1>>>0,_=new Uint8Array(I);z!==E;){for(var w=S[z],d=0,o=I-1;(w!==0||d<N)&&o!==-1;o--,d++)w+=256*_[o]>>>0,_[o]=w%c>>>0,w=w/c>>>0;if(w!==0)throw new Error("Non-zero carry");N=d,z++}for(var f=I-N;f!==I&&_[f]===0;)f++;for(var R=h.repeat(P);f<I;++f)R+=t.charAt(_[f]);return R}function y(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var P=0;if(S[P]!==" "){for(var N=0,z=0;S[P]===h;)N++,P++;for(var E=(S.length-P)*l+1>>>0,I=new Uint8Array(E);S[P];){var _=r[S.charCodeAt(P)];if(_===255)return;for(var w=0,d=E-1;(_!==0||w<z)&&d!==-1;d--,w++)_+=c*I[d]>>>0,I[d]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");z=w,P++}if(S[P]!==" "){for(var o=E-z;o!==E&&I[o]===0;)o++;for(var f=new Uint8Array(N+(E-o)),R=N;o!==E;)f[R++]=I[o++];return f}}}function v(S){var P=y(S);if(P)return P;throw new Error(`Non-${e} character`)}return{encode:m,decodeUnsafe:y,decode:v}}var pp=gp,yp=pp;const ga=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},_p=t=>new TextEncoder().encode(t),bp=t=>new TextDecoder().decode(t);class wp{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class mp{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return pa(this,e)}}class vp{constructor(e){this.decoders=e}or(e){return pa(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const pa=(t,e)=>new vp({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Ep{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new wp(e,r,i),this.decoder=new mp(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const yi=({name:t,prefix:e,encode:r,decode:i})=>new Ep(t,e,r,i),Br=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=yp(r,e);return yi({prefix:t,name:e,encode:i,decode:s=>ga(n(s))})},Sp=(t,e,r,i)=>{const n={};for(let g=0;g<e.length;++g)n[e[g]]=g;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,h=0,l=0;for(let g=0;g<s;++g){const m=n[t[g]];if(m===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|m,c+=r,c>=8&&(c-=8,a[l++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return a},Dp=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,c=0;for(let h=0;h<t.length;++h)for(c=c<<8|t[h],a+=8;a>r;)a-=r,s+=e[n&c>>a];if(a&&(s+=e[n&c<<r-a]),i)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>yi({prefix:e,name:t,encode(n){return Dp(n,i,r)},decode(n){return Sp(n,i,r,t)}}),xp=yi({prefix:"\0",name:"identity",encode:t=>bp(t),decode:t=>_p(t)});var Op=Object.freeze({__proto__:null,identity:xp});const Ip=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Cp=Object.freeze({__proto__:null,base2:Ip});const Tp=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ap=Object.freeze({__proto__:null,base8:Tp});const Pp=Br({prefix:"9",name:"base10",alphabet:"0123456789"});var Np=Object.freeze({__proto__:null,base10:Pp});const Rp=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Up=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Fp=Object.freeze({__proto__:null,base16:Rp,base16upper:Up});const $p=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Lp=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Mp=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),jp=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),qp=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Bp=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),zp=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Kp=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Hp=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Vp=Object.freeze({__proto__:null,base32:$p,base32upper:Lp,base32pad:Mp,base32padupper:jp,base32hex:qp,base32hexupper:Bp,base32hexpad:zp,base32hexpadupper:Kp,base32z:Hp});const Gp=Br({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Wp=Br({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var kp=Object.freeze({__proto__:null,base36:Gp,base36upper:Wp});const Yp=Br({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Jp=Br({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Xp=Object.freeze({__proto__:null,base58btc:Yp,base58flickr:Jp});const Qp=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Zp=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ey=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ty=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ry=Object.freeze({__proto__:null,base64:Qp,base64pad:Zp,base64url:ey,base64urlpad:ty});const ya=Array.from(""),iy=ya.reduce((t,e,r)=>(t[r]=e,t),[]),ny=ya.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function sy(t){return t.reduce((e,r)=>(e+=iy[r],e),"")}function oy(t){const e=[];for(const r of t){const i=ny[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const ay=yi({prefix:"",name:"base256emoji",encode:sy,decode:oy});var cy=Object.freeze({__proto__:null,base256emoji:ay}),uy=_a,Vs=128,ly=127,hy=~ly,fy=Math.pow(2,31);function _a(t,e,r){e=e||[],r=r||0;for(var i=r;t>=fy;)e[r++]=t&255|Vs,t/=128;for(;t&hy;)e[r++]=t&255|Vs,t>>>=7;return e[r]=t|0,_a.bytes=r-i+1,e}var dy=un,gy=128,Gs=127;function un(t,i){var r=0,i=i||0,n=0,s=i,a,c=t.length;do{if(s>=c)throw un.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=n<28?(a&Gs)<<n:(a&Gs)*Math.pow(2,n),n+=7}while(a>=gy);return un.bytes=s-i,r}var py=Math.pow(2,7),yy=Math.pow(2,14),_y=Math.pow(2,21),by=Math.pow(2,28),wy=Math.pow(2,35),my=Math.pow(2,42),vy=Math.pow(2,49),Ey=Math.pow(2,56),Sy=Math.pow(2,63),Dy=function(t){return t<py?1:t<yy?2:t<_y?3:t<by?4:t<wy?5:t<my?6:t<vy?7:t<Ey?8:t<Sy?9:10},xy={encode:uy,decode:dy,encodingLength:Dy},ba=xy;const Ws=(t,e,r=0)=>(ba.encode(t,e,r),e),ks=t=>ba.encodingLength(t),ln=(t,e)=>{const r=e.byteLength,i=ks(t),n=i+ks(r),s=new Uint8Array(n+r);return Ws(t,s,0),Ws(r,s,i),s.set(e,n),new Oy(t,r,e,s)};class Oy{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const wa=({name:t,code:e,encode:r})=>new Iy(t,e,r);class Iy{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ln(this.code,r):r.then(i=>ln(this.code,i))}else throw Error("Unknown type, must be binary type")}}const ma=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Cy=wa({name:"sha2-256",code:18,encode:ma("SHA-256")}),Ty=wa({name:"sha2-512",code:19,encode:ma("SHA-512")});var Ay=Object.freeze({__proto__:null,sha256:Cy,sha512:Ty});const va=0,Py="identity",Ea=ga,Ny=t=>ln(va,Ea(t)),Ry={code:va,name:Py,encode:Ea,digest:Ny};var Uy=Object.freeze({__proto__:null,identity:Ry});new TextEncoder,new TextDecoder;const Ys={...Op,...Cp,...Ap,...Np,...Fp,...Vp,...kp,...Xp,...ry,...cy};({...Ay,...Uy});function Sa(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Fy(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Sa(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Da(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Js=Da("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ai=Da("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Fy(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),$y={utf8:Js,"utf-8":Js,hex:Ys.base16,latin1:Ai,ascii:Ai,binary:Ai,...Ys};function Ly(t,e="utf8"){const r=$y[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Sa(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}const xa="wc",My=2,Tn="core",Bt=`${xa}@2:${Tn}:`,jy={name:Tn,logger:"error"},qy={database:":memory:"},By="crypto",Xs="client_ed25519_seed",zy=Q.ONE_DAY,Ky="keychain",Hy="0.3",Vy="messages",Gy="0.3",Wy=Q.SIX_HOURS,ky="publisher",Oa="irn",Yy="error",Ia="wss://relay.walletconnect.com",Qs="wss://relay.walletconnect.org",Jy="relayer",Re={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Xy="_subscription",Sr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Qy=Q.ONE_SECOND/2,Zy="2.9.1",e0=1e4,t0="0.3",r0="WALLETCONNECT_CLIENT_ID",It={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},i0="subscription",n0="0.3",s0=Q.FIVE_SECONDS*1e3,o0="pairing",a0="0.3",Dr={wc_pairingDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:0},res:{ttl:Q.ONE_DAY,prompt:!1,tag:0}}},Ot={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},c0="history",u0="0.3",l0="expirer",_t={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},h0="0.3",Pi="verify-api",Zs="https://verify.walletconnect.com";class f0{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=Ky,this.version=Hy,this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=we.generateChildLogger(r,this.name)}get context(){return we.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ra(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ia(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class d0{constructor(e,r,i){this.core=e,this.logger=r,this.name=By,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=_s(n);return Bo(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=yd();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),a=_s(s),c=nn();return await Df(c,n,zy,a)},this.generateSharedKey=(n,s,a)=>{this.isInitialized();const c=this.getPrivateKey(n),h=_d(c,s);return this.setSymKey(h,a)},this.setSymKey=async(n,s)=>{this.isInitialized();const a=s||bd(n);return await this.keychain.set(a,n),a},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,a)=>{this.isInitialized();const c=ea(a),h=Oo(s);if(Cs(c)){const y=c.senderPublicKey,v=c.receiverPublicKey;n=await this.generateSharedKey(y,v)}const l=this.getSymKey(n),{type:g,senderPublicKey:m}=c;return md({type:g,symKey:l,message:h,senderPublicKey:m})},this.decode=async(n,s,a)=>{this.isInitialized();const c=Sd(s,a);if(Cs(c)){const h=c.receiverPublicKey,l=c.senderPublicKey;n=await this.generateSharedKey(h,l)}try{const h=this.getSymKey(n),l=vd({symKey:h,encoded:s});return xo(l)}catch(h){this.logger.error(`Failed to decode message from topic: '${n}', clientId: '${await this.getClientId()}'`),this.logger.error(h)}},this.getPayloadType=n=>{const s=ri(n);return jr(s.type)},this.getPayloadSenderPublicKey=n=>{const s=ri(n);return s.senderPublicKey?at(s.senderPublicKey,ot):void 0},this.core=e,this.logger=we.generateChildLogger(r,this.name),this.keychain=i||new f0(this.core,this.logger)}get context(){return we.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Xs)}catch{e=nn(),await this.keychain.set(Xs,e)}return Ly(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class g0 extends Tl{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=Vy,this.version=Gy,this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=or(n);let a=this.messages.get(i);return typeof a>"u"&&(a={}),typeof a[s]<"u"||(a[s]=n,this.messages.set(i,a),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),a=or(n);return typeof s[a]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=we.generateChildLogger(e,this.name),this.core=r}get context(){return we.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ra(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ia(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class p0 extends Al{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new Tt.EventEmitter,this.name=ky,this.queue=new Map,this.publishTimeout=Q.toMiliseconds(Q.TEN_SECONDS),this.queueTimeout=Q.toMiliseconds(Q.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(i,n,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});try{const a=(s==null?void 0:s.ttl)||Wy,c=sn(s),h=(s==null?void 0:s.prompt)||!1,l=(s==null?void 0:s.tag)||0,g=(s==null?void 0:s.id)||xn().toString(),m={topic:i,message:n,opts:{ttl:a,relay:c,prompt:h,tag:l,id:g}},y=setTimeout(()=>this.queue.set(g,m),this.queueTimeout);try{await await ii(this.rpcPublish(i,n,a,c,h,l,g),this.publishTimeout),clearTimeout(y),this.relayer.events.emit(Re.publish,m)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}})}catch(a){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(a),a}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=we.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return we.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,s,a,c){var h,l,g,m;const y={method:Jr(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:s,tag:a},id:c};return st((h=y.params)==null?void 0:h.prompt)&&((l=y.params)==null||delete l.prompt),st((g=y.params)==null?void 0:g.tag)&&((m=y.params)==null||delete m.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:y}),this.relayer.request(y)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:n}=e;await this.publish(r,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(cr.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Re.connection_stalled);return}this.checkQueue()}),this.relayer.on(Re.message_ack,e=>{this.onPublish(e.id.toString())})}}class y0{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var _0=Object.defineProperty,b0=Object.defineProperties,w0=Object.getOwnPropertyDescriptors,eo=Object.getOwnPropertySymbols,m0=Object.prototype.hasOwnProperty,v0=Object.prototype.propertyIsEnumerable,to=(t,e,r)=>e in t?_0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xr=(t,e)=>{for(var r in e||(e={}))m0.call(e,r)&&to(t,r,e[r]);if(eo)for(var r of eo(e))v0.call(e,r)&&to(t,r,e[r]);return t},Ni=(t,e)=>b0(t,w0(e));class E0 extends Rl{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new y0,this.events=new Tt.EventEmitter,this.name=i0,this.version=n0,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Bt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=sn(n),a={topic:i,relay:s};this.pending.set(i,a);const c=await this.rpcSubscribe(i,s);return this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof(n==null?void 0:n.id)<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,s)=>{const a=new Q.Watch;a.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(c),a.stop(this.pendingSubscriptionWatchLabel),n(!0)),a.elapsed(this.pendingSubscriptionWatchLabel)>=s0&&(clearInterval(c),a.stop(this.pendingSubscriptionWatchLabel),s(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=we.generateChildLogger(r,this.name),this.clientId=""}get context(){return we.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=sn(i);await this.rpcUnsubscribe(e,r,n);const s=Ke("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:Jr(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await ii(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Re.connection_stalled)}return or(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:Jr(r.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await ii(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Re.connection_stalled)}}rpcUnsubscribe(e,r,i){const n={method:Jr(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,r){this.setSubscription(e,Ni(xr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,xr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,xr({},r)),this.topicMap.set(r.topic,e),this.events.emit(It.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(It.deleted,Ni(xr({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(It.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(It.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);qr(r)&&this.onBatchSubscribe(r.map((i,n)=>Ni(xr({},e[n]),{id:i})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(cr.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Re.connect,async()=>{await this.onConnect()}),this.relayer.on(Re.disconnect,()=>{this.onDisconnect()}),this.events.on(It.created,async e=>{const r=It.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(It.deleted,async e=>{const r=It.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var S0=Object.defineProperty,ro=Object.getOwnPropertySymbols,D0=Object.prototype.hasOwnProperty,x0=Object.prototype.propertyIsEnumerable,io=(t,e,r)=>e in t?S0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,O0=(t,e)=>{for(var r in e||(e={}))D0.call(e,r)&&io(t,r,e[r]);if(ro)for(var r of ro(e))x0.call(e,r)&&io(t,r,e[r]);return t};class I0 extends Pl{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Tt.EventEmitter,this.name=Jy,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?we.generateChildLogger(e.logger,this.name):we.pino(we.getDefaultLoggerOptions({level:e.logger||Yy})),this.messages=new g0(this.logger,e.core),this.subscriber=new E0(this,this.logger),this.publisher=new p0(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Ia,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Qs}...`),await this.restartTransport(Qs)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},e0)}get context(){return we.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){var i;this.isInitialized();let n=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"";return n||(await Promise.all([new Promise(s=>{this.subscriber.once(It.created,a=>{a.topic===e&&s()})}),new Promise(async s=>{n=await this.subscriber.subscribe(e,r),s()})]),n)}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Re.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(It.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,i)=>{await ii(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(n=>i(n)).then(()=>r()).finally(()=>this.removeListener(Re.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Re.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const i=r;if(!this.isConnectionStalled(i.message))throw r;this.events.emit(Re.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(Sr.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new cp(new dp(Ud({sdkVersion:Zy,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;if(!i||i.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const n=this.messages.has(r,i);return n&&this.logger.debug(`Ignoring duplicate message: ${i}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Cn(e)){if(!e.method.endsWith(Xy))return;const r=e.params,{topic:i,message:n,publishedAt:s}=r.data,a={topic:i,message:n,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(O0({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else pi(e)&&this.events.emit(Re.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Re.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=On(e.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(Sr.payload,e=>this.onProviderPayload(e)),this.provider.on(Sr.connect,()=>{this.events.emit(Re.connect)}),this.provider.on(Sr.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Sr.error,e=>{this.logger.error(e),this.events.emit(Re.error,e)})}registerEventListeners(){this.events.on(Re.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Re.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},Q.toMiliseconds(Qy))}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var C0=Object.defineProperty,no=Object.getOwnPropertySymbols,T0=Object.prototype.hasOwnProperty,A0=Object.prototype.propertyIsEnumerable,so=(t,e,r)=>e in t?C0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,oo=(t,e)=>{for(var r in e||(e={}))T0.call(e,r)&&so(t,r,e[r]);if(no)for(var r of no(e))A0.call(e,r)&&so(t,r,e[r]);return t};class _i extends Nl{constructor(e,r,i,n=Bt,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=t0,this.cached=[],this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>{this.getKey&&a!==null&&!st(a)?this.map.set(this.getKey(a),a):ig(a)?this.map.set(a.id,a):ng(a)&&this.map.set(a.topic,a)}),this.cached=[],this.initialized=!0)},this.set=async(a,c)=>{this.isInitialized(),this.map.has(a)?await this.update(a,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:a,value:c}),this.map.set(a,c),await this.persist())},this.get=a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a)),this.getAll=a=>(this.isInitialized(),a?this.values.filter(c=>Object.keys(a).every(h=>Cc(c[h],a[h]))):this.values),this.update=async(a,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:a,update:c});const h=oo(oo({},this.getData(a)),c);this.map.set(a,h),await this.persist()},this.delete=async(a,c)=>{this.isInitialized(),this.map.has(a)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:a,reason:c}),this.map.delete(a),await this.persist())},this.logger=we.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return we.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class P0{constructor(e,r){this.core=e,this.logger=r,this.name=o0,this.version=a0,this.events=new go,this.initialized=!1,this.storagePrefix=Bt,this.ignoredPayloadTypes=[tr],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=nn(),n=await this.core.crypto.setSymKey(i),s=Et(Q.FIVE_MINUTES),a={protocol:Oa},c={topic:n,expiry:s,relay:a,active:!1},h=Wd({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:a});return await this.pairings.set(n,c),await this.core.relayer.subscribe(n),this.core.expirer.set(n,s),{topic:n,uri:h}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:s,relay:a}=Hd(i.uri);if(this.pairings.keys.includes(n))throw new Error(`Pairing already exists: ${n}`);if(this.core.crypto.hasKeys(n))throw new Error(`Keychain already exists: ${n}`);const c=Et(Q.FIVE_MINUTES),h={topic:n,relay:a,expiry:c,active:!1};return await this.pairings.set(n,h),await this.core.crypto.setSymKey(s,n),await this.core.relayer.subscribe(n,{relay:a}),this.core.expirer.set(n,c),i.activatePairing&&await this.activate({topic:n}),h},this.activate=async({topic:i})=>{this.isInitialized();const n=Et(Q.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:a,resolve:c,reject:h}=sr();this.events.once(qe("pairing_ping",s),({error:l})=>{l?h(l):c()}),await a()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",Ke("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,s)=>{const a=gi(n,s),c=await this.core.crypto.encode(i,a),h=Dr[n].req;return this.core.history.set(i,a),this.core.relayer.publish(i,c,h),a.id},this.sendResult=async(i,n,s)=>{const a=On(i,s),c=await this.core.crypto.encode(n,a),h=await this.core.history.get(n,i),l=Dr[h.request.method].res;await this.core.relayer.publish(n,c,l),await this.core.history.resolve(a)},this.sendError=async(i,n,s)=>{const a=In(i,s),c=await this.core.crypto.encode(n,a),h=await this.core.history.get(n,i),l=Dr[h.request.method]?Dr[h.request.method].res:Dr.unregistered_method.res;await this.core.relayer.publish(n,c,l),await this.core.history.resolve(a)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Ke("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>jt(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:s}=i;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:s}=i,a=(await this.core.history.get(n,s.id)).request.method;switch(a){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(a)}},this.onPairingPingRequest=async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit("pairing_ping",{id:s,topic:i})}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onPairingPingResponse=(i,n)=>{const{id:s}=n;setTimeout(()=>{Ut(n)?this.events.emit(qe("pairing_ping",s),{}):St(n)&&this.events.emit(qe("pairing_ping",s),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit("pairing_delete",{id:s,topic:i})}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:s,method:a}=n;try{if(this.registeredMethods.includes(a))return;const c=Ke("WC_METHOD_UNSUPPORTED",a);await this.sendError(s,i,c),this.logger.error(c)}catch(c){await this.sendError(s,i,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Ke("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!ct(i)){const{message:n}=V("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!rg(i.uri)){const{message:n}=V("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!ct(i)){const{message:s}=V("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!ct(i)){const{message:s}=V("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!Qe(i,!1)){const{message:n}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(jt(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=V("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=we.generateChildLogger(r,this.name),this.pairings=new _i(this.core,this.logger,this.name,this.storagePrefix)}get context(){return we.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Re.message,async e=>{const{topic:r,message:i}=e;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);Cn(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):pi(n)&&(await this.core.history.resolve(n),await this.onRelayEventResponse({topic:r,payload:n}),this.core.history.delete(r,n.id))})}registerExpirerEvents(){this.core.expirer.on(_t.expired,async e=>{const{topic:r}=sa(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class N0 extends Cl{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new Tt.EventEmitter,this.name=c0,this.version=u0,this.cached=[],this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const a={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s,expiry:Et(Q.THIRTY_DAYS)};this.records.set(a.id,a),this.events.emit(Ot.created,a)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=St(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(Ot.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(Ot.deleted,s)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=we.generateChildLogger(r,this.name)}get context(){return we.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:gi(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Ot.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Ot.created,e=>{const r=Ot.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Ot.updated,e=>{const r=Ot.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Ot.deleted,e=>{const r=Ot.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.core.heartbeat.on(cr.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{Q.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class R0 extends Ul{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new Tt.EventEmitter,this.name=l0,this.version=h0,this.cached=[],this.initialized=!1,this.storagePrefix=Bt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),a={target:s,expiry:n};this.expirations.set(s,a),this.checkExpiry(s,a),this.events.emit(_t.created,{target:s,expiration:a})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(_t.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=we.generateChildLogger(r,this.name)}get context(){return we.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Fd(e);if(typeof e=="number")return $d(e);const{message:r}=V("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(_t.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;Q.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(_t.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(cr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(_t.created,e=>{const r=_t.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(_t.expired,e=>{const r=_t.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(_t.deleted,e=>{const r=_t.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class U0 extends Fl{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=Pi,this.initialized=!1,this.init=async i=>{ta()||!vn()||(this.verifyUrl=(i==null?void 0:i.verifyUrl)||Zs,await this.createIframe())},this.register=async i=>{var n;if(this.initialized||await this.init(),!!this.iframe)try{(n=this.iframe.contentWindow)==null||n.postMessage(i.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${i.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async i=>{var n;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${i.attestationId}`);const s=this.startAbortTimer(Q.FIVE_SECONDS),a=await fetch(`${this.verifyUrl}/attestation/${i.attestationId}`,{signal:this.abortController.signal});return clearTimeout(s),a.status===200?(n=await a.json())==null?void 0:n.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((i,n)=>{if(document.getElementById(Pi))return i();const s=document.createElement("iframe");s.setAttribute("id",Pi),s.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),s.style.display="none",s.addEventListener("load",()=>{this.initialized=!0,i()}),s.addEventListener("error",a=>{n(a)}),document.body.append(s),this.iframe=s}),new Promise(i=>{setTimeout(()=>i("iframe load timeout"),Q.toMiliseconds(Q.ONE_SECOND/2))})])}catch(i){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(i)}},this.logger=we.generateChildLogger(r,this.name),this.verifyUrl=Zs,this.abortController=new AbortController,this.isDevEnv=mn()&&{}.IS_VITEST}get context(){return we.getLoggerContext(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),Q.toMiliseconds(e))}}var F0=Object.defineProperty,ao=Object.getOwnPropertySymbols,$0=Object.prototype.hasOwnProperty,L0=Object.prototype.propertyIsEnumerable,co=(t,e,r)=>e in t?F0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,uo=(t,e)=>{for(var r in e||(e={}))$0.call(e,r)&&co(t,r,e[r]);if(ao)for(var r of ao(e))L0.call(e,r)&&co(t,r,e[r]);return t};class An extends Il{constructor(e){super(e),this.protocol=xa,this.version=My,this.name=Tn,this.events=new Tt.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Ia;const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:we.pino(we.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||jy.logger}));this.logger=we.generateChildLogger(r,this.name),this.heartbeat=new cr.HeartBeat,this.crypto=new d0(this,this.logger,e==null?void 0:e.keychain),this.history=new N0(this,this.logger),this.expirer=new R0(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new iu(uo(uo({},qy),e==null?void 0:e.storageOptions)),this.relayer=new I0({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new P0(this,this.logger),this.verify=new U0(this.projectId||"",this.logger)}static async init(e){const r=new An(e);await r.initialize();const i=await r.crypto.getClientId();return await r.storage.setItem(r0,i),r}get context(){return we.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const M0=An,Ca="wc",Ta=2,Aa="client",Pn=`${Ca}@${Ta}:${Aa}:`,Ri={name:Aa,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},j0="WALLETCONNECT_DEEPLINK_CHOICE",q0="proposal",B0="Proposal expired",z0="session",Yr=Q.SEVEN_DAYS,K0="engine",Or={wc_sessionPropose:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1115}}},Ui={min:Q.FIVE_MINUTES,max:Q.SEVEN_DAYS},Ir={idle:"idle",active:"active"},H0="request",V0=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var G0=Object.defineProperty,W0=Object.defineProperties,k0=Object.getOwnPropertyDescriptors,lo=Object.getOwnPropertySymbols,Y0=Object.prototype.hasOwnProperty,J0=Object.prototype.propertyIsEnumerable,ho=(t,e,r)=>e in t?G0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,yt=(t,e)=>{for(var r in e||(e={}))Y0.call(e,r)&&ho(t,r,e[r]);if(lo)for(var r of lo(e))J0.call(e,r)&&ho(t,r,e[r]);return t},Fi=(t,e)=>W0(t,k0(e));class X0 extends Ll{constructor(e){super(e),this.name=K0,this.events=new go,this.initialized=!1,this.ignoredPayloadTypes=[tr],this.requestQueue={state:Ir.idle,requests:[]},this.requestQueueDelay=Q.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Or)}),this.initialized=!0,setTimeout(()=>{this.requestQueue.requests=this.getPendingSessionRequests(),this.processRequestQueue()},Q.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{this.isInitialized();const i=Fi(yt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:c,relays:h}=i;let l=n,g,m=!1;if(l&&(m=this.client.core.pairing.pairings.get(l).active),!l||!m){const{topic:I,uri:_}=await this.client.core.pairing.create();l=I,g=_}const y=await this.client.core.crypto.generateKeyPair(),v=yt({requiredNamespaces:s,optionalNamespaces:a,relays:h??[{protocol:Oa}],proposer:{publicKey:y,metadata:this.client.metadata}},c&&{sessionProperties:c}),{reject:S,resolve:P,done:N}=sr(Q.FIVE_MINUTES,B0);if(this.events.once(qe("session_connect"),async({error:I,session:_})=>{if(I)S(I);else if(_){_.self.publicKey=y;const w=Fi(yt({},_),{requiredNamespaces:_.requiredNamespaces,optionalNamespaces:_.optionalNamespaces});await this.client.session.set(_.topic,w),await this.setExpiry(_.topic,_.expiry),l&&await this.client.core.pairing.updateMetadata({topic:l,metadata:_.peer.metadata}),P(w)}}),!l){const{message:I}=V("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(I)}const z=await this.sendRequest(l,"wc_sessionPropose",v),E=Et(Q.FIVE_MINUTES);return await this.setProposal(z,yt({id:z,expiry:E},v)),{uri:g,approval:N}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:s,sessionProperties:a}=r,c=this.client.proposal.get(i);let{pairingTopic:h,proposer:l,requiredNamespaces:g,optionalNamespaces:m}=c;h=h||"",Cr(g)||(g=Xd(s,"approve()"));const y=await this.client.core.crypto.generateKeyPair(),v=l.publicKey,S=await this.client.core.crypto.generateSharedKey(y,v);h&&i&&(await this.client.core.pairing.updateMetadata({topic:h,metadata:l.metadata}),await this.sendResult(i,h,{relay:{protocol:n??"irn"},responderPublicKey:y}),await this.client.proposal.delete(i,Ke("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:h}));const P=yt({relay:{protocol:n??"irn"},namespaces:s,requiredNamespaces:g,optionalNamespaces:m,pairingTopic:h,controller:{publicKey:y,metadata:this.client.metadata},expiry:Et(Yr)},a&&{sessionProperties:a});await this.client.core.relayer.subscribe(S),await this.sendRequest(S,"wc_sessionSettle",P);const N=Fi(yt({},P),{topic:S,pairingTopic:h,acknowledged:!1,self:P.controller,peer:{publicKey:l.publicKey,metadata:l.metadata},controller:y});return await this.client.session.set(S,N),await this.setExpiry(S,Et(Yr)),{topic:S,acknowledged:()=>new Promise(z=>setTimeout(()=>z(this.client.session.get(S)),500))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:s}=this.client.proposal.get(i);s&&(await this.sendError(i,s,n),await this.client.proposal.delete(i,Ke("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,s=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:a,resolve:c,reject:h}=sr();return this.events.once(qe("session_update",s),({error:l})=>{l?h(l):c()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:a}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:s,resolve:a,reject:c}=sr();return this.events.once(qe("session_extend",n),({error:h})=>{h?c(h):a()}),await this.setExpiry(i,Et(Yr)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:s,expiry:a}=r,c=await this.sendRequest(s,"wc_sessionRequest",{request:n,chainId:i},a),{done:h,resolve:l,reject:g}=sr(a);this.events.once(qe("session_request",c),({error:y,result:v})=>{y?g(y):l(v)}),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:c});const m=await this.client.core.storage.getItem(j0);return Ld({id:c,topic:s,wcDeepLink:m}),await h()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n;Ut(n)?await this.sendResult(s,i,n.result):St(n)&&await this.sendError(s,i,n.error),this.cleanupAfterResponse(r)},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:s,resolve:a,reject:c}=sr();this.events.once(qe("session_ping",n),({error:h})=>{h?c(h):a()}),await s()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=xn().toString();let s;const a=c=>{(c==null?void 0:c.id.toString())===n&&(this.client.core.relayer.events.removeListener(Re.message_ack,a),s())};await Promise.all([new Promise(c=>{s=c,this.client.core.relayer.on(Re.message_ack,a)}),this.sendRequest(i,"wc_sessionDelete",Ke("USER_DISCONNECTED"),void 0,n)]),await this.deleteSession(i)}else await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>eg(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const i=this.client.core.pairing.pairings.get(r.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter(s=>{var a,c;return((a=s.peerMetadata)==null?void 0:a.url)&&((c=s.peerMetadata)==null?void 0:c.url)===r.peer.metadata.url&&s.topic&&s.topic!==i.topic});if(n.length===0)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async(r,i)=>{const{self:n}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Ke("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(n.publicKey)&&await this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),i||this.client.core.expirer.del(r)},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,Ke("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)]),this.requestQueue.requests=this.requestQueue.requests.filter(s=>s.id!==r),n&&(this.requestQueue.state=Ir.idle)},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=Or.wc_sessionRequest.req.ttl,{id:n,topic:s,params:a}=r;await this.client.pendingRequest.set(n,{id:n,topic:s,params:a}),i&&this.client.core.expirer.set(n,Et(i))},this.sendRequest=async(r,i,n,s,a)=>{const c=gi(i,n);if(vn()&&V0.includes(i)){const g=or(JSON.stringify(c));await this.client.core.verify.register({attestationId:g})}const h=await this.client.core.crypto.encode(r,c),l=Or[i].req;return s&&(l.ttl=s),a&&(l.id=a),this.client.core.history.set(r,c),this.client.core.relayer.publish(r,h,l),c.id},this.sendResult=async(r,i,n)=>{const s=On(r,n),a=await this.client.core.crypto.encode(i,s),c=await this.client.core.history.get(i,r),h=Or[c.request.method].res;this.client.core.relayer.publish(i,a,h),await this.client.core.history.resolve(s)},this.sendError=async(r,i,n)=>{const s=In(r,n),a=await this.client.core.crypto.encode(i,s),c=await this.client.core.history.get(i,r),h=Or[c.request.method].res;this.client.core.relayer.publish(i,a,h),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{jt(n.expiry)&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{jt(n.expiry)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=r=>{const{topic:i,payload:n}=r,s=n.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,s=(await this.client.core.history.get(i,n.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:i}=r,{message:n}=V("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(n)},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidConnect(yt({},i.params));const a=Et(Q.FIVE_MINUTES),c=yt({id:s,pairingTopic:r,expiry:a},n);await this.setProposal(s,c);const h=or(JSON.stringify(i)),l=await this.getVerifyContext(h,c.proposer.metadata);this.client.events.emit("session_proposal",{id:s,params:c,verifyContext:l})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(Ut(i)){const{result:s}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const a=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const h=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});const l=await this.client.core.crypto.generateSharedKey(c,h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:l});const g=await this.client.core.relayer.subscribe(l);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:g}),await this.client.core.pairing.activate({topic:r})}else St(i)&&(await this.client.proposal.delete(n,Ke("USER_DISCONNECTED")),this.events.emit(qe("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:a,controller:c,expiry:h,namespaces:l,requiredNamespaces:g,optionalNamespaces:m,sessionProperties:y,pairingTopic:v}=i.params,S=yt({topic:r,relay:a,expiry:h,namespaces:l,acknowledged:!0,pairingTopic:v,requiredNamespaces:g,optionalNamespaces:m,controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},y&&{sessionProperties:y});await this.sendResult(i.id,r,!0),this.events.emit(qe("session_connect"),{session:S}),this.cleanupDuplicatePairings(S)}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;Ut(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(qe("session_approve",n),{})):St(i)&&(await this.client.session.delete(r,Ke("USER_DISCONNECTED")),this.events.emit(qe("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidUpdate(yt({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;Ut(i)?this.events.emit(qe("session_update",n),{}):St(i)&&this.events.emit(qe("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Et(Yr)),await this.sendResult(n,r,!0),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;Ut(i)?this.events.emit(qe("session_extend",n),{}):St(i)&&this.events.emit(qe("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;setTimeout(()=>{Ut(i)?this.events.emit(qe("session_ping",n),{}):St(i)&&this.events.emit(qe("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await Promise.all([new Promise(s=>{this.client.core.relayer.once(Re.publish,async()=>{s(await this.deleteSession(r))})}),this.sendResult(n,r,!0)]),this.client.events.emit("session_delete",{id:n,topic:r})}catch(s){this.client.logger.error(s)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidRequest(yt({topic:r},s)),await this.setPendingSessionRequest({id:n,topic:r,params:s}),this.addRequestToQueue({id:n,topic:r,params:s}),await this.processRequestQueue()}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;Ut(i)?this.events.emit(qe("session_request",n),{result:i.result}):St(i)&&this.events.emit(qe("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidEmit(yt({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s})}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.addRequestToQueue=r=>{this.requestQueue.requests.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.requestQueue.state=Ir.idle,this.processRequestQueue()},Q.toMiliseconds(this.requestQueueDelay))},this.processRequestQueue=async()=>{if(this.requestQueue.state===Ir.active){this.client.logger.info("session request queue is already active.");return}const r=this.requestQueue.requests[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{const{id:i,topic:n,params:s}=r,a=or(JSON.stringify({id:i,params:s})),c=this.client.session.get(n),h=await this.getVerifyContext(a,c.peer.metadata);this.requestQueue.state=Ir.active,this.client.events.emit("session_request",{id:i,topic:n,params:s,verifyContext:h})}catch(i){this.client.logger.error(i)}},this.isValidConnect=async r=>{if(!ct(r)){const{message:h}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(h)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:a,relays:c}=r;if(st(i)||await this.isValidPairingTopic(i),!fg(c,!0)){const{message:h}=V("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(h)}!st(n)&&Cr(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!st(s)&&Cr(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),st(a)||this.validateSessionProps(a,"sessionProperties")},this.validateNamespaces=(r,i)=>{const n=hg(r,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async r=>{if(!ct(r))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:a}=r;await this.isValidProposalId(i);const c=this.client.proposal.get(i),h=Xr(n,"approve()");if(h)throw new Error(h.message);const l=$s(c.requiredNamespaces,n,"approve()");if(l)throw new Error(l.message);if(!Qe(s,!0)){const{message:g}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(g)}st(a)||this.validateSessionProps(a,"sessionProperties")},this.isValidReject=async r=>{if(!ct(r)){const{message:s}=V("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!gg(n)){const{message:s}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!ct(r)){const{message:l}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(l)}const{relay:i,controller:n,namespaces:s,expiry:a}=r;if(!aa(i)){const{message:l}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const c=sg(n,"onSessionSettleRequest()");if(c)throw new Error(c.message);const h=Xr(s,"onSessionSettleRequest()");if(h)throw new Error(h.message);if(jt(a)){const{message:l}=V("EXPIRED","onSessionSettleRequest()");throw new Error(l)}},this.isValidUpdate=async r=>{if(!ct(r)){const{message:h}=V("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(h)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const s=this.client.session.get(i),a=Xr(n,"update()");if(a)throw new Error(a.message);const c=$s(s.requiredNamespaces,n,"update()");if(c)throw new Error(c.message)},this.isValidExtend=async r=>{if(!ct(r)){const{message:n}=V("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!ct(r)){const{message:h}=V("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(h)}const{topic:i,request:n,chainId:s,expiry:a}=r;await this.isValidSessionTopic(i);const{namespaces:c}=this.client.session.get(i);if(!Fs(c,s)){const{message:h}=V("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(h)}if(!pg(n)){const{message:h}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(h)}if(!bg(c,s,n.method)){const{message:h}=V("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(h)}if(a&&!Eg(a,Ui)){const{message:h}=V("MISSING_OR_INVALID",`request() expiry: ${a}. Expiry must be a number (in seconds) between ${Ui.min} and ${Ui.max}`);throw new Error(h)}},this.isValidRespond=async r=>{if(!ct(r)){const{message:s}=V("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!yg(n)){const{message:s}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!ct(r)){const{message:n}=V("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!ct(r)){const{message:c}=V("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(c)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:a}=this.client.session.get(i);if(!Fs(a,s)){const{message:c}=V("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(c)}if(!_g(n)){const{message:c}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}if(!wg(a,s,n.name)){const{message:c}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}},this.isValidDisconnect=async r=>{if(!ct(r)){const{message:n}=V("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.getVerifyContext=async(r,i)=>{const n={verified:{verifyUrl:i.verifyUrl||"",validation:"UNKNOWN",origin:i.url||""}};try{const s=await this.client.core.verify.resolve({attestationId:r,verifyUrl:i.verifyUrl});s&&(n.verified.origin=s,n.verified.validation=s===i.url?"VALID":"INVALID")}catch(s){this.client.logger.error(s)}return this.client.logger.info(`Verify context: ${JSON.stringify(n)}`),n},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(n=>{if(!Qe(n,!1)){const{message:s}=V("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(s)}})}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Re.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(r,i);Cn(n)?(this.client.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):pi(n)?(await this.client.core.history.resolve(n),await this.onRelayEventResponse({topic:r,payload:n}),this.client.core.history.delete(r,n.id)):this.onRelayEventUnknownPayload({topic:r,payload:n})})}registerExpirerEvents(){this.client.core.expirer.on(_t.expired,async e=>{const{topic:r,id:i}=sa(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,V("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(e){if(!Qe(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(jt(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=V("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Qe(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(jt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=V("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Qe(e,!1)){const{message:r}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!dg(e)){const{message:r}=V("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(jt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=V("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class Q0 extends _i{constructor(e,r){super(e,r,q0,Pn),this.core=e,this.logger=r}}class Z0 extends _i{constructor(e,r){super(e,r,z0,Pn),this.core=e,this.logger=r}}class e_ extends _i{constructor(e,r){super(e,r,H0,Pn,i=>i.id),this.core=e,this.logger=r}}class Nn extends $l{constructor(e){super(e),this.protocol=Ca,this.version=Ta,this.name=Ri.name,this.events=new Tt.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=(e==null?void 0:e.name)||Ri.name,this.metadata=(e==null?void 0:e.metadata)||Ad();const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:we.pino(we.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Ri.logger}));this.core=(e==null?void 0:e.core)||new M0(e),this.logger=we.generateChildLogger(r,this.name),this.session=new Z0(this.core,this.logger),this.proposal=new Q0(this.core,this.logger),this.pendingRequest=new e_(this.core,this.logger),this.engine=new X0(this)}static async init(e){const r=new Nn(e);return await r.initialize(),r}get context(){return we.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const fo="WALLETCONNECT_DEEPLINK_CHOICE",Qt={isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,r,i){if(Qt.isHttpUrl(t))return this.formatUniversalUrl(t,e,i);const n=t.replaceAll("/","").replaceAll(":","");Qt.setWalletConnectDeepLink(n,i);const s=encodeURIComponent(e);return`${n}://wc?uri=${s}`},formatUniversalUrl(t,e,r){if(!Qt.isHttpUrl(t))return this.formatNativeUrl(t,e,r);let i=t;t.endsWith("/")&&(i=t.slice(0,-1)),Qt.setWalletConnectDeepLink(i,r);const n=encodeURIComponent(e);return`${i}/wc?uri=${n}`},async wait(t){return new Promise(e=>{setTimeout(e,t)})},openHref(t,e="_self"){window.open(t,e,"noreferrer noopener")},setWalletConnectDeepLink(t,e){localStorage.setItem(fo,JSON.stringify({href:t,name:e}))},removeWalletConnectDeepLink(){localStorage.removeItem(fo)}},t_="https://explorer-api.walletconnect.com";class p_{constructor(e){ze(this,"walletInfo");ze(this,"signClient");ze(this,"wcCloudInfo");ze(this,"actions");ze(this,"qrUrl");ze(this,"appUrl");ze(this,"pairings",[]);ze(this,"sessions",[]);ze(this,"emitter");ze(this,"logger");ze(this,"options");ze(this,"relayUrl");ze(this,"env");if(!e.walletconnect)throw new Error(`'walletconnect' info for wallet ${e.prettyName} is not provided in wallet registry.`);this.walletInfo=e,this.qrUrl={state:bt.Init},this.appUrl={state:bt.Init}}get isMobile(){var e;return((e=this.env)==null?void 0:e.device)==="mobile"}get wcName(){return this.walletInfo.walletconnect.name}get wcEncoding(){return this.walletInfo.walletconnect.encoding||"hex"}get wcProjectId(){return this.walletInfo.walletconnect.projectId}get wcMobile(){return this.walletInfo.walletconnect.mobile}get accounts(){const e=[];return this.sessions.forEach(r=>{Object.entries(r.namespaces).forEach(([,i])=>{i.accounts.forEach(n=>{const[s,a,c]=n.split(":");e.push({namespace:s,chainId:a,address:c})})})}),e}deleteSession(e){var i,n;const r=[];this.sessions=this.sessions.filter(s=>s.topic===e?(s.namespaces.cosmos.accounts.forEach(a=>{const[,c]=a.split(":");r.push(c)}),!1):!0),(i=this.emitter)==null||i.emit("reset",r),(n=this.logger)==null||n.debug("[WALLET EVENT] Emit `reset`")}subscribeToEvents(){if(typeof this.signClient>"u")throw new Error("WalletConnect is not initialized");this.signClient.on("session_ping",e=>{var r;(r=this.logger)==null||r.debug("EVENT","session_ping",e)}),this.signClient.on("session_event",async e=>{var r;(r=this.logger)==null||r.debug("EVENT","session_event",e)}),this.signClient.on("session_update",({topic:e,params:r})=>{var i;(i=this.logger)==null||i.debug("EVENT","session_update",{topic:e,params:r})}),this.signClient.on("session_delete",e=>{var r;(r=this.logger)==null||r.debug("EVENT","session_delete",e),this.deleteSession(e.topic)}),this.signClient.on("session_expire",e=>{var r;(r=this.logger)==null||r.debug("EVENT","session_expire",e),this.deleteSession(e.topic)}),this.signClient.on("session_proposal",e=>{var r;(r=this.logger)==null||r.debug("EVENT","session_proposal",e)}),this.signClient.on("session_request",e=>{var r;(r=this.logger)==null||r.debug("EVENT","session_request",e)}),this.signClient.on("proposal_expire",e=>{var r;(r=this.logger)==null||r.debug("EVENT","proposal_expire",e)})}async deleteInactivePairings(){var e;if(typeof this.signClient>"u")throw new Error("WalletConnect is not initialized");for(const r of this.signClient.pairing.getAll({active:!1}))await this.signClient.pairing.delete(r.topic,{code:7001,message:"Clear inactive pairings."}),(e=this.logger)==null||e.debug("Delete inactive pairing:",r.topic)}restorePairings(){var e;if(typeof this.signClient>"u")throw new Error("WalletConnect is not initialized");this.pairings=this.signClient.pairing.getAll({active:!0}).filter(r=>{var i;return((i=r.peerMetadata)==null?void 0:i.name)===this.wcName&&r.expiry*1e3>Date.now()+1e3}),(e=this.logger)==null||e.debug("RESTORED PAIRINGS: ",this.pairings)}get pairing(){return this.pairings[0]}restoreSessions(){var e;if(typeof this.signClient>"u")throw new Error("WalletConnect is not initialized");this.sessions=this.signClient.session.getAll().filter(r=>r.peer.metadata.name===this.wcName&&r.expiry*1e3>Date.now()+1e3),(e=this.logger)==null||e.debug("RESTORED SESSIONS: ",this.sessions)}getSession(e,r){return this.sessions.find(i=>{var n,s;return(s=(n=i.namespaces[e])==null?void 0:n.accounts)==null?void 0:s.find(a=>a.startsWith(`${e}:${r}`))})}get walletName(){return this.walletInfo.name}get dappProjectId(){var e;return(e=this.options)==null?void 0:e.signClient.projectId}setActions(e){this.actions=e}setQRState(e){var r,i;this.qrUrl.state=e,(i=(r=this.actions)==null?void 0:r.qrUrl)==null||i.state(e)}setQRError(e){var r,i,n,s;this.setQRState(bt.Error),this.qrUrl.message=typeof e=="string"?e:e==null?void 0:e.message,(n=(i=(r=this.actions)==null?void 0:r.qrUrl)==null?void 0:i.message)==null||n.call(i,this.qrUrl.message),typeof e!="string"&&(e!=null&&e.stack)&&((s=this.logger)==null||s.error(e.stack))}async init(){await this.initSignClient(),this.isMobile&&await this.initAppUrl()}async initSignClient(){var e,r,i,n,s,a;this.signClient&&this.relayUrl===((e=this.options)==null?void 0:e.signClient.relayUrl)||(this.signClient=await Nn.init((r=this.options)==null?void 0:r.signClient),this.relayUrl=(i=this.options)==null?void 0:i.signClient.relayUrl,(n=this.logger)==null||n.debug("CREATED CLIENT: ",this.signClient),(a=this.logger)==null||a.debug("relayerRegion ",(s=this.options)==null?void 0:s.signClient.relayUrl),this.subscribeToEvents(),this.restorePairings(),this.restoreSessions())}async initWCCloudInfo(){var i;const e=`${t_}/v3/wallets?projectId=${this.dappProjectId}&sdks=sign_v2&search=${this.wcName}`,r=await(await fetch(e)).json();this.wcCloudInfo=r.listings[this.walletInfo.walletconnect.projectId],(i=this.logger)==null||i.debug("WalletConnect Info:",this.wcCloudInfo)}async initAppUrl(){var i,n;this.appUrl.state=bt.Pending,this.wcCloudInfo||await this.initWCCloudInfo();const e=this.wcCloudInfo.mobile.native||((i=this.wcMobile)==null?void 0:i.native),r=this.wcCloudInfo.mobile.universal||((n=this.wcMobile)==null?void 0:n.universal);this.appUrl.data={native:e,universal:r},this.appUrl.state=bt.Done}get nativeUrl(){var r,i,n;const e=(r=this.appUrl.data)==null?void 0:r.native;if(typeof e=="string"||typeof e>"u")return e;{const{android:s,ios:a,macos:c,windows:h}=e;switch((i=this.env)==null?void 0:i.os){case"android":return s;case"ios":return a;case"macos":return c;case"windows":return h;default:throw new Error(`Unknown os: ${(n=this.env)==null?void 0:n.os}.`)}}}get universalUrl(){var e;return(e=this.appUrl.data)==null?void 0:e.universal}get redirectHref(){return this.nativeUrl||this.universalUrl}get redirectHrefWithWCUri(){var r;let e;return this.nativeUrl?e=(this.walletInfo.walletconnect.formatNativeUrl||Qt.formatNativeUrl)(this.nativeUrl,this.qrUrl.data,(r=this.env)==null?void 0:r.os,this.walletName):this.universalUrl&&(e=(this.walletInfo.walletconnect.formatUniversalUrl||Qt.formatUniversalUrl)(this.universalUrl,this.qrUrl.data,this.walletName)),e}get displayQRCode(){return!(this.pairing||this.redirect)}get redirect(){return!!(this.isMobile&&(this.nativeUrl||this.universalUrl))}openApp(e=!0){var i,n;const r=e?this.redirectHrefWithWCUri:this.redirectHref;r?((i=this.logger)==null||i.debug("Redirecting:",r),Qt.openHref(r)):(n=this.logger)==null||n.error("No redirecting href.")}async connect(e){var a,c,h,l,g,m;typeof this.signClient>"u"&&await this.init(),this.qrUrl.state!=="Init"&&this.setQRState(bt.Init);const r=typeof e=="string"?[`cosmos:${e}`]:e.map(y=>`cosmos:${y}`);this.restorePairings();const i=this.pairing;(a=this.logger)==null||a.debug("Restored active pairing topic is:",i==null?void 0:i.topic),this.displayQRCode&&this.setQRState(bt.Pending);const n={cosmos:{methods:["cosmos_getAccounts","cosmos_signAmino","cosmos_signDirect"],chains:r,events:["chainChanged","accountsChanged"]}};let s;try{(c=this.logger)==null||c.debug("Connecting chains:",r),s=await this.signClient.connect({pairingTopic:i==null?void 0:i.topic,requiredNamespaces:n}),this.qrUrl.data=s.uri,(h=this.logger)==null||h.debug("Using QR URI:",s.uri),this.displayQRCode&&this.setQRState(bt.Done)}catch(y){(l=this.logger)==null||l.error("Client connect error: ",y),this.displayQRCode&&this.setQRError(y);return}this.redirect&&this.openApp();try{const y=await s.approval();(g=this.logger)==null||g.debug("Established session:",y),this.sessions.push(y),this.restorePairings()}catch(y){throw(m=this.logger)==null||m.error("Session approval error: ",y),await this.deleteInactivePairings(),y?y.code==5001?vc:y:(this.displayQRCode&&this.setQRError(Kn),new Error("Proposal Expired"))}finally{!i&&this.qrUrl.message!==Kn.message&&this.setQRState(bt.Init)}}async disconnect(){var e,r,i,n;if(typeof this.signClient>"u"&&await this.init(),this.sessions.length!==0){for(const s of this.sessions)try{(e=this.logger)==null||e.debug("Delete session:",s),await this.signClient.disconnect({topic:s.topic,reason:Ke("USER_DISCONNECTED")})}catch(a){(r=this.logger)==null||r.error(`SignClient.disconnect session ${s.topic} failed:`,a)}this.sessions=[],(i=this.emitter)==null||i.emit("sync_disconnect"),(n=this.logger)==null||n.debug("[WALLET EVENT] Emit `sync_disconnect`")}}async getSimpleAccount(e){const r=this.accounts.find(({chainId:i})=>i===e);if(!r)throw new Error(`Chain ${e} is not connected yet, please check the session approval namespaces`);return r}getOfflineSignerAmino(e){return{getAccounts:async()=>[await this.getAccount(e)],signAmino:(r,i)=>this.signAmino(e,r,i)}}getOfflineSignerDirect(e){return{getAccounts:async()=>[await this.getAccount(e)],signDirect:(r,i)=>this.signDirect(e,r,i)}}async getOfflineSigner(e,r){var i;return r==="amino"&&this.getOfflineSignerAmino?this.getOfflineSignerAmino(e):r==="direct"&&this.getOfflineSignerDirect?this.getOfflineSignerDirect(e):this.getOfflineSignerAmino?(i=this.getOfflineSignerAmino)==null?void 0:i.call(this,e):this.getOfflineSignerDirect(e)}async _getAccount(e){var n;const r=this.getSession("cosmos",e);if(!r)throw new Error(`Session for ${e} not established yet.`);const i=await this.signClient.request({topic:r.topic,chainId:`cosmos:${e}`,request:{method:"cosmos_getAccounts",params:{}}});return(n=this.logger)==null||n.debug("Response of cosmos_getAccounts",i),i}async getAccount(e){const{address:r,algo:i,pubkey:n}=(await this._getAccount(e))[0];return{address:r,algo:i,pubkey:new Uint8Array(pr.Buffer.from(n,this.wcEncoding))}}async _signAmino(e,r,i,n){var c;const s=this.getSession("cosmos",e);if(!s)throw new Error(`Session for ${e} not established yet.`);this.redirect&&this.openApp();const a=await this.signClient.request({topic:s.topic,chainId:`cosmos:${e}`,request:{method:"cosmos_signAmino",params:{signerAddress:r,signDoc:i}}});return(c=this.logger)==null||c.debug("Response of cosmos_signAmino",a),a}async signAmino(e,r,i,n){return await this._signAmino(e,r,i,n)}async _signDirect(e,r,i,n){var h;const s=this.getSession("cosmos",e);if(!s)throw new Error(`Session for ${e} not established yet.`);const a={signerAddress:r,signDoc:{chainId:i.chainId,bodyBytes:pr.Buffer.from(i.bodyBytes).toString(this.wcEncoding),authInfoBytes:pr.Buffer.from(i.authInfoBytes).toString(this.wcEncoding),accountNumber:i.accountNumber.toString()}};this.redirect&&this.openApp();const c=await this.signClient.request({topic:s.topic,chainId:`cosmos:${e}`,request:{method:"cosmos_signDirect",params:a}});return(h=this.logger)==null||h.debug("Response of cosmos_signDirect",c),c}async signDirect(e,r,i,n){const{signed:s,signature:a}=await this._signDirect(e,r,i,n);return{signed:{chainId:s.chainId,accountNumber:Oc.fromString(s.accountNumber,!1),authInfoBytes:new Uint8Array(pr.Buffer.from(s.authInfoBytes,this.wcEncoding)),bodyBytes:new Uint8Array(pr.Buffer.from(s.bodyBytes,this.wcEncoding))},signature:a}}}class y_ extends Ec{constructor(r,i,n){if(!r.walletconnect)throw new Error(`'walletconnect' info for wallet ${r.prettyName} is not provided in wallet registry.`);super(r,i);ze(this,"WCClient");ze(this,"clientMutable",{state:bt.Init});this.WCClient=n}async initClient(r){if(!r){this.initClientError(new Error("`walletconnectOptions` is not provided."));return}if(!r.signClient.projectId){this.initClientError(new Error("`projectId` is not provided in `walletconnectOptions`."));return}this.initingClient();try{const i=new this.WCClient(this.walletInfo);i.logger=this.logger,i.emitter=this.emitter,i.env=this.env,i.options=r,this.initClientDone(i)}catch(i){this.initClientError(i)}}}export{u_ as C,p_ as W,y_ as a,Ic as l};
