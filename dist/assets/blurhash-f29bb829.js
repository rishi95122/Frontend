var T=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],u=t=>{let e=0;for(let l=0;l<t.length;l++){let a=t[l],n=T.indexOf(a);e=e*83+n}return e},b=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},m=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.trunc(e*12.92*255+.5):Math.trunc((1.055*Math.pow(e,.4166666666666667)-.055)*255+.5)},U=t=>t<0?-1:1,d=(t,e)=>U(t)*Math.pow(Math.abs(t),e),E=class extends Error{constructor(t){super(t),this.name="ValidationError",this.message=t}},V=t=>{if(!t||t.length<6)throw new E("The blurhash string must be at least 6 characters");let e=u(t[0]),l=Math.floor(e/9)+1,a=e%9+1;if(t.length!==4+2*a*l)throw new E(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*a*l}`)},$=t=>{let e=t>>16,l=t>>8&255,a=t&255;return[b(e),b(l),b(a)]},j=(t,e)=>{let l=Math.floor(t/361),a=Math.floor(t/19)%19,n=t%19;return[d((l-9)/9,2)*e,d((a-9)/9,2)*e,d((n-9)/9,2)*e]},q=(t,e,l,a)=>{V(t),a=a|1;let n=u(t[0]),p=Math.floor(n/9)+1,c=n%9+1,I=(u(t[1])+1)/166,i=new Array(c*p);for(let r=0;r<i.length;r++)if(r===0){let h=u(t.substring(2,6));i[r]=$(h)}else{let h=u(t.substring(4+r*2,6+r*2));i[r]=j(h,I*a)}let o=e*4,s=new Uint8ClampedArray(o*l);for(let r=0;r<l;r++)for(let h=0;h<e;h++){let x=0,v=0,y=0;for(let M=0;M<p;M++)for(let f=0;f<c;f++){let g=Math.cos(Math.PI*h*f/e)*Math.cos(Math.PI*r*M/l),w=i[f+M*c];x+=w[0]*g,v+=w[1]*g,y+=w[2]*g}let P=m(x),A=m(v),C=m(y);s[4*h+0+r*o]=P,s[4*h+1+r*o]=A,s[4*h+2+r*o]=C,s[4*h+3+r*o]=255}return s},z=q;export{z as j};
